%%Parameter Idenitification
clear all
tf=2;
ts=0.1;
g=9.8;
par_num=31;
data_points=14; 
options=14;

%Joint Limits
limit_min(1)=-1.54; %rad
limit_max(1)=1.54;
limit_min(2)=-0.84; %rad
limit_max(2)=0.84;  
limit_min(3)=0;     %m
limit_max(3)=0.24; 
limit_min(4)=-1.54; %rad
limit_max(4)=1.54;
limit_min(5)=-1.54; %rad
limit_max(5)=1.54;
limit_min(6)=-1.54; %rad
limit_max(6)=1.54;

%Maximum Velocity 
velocity_min(1)= -0.5 ;%rad/s
velocity_max(1)= 0.5 ;%rad/s
velocity_min(2)= -0.06;
velocity_max(2)= 0.06; %m/s



%Chosen Trajectories

for i=1:6
C(i,:)=linspace(limit_min(i),limit_max(i),options); 
end

for i=1:6
Cd(i,:)=linspace(velocity_min(1),velocity_max(1),options);
    if i==3
        Cd(i,:)=linspace(velocity_min(2),velocity_max(2),options);
    end
end


x_save=[];
v_save=[];
cond_save=10e+10;
%Completely Random Trajectories
%Cond=zeros(1,length(B));
%Conf=zeros(1,length(B));
for h=1:1000
    x=[];
    y=[];
    x(1:6,1)=zeros(1,6);
    v(1:6,1)=zeros(1,6);
    
    for i=2:data_points
      for z=1:6
        x(z,i)=C(z,randi(options));
        v(z,i)=Cd(z,randi(options));
      end
    end

    for k=1:6
        [Q(k,:),Qd(k,:),Qdd(k,:),T]=Trajectory_f(x(k,:),v(k,:),tf,ts);
    end
    
W=[];
W=zeros(length(Q),par_num);

%Test Trajectory for Least squares solution
for i=1:size(Q,2)
   
q1=Q(1,i);
q2=Q(2,i);
q3=Q(3,i);
q4=Q(4,i);
q5=Q(5,i);
q6=Q(6,i);


qd1=Qd(1,i);
qd2=Qd(2,i);
qd3=Qd(3,i);
qd4=Qd(4,i);
qd5=Qd(5,i);
qd6=Qd(6,i);

qdd1=Qdd(1,i);
qdd2=Qdd(2,i);
qdd3=Qdd(3,i);
qdd4=Qdd(4,i);
qdd5=Qdd(5,i);
qdd6=Qdd(6,i);
 

%Ye Grouped Parameters
%W(1+2*(i-1),:)=[ qdd1 - sin(q1), qdd2,    0, qdd1 + qdd1*cos(2*q2 - (13*pi)/72) - 4*qd1*qd2*sin(2*q2 - (13*pi)/72), (145161*qdd1)/6250000 + (145161*qdd1*cos(2*q2 - (13*pi)/72))/6250000 - (2881*sin(q1)*sin(q2 + (59*pi)/144))/1250 - (145161*qd1*qd2*sin(2*q2 - (13*pi)/72))/1562500, qdd1/2 + (qdd1*cos(2*q2))/2 - 2*qd1*qd2*sin(2*q2),         (381*qdd1*sin(2*q2 + (59*pi)/144))/2500 - cos(q2)*sin(q1) + (381*qdd1*sin((59*pi)/144))/2500 + (381*qd1*qd2*cos(2*q2 + (59*pi)/144))/625, (145161*qdd1)/8000000 + (145161*qdd1*cos(2*q2))/16000000 - (381*sin(q1)*sin(q2 + pi/3))/2000 + (145161*3^(1/2)*qdd1*sin(2*q2))/16000000 - (145161*qd1*qd2*sin(2*q2))/4000000 + (145161*3^(1/2)*qd1*qd2*cos(2*q2))/4000000];
%W(2+2*(i-1),:)=[              0, qdd1, qdd2,                               2*sin(2*q2 - (13*pi)/72)*qd1^2 + 2*qdd2,                                                  (145161*sin(2*q2 - (13*pi)/72)*qd1^2)/3125000 + (145161*qdd2)/3125000 + (2881*cos(q1)*cos(q2 + (59*pi)/144))/1250,                            sin(2*q2)*qd1^2 + qdd2, - cos(q1)*sin(q2) - (381*qdd2*sin(2*q2 + (59*pi)/144))/1250 - (381*qd1^2*cos(2*q2 + (59*pi)/144))/1250 - (381*qd2^2*cos(2*q2 + (59*pi)/144))/625,                                                                                   (145161*qdd2)/4000000 + (381*cos(q1)*cos(q2 + pi/3))/2000 + (145161*qd1^2*sin(2*q2))/8000000 - (145161*3^(1/2)*qd1^2*cos(2*q2))/8000000];


W(1+(i-1)*6,:)=[ (12385934102891895*qdd1)/4503599627370496 - qdd1*cos(q4)^2 + 2*qd2*qd4*sin(q2) + qdd1*cos(q2)^2*cos(q4)^2 + 2*qd1*qd4*sin(2*q4) - 4*qd2*qd4*cos(q4)^2*sin(q2) - qdd2*cos(q4)*sin(q2)*sin(q4) - 2*qd2^2*cos(q2)*cos(q4)*sin(q4) - 4*qd1*qd2*cos(q2)*cos(q4)^2*sin(q2) - 4*qd1*qd4*cos(q2)^2*cos(q4)*sin(q4), -qdd2, qdd1 + qdd1*cos(q4)^2 - 2*qd2*qd4*sin(q2) - qdd1*cos(q2)^2*cos(q4)^2 - 2*qd1*qd4*sin(2*q4) + 4*qd2*qd4*cos(q4)^2*sin(q2) + qdd2*cos(q4)*sin(q2)*sin(q4) + 2*qd2^2*cos(q2)*cos(q4)*sin(q4) + 4*qd1*qd2*cos(q2)*cos(q4)^2*sin(q2) + 4*qd1*qd4*cos(q2)^2*cos(q4)*sin(q4), qdd1*sin(2*q2) + 4*qd1*qd2*cos(2*q2), (9*qdd1*cos(q2)^2)/400 - (43*cos(q2)*sin(q1))/20 - 2*q3*qdd1*cos(q2)^2 - 4*qd1*qd3*cos(q2)^2 - (9*qd1*qd2*sin(2*q2))/200 + q3*cos(q2)*sin(q1) + q3^2*qdd1*cos(q2)^2 - 2*q3^2*qd1*qd2*sin(2*q2) + 4*q3*qd1*qd3*cos(q2)^2 + 4*q3*qd1*qd2*sin(2*q2), qdd1*sin(2*q2) - qdd4*sin(q2) - 2*qd2*qd4*cos(q2) + 4*qd1*qd2*cos(2*q2), - 2*sin(q2)*qd2^2 + qdd2*cos(q2), qdd1*cos(q2)^2 - qdd4*cos(q2) + 2*qd2*qd4*sin(q2) - 2*qd1*qd2*sin(2*q2), qdd2*cos(q2)*sin(q4) - 4*qd1*qd2*cos(q4) - qdd4*cos(q4)*sin(q2) - qdd5*cos(q4)*sin(q2) - 2*qd2^2*sin(q2)*sin(q4) + 2*qd4^2*sin(q2)*sin(q4) + 2*qd4*qd5*sin(q2)*sin(q4) + 8*qd1*qd2*cos(q2)^2*cos(q4) + 2*qdd1*cos(q2)*cos(q4)*sin(q2) - 2*qd2*qd5*cos(q2)*cos(q4) - 4*qd1*qd4*cos(q2)*sin(q2)*sin(q4), 2*qd2^2*cos(q2) + qdd1*sin(2*q4) - 4*qd1*qd4 + qdd2*sin(q2) - 4*qd2^2*cos(q2)*cos(q4)^2 + 4*qd1*qd4*cos(q2)^2 + 8*qd1*qd4*cos(q4)^2 - 2*qdd2*cos(q4)^2*sin(q2) - 8*qd1*qd4*cos(q2)^2*cos(q4)^2 - 2*qdd1*cos(q2)^2*cos(q4)*sin(q4) + 8*qd2*qd4*cos(q4)*sin(q2)*sin(q4) + 8*qd1*qd2*cos(q2)*cos(q4)*sin(q2)*sin(q4), qdd1*cos(q2)^2 - qdd4*cos(q2) - qdd5*cos(q2) + 2*qd2*qd4*sin(q2) + 2*qd2*qd5*sin(q2) - 2*qd1*qd2*sin(2*q2), 2*qd2^2*cos(q4)*sin(q2) - qdd2*cos(q2)*cos(q4) - qdd4*sin(q2)*sin(q4) - qdd5*sin(q2)*sin(q4) - 4*qd1*qd2*sin(q4) - 2*qd4^2*cos(q4)*sin(q2) + 8*qd1*qd2*cos(q2)^2*sin(q4) + 2*qdd1*cos(q2)*sin(q2)*sin(q4) - 2*qd2*qd5*cos(q2)*sin(q4) - 2*qd4*qd5*cos(q4)*sin(q2) + 4*qd1*qd4*cos(q2)*cos(q4)*sin(q2), qdd1*cos(q2)^2 - (qdd4*cos(q2))/2 - (qdd5*cos(q2))/2 + qd2*qd4*sin(q2) + qd2*qd5*sin(q2) - qdd1*cos(q2)^2*cos(q5)^2 + qdd1*cos(q4)^2*cos(q5)^2 - 2*qd5^2*sin(2*q5)*cos(q2) - 2*qd1*qd2*sin(2*q2) + (qdd4*cos(2*q5)*cos(q2))/2 + (qdd5*cos(2*q5)*cos(q2))/2 - 2*qd5^2*cos(2*q5)*cos(q4)*sin(q2) + qd4^2*sin(2*q5)*sin(q2)*sin(q4) - qd2*qd4*cos(2*q5)*sin(q2) - qd2*qd5*cos(2*q5)*sin(q2) - 2*qd4*qd5*sin(2*q5)*cos(q2) - 2*qd2*qd4*cos(q5)^2*sin(q2) - qdd1*cos(q2)^2*cos(q4)^2*cos(q5)^2 - (qdd4*sin(2*q5)*cos(q4)*sin(q2))/2 - (qdd5*sin(2*q5)*cos(q4)*sin(q2))/2 - 2*qd2*qd5*cos(q2)*sin(q4) - qd2*qd4*sin(2*q5)*cos(q2)*cos(q4) - qd2*qd5*sin(2*q5)*cos(q2)*cos(q4) - 2*qd4*qd5*cos(2*q5)*cos(q4)*sin(q2) + 4*qd1*qd2*cos(q2)*cos(q5)^2*sin(q2) - 4*qd1*qd4*cos(q4)*cos(q5)^2*sin(q4) + 4*qd1*qd5*cos(q2)^2*cos(q5)*sin(q5) + 4*qd2*qd5*cos(q2)*cos(q5)^2*sin(q4) - 4*qd1*qd5*cos(q4)^2*cos(q5)*sin(q5) + qdd2*cos(q2)*cos(q5)*sin(q4)*sin(q5) + qd4*qd5*sin(2*q5)*sin(q2)*sin(q4) + 4*qd2*qd4*cos(q4)^2*cos(q5)^2*sin(q2) + qdd2*cos(q4)*cos(q5)^2*sin(q2)*sin(q4) - 2*qd2^2*cos(q5)*sin(q2)*sin(q4)*sin(q5) - 4*qd1*qd5*cos(q2)*cos(q4)*sin(q2) - 4*qd1*qd2*cos(q4)*cos(q5)*sin(q5) + 2*qd2^2*cos(q2)*cos(q4)*cos(q5)^2*sin(q4) + 8*qd1*qd2*cos(q2)^2*cos(q4)*cos(q5)*sin(q5) + 8*qd1*qd5*cos(q2)*cos(q4)*cos(q5)^2*sin(q2) + 2*qdd1*cos(q2)*cos(q4)*cos(q5)*sin(q2)*sin(q5) + 4*qd1*qd2*cos(q2)*cos(q4)^2*cos(q5)^2*sin(q2) + 4*qd1*qd4*cos(q2)^2*cos(q4)*cos(q5)^2*sin(q4) + 4*qd1*qd5*cos(q2)^2*cos(q4)^2*cos(q5)*sin(q5) + 2*qd2*qd4*cos(q2)*cos(q4)*cos(q5)*sin(q5) - 4*qd1*qd4*cos(q2)*cos(q5)*sin(q2)*sin(q4)*sin(q5) - 4*qd2*qd5*cos(q4)*cos(q5)*sin(q2)*sin(q4)*sin(q5), 4*qd1*qd4*cos(q5) - qdd2*cos(q5)*sin(q2) + qdd6*cos(q2)*sin(q5) - 2*qd2^2*cos(q2)*cos(q5) + 4*qd1*qd2*sin(q4)*sin(q5) + 2*qd2*qd5*sin(q2)*sin(q5) - 2*qd2*qd6*sin(q2)*sin(q5) + 4*qd2^2*cos(q2)*cos(q4)^2*cos(q5) - 4*qd1*qd4*cos(q2)^2*cos(q5) - 8*qd1*qd4*cos(q4)^2*cos(q5) + qdd2*cos(q2)*cos(q4)*sin(q5) - 2*qdd1*cos(q4)*cos(q5)*sin(q4) + qdd6*cos(q4)*cos(q5)*sin(q2) + qdd4*sin(q2)*sin(q4)*sin(q5) + qdd5*sin(q2)*sin(q4)*sin(q5) + 2*qdd2*cos(q4)^2*cos(q5)*sin(q2) - 2*qd2^2*cos(q4)*sin(q2)*sin(q5) + 2*qd4^2*cos(q4)*sin(q2)*sin(q5) + 2*qd5^2*cos(q5)*sin(q2)*sin(q4) + 2*qd5*qd6*cos(q2)*cos(q5) - 8*qd1*qd2*cos(q2)^2*sin(q4)*sin(q5) - 4*qd2*qd5*cos(q4)^2*sin(q2)*sin(q5) - 2*qdd1*cos(q2)*sin(q2)*sin(q4)*sin(q5) + 8*qd1*qd4*cos(q2)^2*cos(q4)^2*cos(q5) + 2*qdd1*cos(q2)^2*cos(q4)*cos(q5)*sin(q4) + 2*qd2*qd5*cos(q2)*cos(q4)*cos(q5) + 2*qd2*qd6*cos(q2)*cos(q4)*cos(q5) + 2*qd2*qd5*cos(q2)*sin(q4)*sin(q5) + 4*qd1*qd5*cos(q4)*sin(q4)*sin(q5) + 2*qd4*qd5*cos(q4)*sin(q2)*sin(q5) + 2*qd4*qd5*cos(q5)*sin(q2)*sin(q4) - 2*qd4*qd6*cos(q5)*sin(q2)*sin(q4) - 2*qd5*qd6*cos(q4)*sin(q2)*sin(q5) - 4*qd1*qd5*cos(q2)^2*cos(q4)*sin(q4)*sin(q5) - 4*qd1*qd4*cos(q2)*cos(q4)*sin(q2)*sin(q5) - 4*qd1*qd5*cos(q2)*cos(q5)*sin(q2)*sin(q4) - 8*qd2*qd4*cos(q4)*cos(q5)*sin(q2)*sin(q4) - 8*qd1*qd2*cos(q2)*cos(q4)*cos(q5)*sin(q2)*sin(q4), 4*qd1*qd2*cos(q4) - 4*qd5^2*cos(2*q5)*cos(q2) - 4*qd1*qd5*cos(q2)^2 + 4*qd1*qd5*cos(q4)^2 - qdd2*cos(q2)*sin(q4) - qdd4*sin(2*q5)*cos(q2) - qdd5*sin(2*q5)*cos(q2) + 2*qd2^2*sin(q2)*sin(q4) + 2*qd4^2*cos(2*q5)*sin(q2)*sin(q4) + 4*qd5^2*sin(2*q5)*cos(q4)*sin(q2) - 4*qd2^2*cos(q5)^2*sin(q2)*sin(q4) - 4*qd4*qd5*cos(2*q5)*cos(q2) - 8*qd1*qd2*cos(q2)^2*cos(q4) - 8*qd1*qd2*cos(q4)*cos(q5)^2 - 2*qdd1*cos(q2)*cos(q4)*sin(q2) + 2*qd2*qd4*sin(2*q5)*sin(q2) + 2*qd2*qd5*sin(2*q5)*sin(q2) - 4*qd1*qd5*cos(q2)^2*cos(q4)^2 + 8*qd1*qd5*cos(q2)^2*cos(q5)^2 - 8*qd1*qd5*cos(q4)^2*cos(q5)^2 - qdd4*cos(2*q5)*cos(q4)*sin(q2) - qdd5*cos(2*q5)*cos(q4)*sin(q2) + 2*qdd1*cos(q2)^2*cos(q5)*sin(q5) + 2*qdd2*cos(q2)*cos(q5)^2*sin(q4) - 2*qdd1*cos(q4)^2*cos(q5)*sin(q5) - 2*qd2*qd4*cos(q2)*cos(q4) - 2*qd2*qd4*cos(2*q5)*cos(q2)*cos(q4) - 2*qd2*qd5*cos(2*q5)*cos(q2)*cos(q4) + 4*qd2*qd4*cos(q2)*cos(q4)*cos(q5)^2 + 2*qd4*qd5*cos(2*q5)*sin(q2)*sin(q4) + 4*qd4*qd5*sin(2*q5)*cos(q4)*sin(q2) + 16*qd1*qd2*cos(q2)^2*cos(q4)*cos(q5)^2 + 4*qdd1*cos(q2)*cos(q4)*cos(q5)^2*sin(q2) + 8*qd1*qd5*cos(q2)^2*cos(q4)^2*cos(q5)^2 + 4*qd1*qd4*cos(q2)*sin(q2)*sin(q4) + 4*qd2*qd5*cos(q4)*sin(q2)*sin(q4) + 4*qd2*qd4*cos(q5)*sin(q2)*sin(q5) + 2*qdd1*cos(q2)^2*cos(q4)^2*cos(q5)*sin(q5) - 8*qd1*qd4*cos(q2)*cos(q5)^2*sin(q2)*sin(q4) - 8*qd2*qd4*cos(q4)^2*cos(q5)*sin(q2)*sin(q5) - 8*qd2*qd5*cos(q4)*cos(q5)^2*sin(q2)*sin(q4) - 2*qdd2*cos(q4)*cos(q5)*sin(q2)*sin(q4)*sin(q5) - 4*qd2^2*cos(q2)*cos(q4)*cos(q5)*sin(q4)*sin(q5) - 8*qd1*qd2*cos(q2)*cos(q5)*sin(q2)*sin(q5) + 8*qd1*qd4*cos(q4)*cos(q5)*sin(q4)*sin(q5) - 8*qd2*qd5*cos(q2)*cos(q5)*sin(q4)*sin(q5) - 16*qd1*qd5*cos(q2)*cos(q4)*cos(q5)*sin(q2)*sin(q5) - 8*qd1*qd2*cos(q2)*cos(q4)^2*cos(q5)*sin(q2)*sin(q5) - 8*qd1*qd4*cos(q2)^2*cos(q4)*cos(q5)*sin(q4)*sin(q5), qdd1 - qdd1*cos(q2)^2 - qdd1*cos(q4)^2 + 2*qd2*qd4*sin(q2) + qdd1*cos(q2)^2*cos(q4)^2 + 2*qd1*qd2*sin(2*q2) + 2*qd1*qd4*sin(2*q4) - qdd6*sin(q2)*sin(q4) - 4*qd2*qd4*cos(q4)^2*sin(q2) - qdd2*cos(q4)*sin(q2)*sin(q4) - 2*qd2^2*cos(q2)*cos(q4)*sin(q4) - 2*qd2*qd6*cos(q2)*sin(q4) - 2*qd4*qd6*cos(q4)*sin(q2) - 4*qd1*qd2*cos(q2)*cos(q4)^2*sin(q2) - 4*qd1*qd4*cos(q2)^2*cos(q4)*sin(q4), qdd6*cos(q2)*cos(q5) - 4*qd1*qd4*sin(q5) + qdd2*sin(q2)*sin(q5) + 2*qd2^2*cos(q2)*sin(q5) - 4*qd2^2*cos(q2)*cos(q4)^2*sin(q5) + qdd2*cos(q2)*cos(q4)*cos(q5) + 4*qd1*qd4*cos(q2)^2*sin(q5) + 8*qd1*qd4*cos(q4)^2*sin(q5) + 2*qdd1*cos(q4)*sin(q4)*sin(q5) + qdd4*cos(q5)*sin(q2)*sin(q4) + qdd5*cos(q5)*sin(q2)*sin(q4) - qdd6*cos(q4)*sin(q2)*sin(q5) - 2*qd2^2*cos(q4)*cos(q5)*sin(q2) + 2*qd4^2*cos(q4)*cos(q5)*sin(q2) - 2*qdd2*cos(q4)^2*sin(q2)*sin(q5) - 2*qd5^2*sin(q2)*sin(q4)*sin(q5) + 4*qd1*qd2*cos(q5)*sin(q4) + 2*qd2*qd5*cos(q5)*sin(q2) - 2*qd2*qd6*cos(q5)*sin(q2) - 2*qd5*qd6*cos(q2)*sin(q5) - 8*qd1*qd2*cos(q2)^2*cos(q5)*sin(q4) - 4*qd2*qd5*cos(q4)^2*cos(q5)*sin(q2) - 2*qdd1*cos(q2)*cos(q5)*sin(q2)*sin(q4) - 8*qd1*qd4*cos(q2)^2*cos(q4)^2*sin(q5) - 2*qdd1*cos(q2)^2*cos(q4)*sin(q4)*sin(q5) - 2*qd2*qd5*cos(q2)*cos(q4)*sin(q5) + 2*qd2*qd5*cos(q2)*cos(q5)*sin(q4) + 4*qd1*qd5*cos(q4)*cos(q5)*sin(q4) - 2*qd2*qd6*cos(q2)*cos(q4)*sin(q5) + 2*qd4*qd5*cos(q4)*cos(q5)*sin(q2) - 2*qd5*qd6*cos(q4)*cos(q5)*sin(q2) - 2*qd4*qd5*sin(q2)*sin(q4)*sin(q5) + 2*qd4*qd6*sin(q2)*sin(q4)*sin(q5) - 4*qd1*qd5*cos(q2)^2*cos(q4)*cos(q5)*sin(q4) - 4*qd1*qd4*cos(q2)*cos(q4)*cos(q5)*sin(q2) + 4*qd1*qd5*cos(q2)*sin(q2)*sin(q4)*sin(q5) + 8*qd2*qd4*cos(q4)*sin(q2)*sin(q4)*sin(q5) + 8*qd1*qd2*cos(q2)*cos(q4)*sin(q2)*sin(q4)*sin(q5), qdd1*cos(q4)^2 - (qdd4*cos(q2))/2 - (qdd5*cos(q2))/2 - qd2*qd4*sin(q2) + qd2*qd5*sin(q2) - qdd1*cos(q2)^2*cos(q4)^2 + qdd1*cos(q2)^2*cos(q5)^2 - qdd1*cos(q4)^2*cos(q5)^2 + 2*qd5^2*sin(2*q5)*cos(q2) - 2*qd1*qd4*sin(2*q4) - (qdd4*cos(2*q5)*cos(q2))/2 - (qdd5*cos(2*q5)*cos(q2))/2 + 2*qd5^2*cos(2*q5)*cos(q4)*sin(q2) - qd4^2*sin(2*q5)*sin(q2)*sin(q4) + qd2*qd4*cos(2*q5)*sin(q2) + qd2*qd5*cos(2*q5)*sin(q2) + 2*qd4*qd5*sin(2*q5)*cos(q2) + 4*qd2*qd4*cos(q4)^2*sin(q2) + 2*qd2*qd4*cos(q5)^2*sin(q2) + qdd1*cos(q2)^2*cos(q4)^2*cos(q5)^2 + qdd2*cos(q4)*sin(q2)*sin(q4) + 2*qd2^2*cos(q2)*cos(q4)*sin(q4) + (qdd4*sin(2*q5)*cos(q4)*sin(q2))/2 + (qdd5*sin(2*q5)*cos(q4)*sin(q2))/2 + 2*qd2*qd5*cos(q2)*sin(q4) + qd2*qd4*sin(2*q5)*cos(q2)*cos(q4) + qd2*qd5*sin(2*q5)*cos(q2)*cos(q4) + 2*qd4*qd5*cos(2*q5)*cos(q4)*sin(q2) + 4*qd1*qd2*cos(q2)*cos(q4)^2*sin(q2) - 4*qd1*qd2*cos(q2)*cos(q5)^2*sin(q2) + 4*qd1*qd4*cos(q2)^2*cos(q4)*sin(q4) + 4*qd1*qd4*cos(q4)*cos(q5)^2*sin(q4) - 4*qd1*qd5*cos(q2)^2*cos(q5)*sin(q5) - 4*qd2*qd5*cos(q2)*cos(q5)^2*sin(q4) + 4*qd1*qd5*cos(q4)^2*cos(q5)*sin(q5) - qdd2*cos(q2)*cos(q5)*sin(q4)*sin(q5) - qd4*qd5*sin(2*q5)*sin(q2)*sin(q4) - 4*qd2*qd4*cos(q4)^2*cos(q5)^2*sin(q2) - qdd2*cos(q4)*cos(q5)^2*sin(q2)*sin(q4) + 2*qd2^2*cos(q5)*sin(q2)*sin(q4)*sin(q5) + 4*qd1*qd5*cos(q2)*cos(q4)*sin(q2) + 4*qd1*qd2*cos(q4)*cos(q5)*sin(q5) - 2*qd2^2*cos(q2)*cos(q4)*cos(q5)^2*sin(q4) - 8*qd1*qd2*cos(q2)^2*cos(q4)*cos(q5)*sin(q5) - 8*qd1*qd5*cos(q2)*cos(q4)*cos(q5)^2*sin(q2) - 2*qdd1*cos(q2)*cos(q4)*cos(q5)*sin(q2)*sin(q5) - 4*qd1*qd2*cos(q2)*cos(q4)^2*cos(q5)^2*sin(q2) - 4*qd1*qd4*cos(q2)^2*cos(q4)*cos(q5)^2*sin(q4) - 4*qd1*qd5*cos(q2)^2*cos(q4)^2*cos(q5)*sin(q5) - 2*qd2*qd4*cos(q2)*cos(q4)*cos(q5)*sin(q5) + 4*qd1*qd4*cos(q2)*cos(q5)*sin(q2)*sin(q4)*sin(q5) + 4*qd2*qd5*cos(q4)*cos(q5)*sin(q2)*sin(q4)*sin(q5), qdd1*cos(q2)^2 + qdd1*cos(q4)^2 - 2*qd2*qd4*sin(q2) - qdd1*cos(q2)^2*cos(q4)^2 - 2*qd1*qd2*sin(2*q2) - 2*qd1*qd4*sin(2*q4) + 4*qd2*qd4*cos(q4)^2*sin(q2) + qdd2*cos(q4)*sin(q2)*sin(q4) + 2*qd2^2*cos(q2)*cos(q4)*sin(q4) + 4*qd1*qd2*cos(q2)*cos(q4)^2*sin(q2) + 4*qd1*qd4*cos(q2)^2*cos(q4)*sin(q4), 4*qd1*qd5*cos(q2)^2 - 4*qd1*qd2*cos(q4) - 4*qd1*qd5*cos(q4)^2 + qdd2*cos(q2)*sin(q4) - 2*qd2^2*sin(q2)*sin(q4) + 4*qd2^2*cos(q5)^2*sin(q2)*sin(q4) + 8*qd1*qd2*cos(q2)^2*cos(q4) + 8*qd1*qd2*cos(q4)*cos(q5)^2 + 2*qdd1*cos(q2)*cos(q4)*sin(q2) + 4*qd1*qd5*cos(q2)^2*cos(q4)^2 - 8*qd1*qd5*cos(q2)^2*cos(q5)^2 + 8*qd1*qd5*cos(q4)^2*cos(q5)^2 - 2*qdd1*cos(q2)^2*cos(q5)*sin(q5) - 2*qdd2*cos(q2)*cos(q5)^2*sin(q4) + 2*qdd1*cos(q4)^2*cos(q5)*sin(q5) + 2*qd2*qd4*cos(q2)*cos(q4) - 4*qd2*qd4*cos(q2)*cos(q4)*cos(q5)^2 - 16*qd1*qd2*cos(q2)^2*cos(q4)*cos(q5)^2 - 4*qdd1*cos(q2)*cos(q4)*cos(q5)^2*sin(q2) - 8*qd1*qd5*cos(q2)^2*cos(q4)^2*cos(q5)^2 - 4*qd1*qd4*cos(q2)*sin(q2)*sin(q4) - 4*qd2*qd5*cos(q4)*sin(q2)*sin(q4) - 4*qd2*qd4*cos(q5)*sin(q2)*sin(q5) - 2*qdd1*cos(q2)^2*cos(q4)^2*cos(q5)*sin(q5) + 8*qd1*qd4*cos(q2)*cos(q5)^2*sin(q2)*sin(q4) + 8*qd2*qd4*cos(q4)^2*cos(q5)*sin(q2)*sin(q5) + 8*qd2*qd5*cos(q4)*cos(q5)^2*sin(q2)*sin(q4) + 2*qdd2*cos(q4)*cos(q5)*sin(q2)*sin(q4)*sin(q5) + 4*qd2^2*cos(q2)*cos(q4)*cos(q5)*sin(q4)*sin(q5) + 8*qd1*qd2*cos(q2)*cos(q5)*sin(q2)*sin(q5) - 8*qd1*qd4*cos(q4)*cos(q5)*sin(q4)*sin(q5) + 8*qd2*qd5*cos(q2)*cos(q5)*sin(q4)*sin(q5) + 16*qd1*qd5*cos(q2)*cos(q4)*cos(q5)*sin(q2)*sin(q5) + 8*qd1*qd2*cos(q2)*cos(q4)^2*cos(q5)*sin(q2)*sin(q5) + 8*qd1*qd4*cos(q2)^2*cos(q4)*cos(q5)*sin(q4)*sin(q5), 4*qd1*qd4*cos(q5) - qdd2*cos(q5)*sin(q2) - 2*qd2^2*cos(q2)*cos(q5) + 4*qd1*qd2*sin(q4)*sin(q5) + 2*qd2*qd5*sin(q2)*sin(q5) + 4*qd2^2*cos(q2)*cos(q4)^2*cos(q5) - 4*qd1*qd4*cos(q2)^2*cos(q5) - 8*qd1*qd4*cos(q4)^2*cos(q5) + qdd2*cos(q2)*cos(q4)*sin(q5) - 2*qdd1*cos(q4)*cos(q5)*sin(q4) + 2*qdd2*cos(q4)^2*cos(q5)*sin(q2) - 2*qd2^2*cos(q4)*sin(q2)*sin(q5) - 8*qd1*qd2*cos(q2)^2*sin(q4)*sin(q5) - 4*qd2*qd5*cos(q4)^2*sin(q2)*sin(q5) - 2*qdd1*cos(q2)*sin(q2)*sin(q4)*sin(q5) + 8*qd1*qd4*cos(q2)^2*cos(q4)^2*cos(q5) + 2*qdd1*cos(q2)^2*cos(q4)*cos(q5)*sin(q4) + 2*qd2*qd5*cos(q2)*cos(q4)*cos(q5) - 2*qd2*qd4*cos(q2)*sin(q4)*sin(q5) + 4*qd1*qd5*cos(q4)*sin(q4)*sin(q5) - 4*qd1*qd5*cos(q2)^2*cos(q4)*sin(q4)*sin(q5) - 4*qd1*qd4*cos(q2)*cos(q4)*sin(q2)*sin(q5) - 4*qd1*qd5*cos(q2)*cos(q5)*sin(q2)*sin(q4) - 8*qd2*qd4*cos(q4)*cos(q5)*sin(q2)*sin(q4) - 8*qd1*qd2*cos(q2)*cos(q4)*cos(q5)*sin(q2)*sin(q4), 4*qd1*qd4*sin(q5) - qdd2*sin(q2)*sin(q5) - 2*qd2^2*cos(q2)*sin(q5) + 4*qd2^2*cos(q2)*cos(q4)^2*sin(q5) - qdd2*cos(q2)*cos(q4)*cos(q5) - 4*qd1*qd4*cos(q2)^2*sin(q5) - 8*qd1*qd4*cos(q4)^2*sin(q5) - 2*qdd1*cos(q4)*sin(q4)*sin(q5) + 2*qd2^2*cos(q4)*cos(q5)*sin(q2) + 2*qdd2*cos(q4)^2*sin(q2)*sin(q5) - 4*qd1*qd2*cos(q5)*sin(q4) - 2*qd2*qd5*cos(q5)*sin(q2) + 8*qd1*qd2*cos(q2)^2*cos(q5)*sin(q4) + 4*qd2*qd5*cos(q4)^2*cos(q5)*sin(q2) + 2*qdd1*cos(q2)*cos(q5)*sin(q2)*sin(q4) + 8*qd1*qd4*cos(q2)^2*cos(q4)^2*sin(q5) + 2*qdd1*cos(q2)^2*cos(q4)*sin(q4)*sin(q5) + 2*qd2*qd4*cos(q2)*cos(q5)*sin(q4) + 2*qd2*qd5*cos(q2)*cos(q4)*sin(q5) - 4*qd1*qd5*cos(q4)*cos(q5)*sin(q4) + 4*qd1*qd5*cos(q2)^2*cos(q4)*cos(q5)*sin(q4) + 4*qd1*qd4*cos(q2)*cos(q4)*cos(q5)*sin(q2) - 4*qd1*qd5*cos(q2)*sin(q2)*sin(q4)*sin(q5) - 8*qd2*qd4*cos(q4)*sin(q2)*sin(q4)*sin(q5) - 8*qd1*qd2*cos(q2)*cos(q4)*sin(q2)*sin(q4)*sin(q5), -(1950414635604191*sin(q1))/2251799813685248,                                                 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          (qdd5*cos(q2)*sin(q1)*sin(q5))/100 + (qd5^2*cos(q2)*cos(q5)*sin(q1))/50 + 2*q3*qd5^2*cos(q2)*cos(q5)*sin(q1) + (qdd4*cos(q1)*cos(q2)*cos(q4)*sin(q5))/100 + (qdd5*cos(q1)*cos(q2)*cos(q5)*sin(q4))/100 - (qd4^2*cos(q1)*cos(q2)*sin(q4)*sin(q5))/50 - (qd5^2*cos(q1)*cos(q2)*sin(q4)*sin(q5))/50 + q3*qdd5*cos(q2)*sin(q1)*sin(q5) - 2*q3*qd4^2*cos(q1)*cos(q2)*sin(q4)*sin(q5) - 2*q3*qd5^2*cos(q1)*cos(q2)*sin(q4)*sin(q5) + (qd4*qd5*cos(q1)*cos(q2)*cos(q4)*cos(q5))/25 + q3*qdd4*cos(q1)*cos(q2)*cos(q4)*sin(q5) + q3*qdd5*cos(q1)*cos(q2)*cos(q5)*sin(q4) + 4*q3*qd4*qd5*cos(q1)*cos(q2)*cos(q4)*cos(q5),       0,                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      (qdd6*cos(q2)*sin(q1)*sin(q6))/100 + (qd6^2*cos(q2)*cos(q6)*sin(q1))/50 - (qdd6*cos(q1)*cos(q2)*cos(q4)*cos(q6))/100 + 2*q3*qd6^2*cos(q2)*cos(q6)*sin(q1) + (qdd4*cos(q1)*cos(q2)*sin(q4)*sin(q6))/100 + (qd4^2*cos(q1)*cos(q2)*cos(q4)*sin(q6))/50 + (qd6^2*cos(q1)*cos(q2)*cos(q4)*sin(q6))/50 + q3*qdd6*cos(q2)*sin(q1)*sin(q6) + 2*q3*qd4^2*cos(q1)*cos(q2)*cos(q4)*sin(q6) + 2*q3*qd6^2*cos(q1)*cos(q2)*cos(q4)*sin(q6) - q3*qdd6*cos(q1)*cos(q2)*cos(q4)*cos(q6) + (qd4*qd6*cos(q1)*cos(q2)*cos(q6)*sin(q4))/25 + q3*qdd4*cos(q1)*cos(q2)*sin(q4)*sin(q6) + 4*q3*qd4*qd6*cos(q1)*cos(q2)*cos(q6)*sin(q4), 2*q3*qdd1*cos(q2)^2 - cos(q2)*sin(q1) + 4*qd1*qd3*cos(q2)^2 - 4*q3*qd1*qd2*sin(2*q2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        (qdd1*cos(q2)^2)/5000 + (cos(q2)*sin(q1))/50 + (q3*qdd1*cos(q2)^2)/25 + (2*qd1*qd3*cos(q2)^2)/25 - (qd1*qd2*sin(2*q2))/2500 + 2*q3*cos(q2)*sin(q1) + 2*q3^2*qdd1*cos(q2)^2 - 4*q3^2*qd1*qd2*sin(2*q2) + (qdd5*cos(q2)*sin(q1)*sin(q5))/10000 + (qd5^2*cos(q2)*cos(q5)*sin(q1))/5000 + 8*q3*qd1*qd3*cos(q2)^2 - (2*q3*qd1*qd2*sin(2*q2))/25 + (q3*qd5^2*cos(q2)*cos(q5)*sin(q1))/50 + (qdd4*cos(q1)*cos(q2)*cos(q4)*sin(q5))/10000 + (qdd5*cos(q1)*cos(q2)*cos(q5)*sin(q4))/10000 - (qd4^2*cos(q1)*cos(q2)*sin(q4)*sin(q5))/5000 - (qd5^2*cos(q1)*cos(q2)*sin(q4)*sin(q5))/5000 + (q3*qdd5*cos(q2)*sin(q1)*sin(q5))/100 - (q3*qd4^2*cos(q1)*cos(q2)*sin(q4)*sin(q5))/50 - (q3*qd5^2*cos(q1)*cos(q2)*sin(q4)*sin(q5))/50 + (qd4*qd5*cos(q1)*cos(q2)*cos(q4)*cos(q5))/2500 + (q3*qdd4*cos(q1)*cos(q2)*cos(q4)*sin(q5))/100 + (q3*qdd5*cos(q1)*cos(q2)*cos(q5)*sin(q4))/100 + (q3*qd4*qd5*cos(q1)*cos(q2)*cos(q4)*cos(q5))/25, q3^2*qdd1*cos(q2)^2 - q3*cos(q2)*sin(q1) - 2*q3^2*qd1*qd2*sin(2*q2) + 4*q3*qd1*qd3*cos(q2)^2];
W(2+(i-1)*6,:)=[                                                                                                                                 (3*qdd2)/2 + (qdd2*cos(2*q4))/2 + 2*qd1*qd4*sin(q2) - 2*qd2*qd4*sin(2*q4) + 2*qd1^2*cos(q2)*cos(q4)^2*sin(q2) - 4*qd1*qd4*cos(q4)^2*sin(q2) - qdd1*cos(q4)*sin(q2)*sin(q4), -qdd1,                                                                                            (3*qdd2)/2 - (qdd2*cos(2*q4))/2 - 2*qd1*qd4*sin(q2) + 2*qd2*qd4*sin(2*q4) - 2*qd1^2*cos(q2)*cos(q4)^2*sin(q2) + 4*qd1*qd4*cos(q4)^2*sin(q2) + qdd1*cos(q4)*sin(q2)*sin(q4),                   -2*qd1^2*cos(2*q2),                                                           (9*qdd2)/400 - (43*cos(q1)*sin(q2))/20 - 2*q3*qdd2 - 4*qd2*qd3 + (9*qd1^2*sin(2*q2))/400 + q3^2*qdd2 + q3^2*qd1^2*sin(2*q2) + q3*cos(q1)*sin(q2) + 4*q3*qd2*qd3 - 2*q3*qd1^2*sin(2*q2),                                 - 2*cos(2*q2)*qd1^2 + 2*qd4*cos(q2)*qd1,              qdd1*cos(q2) - qdd4,                                     sin(2*q2)*qd1^2 - 2*qd4*sin(q2)*qd1,                                                                                                        2*qd1^2*cos(q4) - 2*qd4^2*cos(q4) - qdd4*sin(q4) - qdd5*sin(q4) - 2*qd4*qd5*cos(q4) - 4*qd1^2*cos(q2)^2*cos(q4) + qdd1*cos(q2)*sin(q4) + 4*qd1*qd4*cos(q2)*cos(q4) + 2*qd1*qd5*cos(q2)*cos(q4),                                                                                                                                                      qdd1*sin(q2) - qdd2*sin(2*q4) - 4*qd2*qd4*cos(2*q4) - 2*qdd1*cos(q4)^2*sin(q2) - 4*qd1^2*cos(q2)*cos(q4)*sin(q2)*sin(q4) + 8*qd1*qd4*cos(q4)*sin(q2)*sin(q4),                                                    qd1^2*sin(2*q2) - 2*qd1*qd4*sin(q2) - 2*qd1*qd5*sin(q2),                                                                                                        2*qd1^2*sin(q4) - 2*qd4^2*sin(q4) + qdd4*cos(q4) + qdd5*cos(q4) - 2*qd4*qd5*sin(q4) - 4*qd1^2*cos(q2)^2*sin(q4) - qdd1*cos(q2)*cos(q4) + 4*qd1*qd4*cos(q2)*sin(q4) + 2*qd1*qd5*cos(q2)*sin(q4),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            qdd2/4 - (qdd2*cos(2*q4))/4 + (qdd2*cos(2*q5))/4 + qd1^2*sin(2*q2) - qd1*qd4*sin(q2) - qd1*qd5*sin(q2) - (qdd2*cos(2*q4)*cos(2*q5))/4 - qd4^2*sin(2*q5)*cos(q4) - 2*qd5^2*cos(2*q5)*sin(q4) + qd2*qd4*sin(2*q4) - qd2*qd5*sin(2*q5) - (qdd4*sin(2*q5)*sin(q4))/2 - (qdd5*sin(2*q5)*sin(q4))/2 - 2*qd1^2*cos(q2)*cos(q5)^2*sin(q2) + qd1*qd4*cos(2*q5)*sin(q2) + qd1*qd5*cos(2*q5)*sin(q2) - 2*qd4*qd5*cos(2*q5)*sin(q4) - qd4*qd5*sin(2*q5)*cos(q4) - 2*qd1*qd4*cos(q5)^2*sin(q2) + qd2*qd4*cos(2*q5)*sin(2*q4) + qd2*qd5*cos(2*q4)*sin(2*q5) + 2*qd1^2*cos(q4)*cos(q5)*sin(q5) - 2*qd1*qd5*cos(q2)*sin(q4) + qd1*qd4*sin(2*q5)*cos(q2)*cos(q4) + qd1*qd5*sin(2*q5)*cos(q2)*cos(q4) + 4*qd1*qd5*cos(q2)*cos(q5)^2*sin(q4) + qdd1*cos(q2)*cos(q5)*sin(q4)*sin(q5) - 2*qd1^2*cos(q2)*cos(q4)^2*cos(q5)^2*sin(q2) + 4*qd1*qd4*cos(q4)^2*cos(q5)^2*sin(q2) + qdd1*cos(q4)*cos(q5)^2*sin(q2)*sin(q4) - 4*qd1^2*cos(q2)^2*cos(q4)*cos(q5)*sin(q5) + 2*qd1*qd4*cos(q2)*cos(q4)*cos(q5)*sin(q5) - 4*qd1*qd5*cos(q4)*cos(q5)*sin(q2)*sin(q4)*sin(q5),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      qdd6*cos(q5)*sin(q4) - qdd4*cos(q4)*sin(q5) - qdd5*cos(q4)*sin(q5) - qdd1*cos(q5)*sin(q2) - 2*qd5^2*cos(q4)*cos(q5) + qdd2*sin(2*q4)*cos(q5) - 2*qd1^2*sin(q4)*sin(q5) + 2*qd4^2*sin(q4)*sin(q5) + 2*qd1*qd5*sin(q2)*sin(q5) + 2*qd1*qd6*sin(q2)*sin(q5) + 2*qd4*qd5*sin(q4)*sin(q5) - 2*qd5*qd6*sin(q4)*sin(q5) + 4*qd1^2*cos(q2)^2*sin(q4)*sin(q5) + 4*qd2*qd4*cos(2*q4)*cos(q5) + qdd1*cos(q2)*cos(q4)*sin(q5) - 2*qd2*qd5*sin(2*q4)*sin(q5) + 2*qdd1*cos(q4)^2*cos(q5)*sin(q2) - 2*qd4*qd5*cos(q4)*cos(q5) + 2*qd4*qd6*cos(q4)*cos(q5) - 4*qd1*qd5*cos(q4)^2*sin(q2)*sin(q5) + 2*qd1*qd5*cos(q2)*cos(q4)*cos(q5) - 2*qd1*qd6*cos(q2)*cos(q4)*cos(q5) - 4*qd1*qd4*cos(q2)*sin(q4)*sin(q5) - 2*qd1*qd5*cos(q2)*sin(q4)*sin(q5) + 4*qd1^2*cos(q2)*cos(q4)*cos(q5)*sin(q2)*sin(q4) - 8*qd1*qd4*cos(q4)*cos(q5)*sin(q2)*sin(q4),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              4*qd1^2*cos(q2)^2*cos(q4) - (qdd2*sin(2*q5))/2 - 2*qd4^2*cos(2*q5)*cos(q4) - 2*qd1^2*cos(q4) + 4*qd1^2*cos(q4)*cos(q5)^2 + (qdd2*cos(2*q4)*sin(2*q5))/2 + 4*qd5^2*sin(2*q5)*sin(q4) - 2*qd2*qd5*cos(2*q5) - qdd1*cos(q2)*sin(q4) - qdd4*cos(2*q5)*sin(q4) - qdd5*cos(2*q5)*sin(q4) - 2*qd4*qd5*cos(2*q5)*cos(q4) - 2*qd1*qd4*sin(2*q5)*sin(q2) - 2*qd1*qd5*sin(2*q5)*sin(q2) + 4*qd4*qd5*sin(2*q5)*sin(q4) - 8*qd1^2*cos(q2)^2*cos(q4)*cos(q5)^2 + 2*qd2*qd5*cos(2*q4)*cos(2*q5) + 2*qdd1*cos(q2)*cos(q5)^2*sin(q4) - 2*qd2*qd4*sin(2*q4)*sin(2*q5) - 2*qd1*qd4*cos(q2)*cos(q4) + 2*qd1*qd4*cos(2*q5)*cos(q2)*cos(q4) + 2*qd1*qd5*cos(2*q5)*cos(q2)*cos(q4) + 4*qd1*qd4*cos(q2)*cos(q4)*cos(q5)^2 + 4*qd1^2*cos(q2)*cos(q5)*sin(q2)*sin(q5) + 4*qd1*qd5*cos(q4)*sin(q2)*sin(q4) + 4*qd1*qd4*cos(q5)*sin(q2)*sin(q5) - 8*qd1*qd4*cos(q4)^2*cos(q5)*sin(q2)*sin(q5) - 8*qd1*qd5*cos(q4)*cos(q5)^2*sin(q2)*sin(q4) - 2*qdd1*cos(q4)*cos(q5)*sin(q2)*sin(q4)*sin(q5) - 8*qd1*qd5*cos(q2)*cos(q5)*sin(q4)*sin(q5) + 4*qd1^2*cos(q2)*cos(q4)^2*cos(q5)*sin(q2)*sin(q5),                                                                                                                                     qdd2/2 + (qdd2*cos(2*q4))/2 - qd1^2*sin(2*q2) + qdd6*cos(q4) + 2*qd1*qd4*sin(q2) - 2*qd4*qd6*sin(q4) - 2*qd2*qd4*sin(2*q4) + 2*qd1^2*cos(q2)*cos(q4)^2*sin(q2) - 4*qd1*qd4*cos(q4)^2*sin(q2) - qdd1*cos(q4)*sin(q2)*sin(q4) + 2*qd1*qd6*cos(q2)*sin(q4),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      qdd1*sin(q2)*sin(q5) - qdd5*cos(q4)*cos(q5) - qdd4*cos(q4)*cos(q5) - qdd6*sin(q4)*sin(q5) - 2*qd1^2*cos(q5)*sin(q4) + 2*qd4^2*cos(q5)*sin(q4) + 2*qd5^2*cos(q4)*sin(q5) - qdd2*sin(2*q4)*sin(q5) + 4*qd1^2*cos(q2)^2*cos(q5)*sin(q4) + qdd1*cos(q2)*cos(q4)*cos(q5) - 4*qd2*qd4*cos(2*q4)*sin(q5) - 2*qd2*qd5*sin(2*q4)*cos(q5) - 2*qdd1*cos(q4)^2*sin(q2)*sin(q5) + 2*qd1*qd5*cos(q5)*sin(q2) + 2*qd1*qd6*cos(q5)*sin(q2) + 2*qd4*qd5*cos(q4)*sin(q5) + 2*qd4*qd5*cos(q5)*sin(q4) - 2*qd4*qd6*cos(q4)*sin(q5) - 2*qd5*qd6*cos(q5)*sin(q4) - 4*qd1*qd5*cos(q4)^2*cos(q5)*sin(q2) - 4*qd1*qd4*cos(q2)*cos(q5)*sin(q4) - 2*qd1*qd5*cos(q2)*cos(q4)*sin(q5) - 2*qd1*qd5*cos(q2)*cos(q5)*sin(q4) + 2*qd1*qd6*cos(q2)*cos(q4)*sin(q5) - 4*qd1^2*cos(q2)*cos(q4)*sin(q2)*sin(q4)*sin(q5) + 8*qd1*qd4*cos(q4)*sin(q2)*sin(q4)*sin(q5),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 qdd2/4 - (qdd2*cos(2*q4))/4 - (qdd2*cos(2*q5))/4 - 3*qd1*qd4*sin(q2) - qd1*qd5*sin(q2) + (qdd2*cos(2*q4)*cos(2*q5))/4 + qd4^2*sin(2*q5)*cos(q4) + 2*qd5^2*cos(2*q5)*sin(q4) + qd2*qd4*sin(2*q4) + qd2*qd5*sin(2*q5) + (qdd4*sin(2*q5)*sin(q4))/2 + (qdd5*sin(2*q5)*sin(q4))/2 - 2*qd1^2*cos(q2)*cos(q4)^2*sin(q2) + 2*qd1^2*cos(q2)*cos(q5)^2*sin(q2) - qd1*qd4*cos(2*q5)*sin(q2) - qd1*qd5*cos(2*q5)*sin(q2) + 2*qd4*qd5*cos(2*q5)*sin(q4) + qd4*qd5*sin(2*q5)*cos(q4) + 4*qd1*qd4*cos(q4)^2*sin(q2) + 2*qd1*qd4*cos(q5)^2*sin(q2) + qdd1*cos(q4)*sin(q2)*sin(q4) - qd2*qd4*cos(2*q5)*sin(2*q4) - qd2*qd5*cos(2*q4)*sin(2*q5) - 2*qd1^2*cos(q4)*cos(q5)*sin(q5) + 2*qd1*qd5*cos(q2)*sin(q4) - qd1*qd4*sin(2*q5)*cos(q2)*cos(q4) - qd1*qd5*sin(2*q5)*cos(q2)*cos(q4) - 4*qd1*qd5*cos(q2)*cos(q5)^2*sin(q4) - qdd1*cos(q2)*cos(q5)*sin(q4)*sin(q5) + 2*qd1^2*cos(q2)*cos(q4)^2*cos(q5)^2*sin(q2) - 4*qd1*qd4*cos(q4)^2*cos(q5)^2*sin(q2) - qdd1*cos(q4)*cos(q5)^2*sin(q2)*sin(q4) + 4*qd1^2*cos(q2)^2*cos(q4)*cos(q5)*sin(q5) - 2*qd1*qd4*cos(q2)*cos(q4)*cos(q5)*sin(q5) + 4*qd1*qd5*cos(q4)*cos(q5)*sin(q2)*sin(q4)*sin(q5),                                                                                                              qdd2/2 - (qdd2*cos(2*q4))/2 + qd1^2*sin(2*q2) - 2*qd1*qd4*sin(q2) + 2*qd2*qd4*sin(2*q4) - 2*qd1^2*cos(q2)*cos(q4)^2*sin(q2) + 4*qd1*qd4*cos(q4)^2*sin(q2) + qdd1*cos(q4)*sin(q2)*sin(q4),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        2*qd1^2*cos(q4) + (qdd2*sin(2*q5))/2 - 4*qd1^2*cos(q2)^2*cos(q4) - 4*qd1^2*cos(q4)*cos(q5)^2 - (qdd2*cos(2*q4)*sin(2*q5))/2 + 2*qd2*qd5*cos(2*q5) + qdd1*cos(q2)*sin(q4) + 8*qd1^2*cos(q2)^2*cos(q4)*cos(q5)^2 - 2*qd2*qd5*cos(2*q4)*cos(2*q5) - 2*qdd1*cos(q2)*cos(q5)^2*sin(q4) + 2*qd2*qd4*sin(2*q4)*sin(2*q5) + 2*qd1*qd4*cos(q2)*cos(q4) - 4*qd1*qd4*cos(q2)*cos(q4)*cos(q5)^2 - 4*qd1^2*cos(q2)*cos(q5)*sin(q2)*sin(q5) - 4*qd1*qd5*cos(q4)*sin(q2)*sin(q4) - 4*qd1*qd4*cos(q5)*sin(q2)*sin(q5) + 8*qd1*qd4*cos(q4)^2*cos(q5)*sin(q2)*sin(q5) + 8*qd1*qd5*cos(q4)*cos(q5)^2*sin(q2)*sin(q4) + 2*qdd1*cos(q4)*cos(q5)*sin(q2)*sin(q4)*sin(q5) + 8*qd1*qd5*cos(q2)*cos(q5)*sin(q4)*sin(q5) - 4*qd1^2*cos(q2)*cos(q4)^2*cos(q5)*sin(q2)*sin(q5),                                                                                                                                                                                                                                                                                                                                                                                                                                         qdd2*sin(2*q4)*cos(q5) - qdd1*cos(q5)*sin(q2) - 2*qd1^2*sin(q4)*sin(q5) + 2*qd1*qd5*sin(q2)*sin(q5) + 4*qd1^2*cos(q2)^2*sin(q4)*sin(q5) + 4*qd2*qd4*cos(2*q4)*cos(q5) + qdd1*cos(q2)*cos(q4)*sin(q5) - 2*qd2*qd5*sin(2*q4)*sin(q5) + 2*qdd1*cos(q4)^2*cos(q5)*sin(q2) - 4*qd1*qd5*cos(q4)^2*sin(q2)*sin(q5) + 2*qd1*qd5*cos(q2)*cos(q4)*cos(q5) - 2*qd1*qd4*cos(q2)*sin(q4)*sin(q5) + 4*qd1^2*cos(q2)*cos(q4)*cos(q5)*sin(q2)*sin(q4) - 8*qd1*qd4*cos(q4)*cos(q5)*sin(q2)*sin(q4),                                                                                                                                                                                                                                                                                                                                                                                                                                         2*qd1^2*cos(q5)*sin(q4) - qdd1*sin(q2)*sin(q5) + qdd2*sin(2*q4)*sin(q5) - 4*qd1^2*cos(q2)^2*cos(q5)*sin(q4) - qdd1*cos(q2)*cos(q4)*cos(q5) + 4*qd2*qd4*cos(2*q4)*sin(q5) + 2*qd2*qd5*sin(2*q4)*cos(q5) + 2*qdd1*cos(q4)^2*sin(q2)*sin(q5) - 2*qd1*qd5*cos(q5)*sin(q2) + 4*qd1*qd5*cos(q4)^2*cos(q5)*sin(q2) + 2*qd1*qd4*cos(q2)*cos(q5)*sin(q4) + 2*qd1*qd5*cos(q2)*cos(q4)*sin(q5) + 4*qd1^2*cos(q2)*cos(q4)*sin(q2)*sin(q4)*sin(q5) - 8*qd1*qd4*cos(q4)*sin(q2)*sin(q4)*sin(q5),                                            0,                                                 0,                                                                                                                                                                                                                                                                                                                          (qdd5*cos(q2)*cos(q4)*cos(q5))/100 + (qdd5*cos(q1)*sin(q2)*sin(q5))/100 - (qdd4*cos(q2)*sin(q4)*sin(q5))/100 + (qd5^2*cos(q1)*cos(q5)*sin(q2))/50 - (qd4^2*cos(q2)*cos(q4)*sin(q5))/50 - (qd5^2*cos(q2)*cos(q4)*sin(q5))/50 + 2*q3*qd5^2*cos(q1)*cos(q5)*sin(q2) - 2*q3*qd4^2*cos(q2)*cos(q4)*sin(q5) - 2*q3*qd5^2*cos(q2)*cos(q4)*sin(q5) - (qdd4*cos(q4)*sin(q1)*sin(q2)*sin(q5))/100 - (qdd5*cos(q5)*sin(q1)*sin(q2)*sin(q4))/100 + q3*qdd5*cos(q2)*cos(q4)*cos(q5) + (qd4^2*sin(q1)*sin(q2)*sin(q4)*sin(q5))/50 + (qd5^2*sin(q1)*sin(q2)*sin(q4)*sin(q5))/50 - (qd4*qd5*cos(q2)*cos(q5)*sin(q4))/25 + q3*qdd5*cos(q1)*sin(q2)*sin(q5) - q3*qdd4*cos(q2)*sin(q4)*sin(q5) + 2*q3*qd4^2*sin(q1)*sin(q2)*sin(q4)*sin(q5) + 2*q3*qd5^2*sin(q1)*sin(q2)*sin(q4)*sin(q5) - 4*q3*qd4*qd5*cos(q2)*cos(q5)*sin(q4) - (qd4*qd5*cos(q4)*cos(q5)*sin(q1)*sin(q2))/25 - q3*qdd4*cos(q4)*sin(q1)*sin(q2)*sin(q5) - q3*qdd5*cos(q5)*sin(q1)*sin(q2)*sin(q4) - 4*q3*qd4*qd5*cos(q4)*cos(q5)*sin(q1)*sin(q2),       0,                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     (qdd4*cos(q2)*cos(q4))/100 - (qd4^2*cos(q2)*sin(q4))/50 - 2*q3*qd4^2*cos(q2)*sin(q4) + (qdd6*cos(q1)*sin(q2)*sin(q6))/100 + (qd6^2*cos(q1)*cos(q6)*sin(q2))/50 + q3*qdd4*cos(q2)*cos(q4) + 2*q3*qd6^2*cos(q1)*cos(q6)*sin(q2) + (qdd6*cos(q4)*cos(q6)*sin(q1)*sin(q2))/100 - (qdd4*sin(q1)*sin(q2)*sin(q4)*sin(q6))/100 - (qd4^2*cos(q4)*sin(q1)*sin(q2)*sin(q6))/50 - (qd6^2*cos(q4)*sin(q1)*sin(q2)*sin(q6))/50 + q3*qdd6*cos(q1)*sin(q2)*sin(q6) - 2*q3*qd4^2*cos(q4)*sin(q1)*sin(q2)*sin(q6) - 2*q3*qd6^2*cos(q4)*sin(q1)*sin(q2)*sin(q6) + q3*qdd6*cos(q4)*cos(q6)*sin(q1)*sin(q2) - (qd4*qd6*cos(q6)*sin(q1)*sin(q2)*sin(q4))/25 - q3*qdd4*sin(q1)*sin(q2)*sin(q4)*sin(q6) - 4*q3*qd4*qd6*cos(q6)*sin(q1)*sin(q2)*sin(q4),                       2*q3*sin(2*q2)*qd1^2 - cos(q1)*sin(q2) + 2*q3*qdd2 + 4*qd2*qd3,                                                                                                                                                                               qdd2/5000 + (cos(q1)*sin(q2))/50 + (q3*qdd2)/25 + (2*qd2*qd3)/25 + (qd1^2*sin(2*q2))/5000 + 2*q3^2*qdd2 + 2*q3^2*qd1^2*sin(2*q2) + 2*q3*cos(q1)*sin(q2) + 8*q3*qd2*qd3 + (q3*qd1^2*sin(2*q2))/25 + (qdd5*cos(q2)*cos(q4)*cos(q5))/10000 + (qdd5*cos(q1)*sin(q2)*sin(q5))/10000 - (qdd4*cos(q2)*sin(q4)*sin(q5))/10000 + (qd5^2*cos(q1)*cos(q5)*sin(q2))/5000 - (qd4^2*cos(q2)*cos(q4)*sin(q5))/5000 - (qd5^2*cos(q2)*cos(q4)*sin(q5))/5000 + (q3*qd5^2*cos(q1)*cos(q5)*sin(q2))/50 - (q3*qd4^2*cos(q2)*cos(q4)*sin(q5))/50 - (q3*qd5^2*cos(q2)*cos(q4)*sin(q5))/50 - (qdd4*cos(q4)*sin(q1)*sin(q2)*sin(q5))/10000 - (qdd5*cos(q5)*sin(q1)*sin(q2)*sin(q4))/10000 + (q3*qdd5*cos(q2)*cos(q4)*cos(q5))/100 + (qd4^2*sin(q1)*sin(q2)*sin(q4)*sin(q5))/5000 + (qd5^2*sin(q1)*sin(q2)*sin(q4)*sin(q5))/5000 - (qd4*qd5*cos(q2)*cos(q5)*sin(q4))/2500 + (q3*qdd5*cos(q1)*sin(q2)*sin(q5))/100 - (q3*qdd4*cos(q2)*sin(q4)*sin(q5))/100 + (q3*qd4^2*sin(q1)*sin(q2)*sin(q4)*sin(q5))/50 + (q3*qd5^2*sin(q1)*sin(q2)*sin(q4)*sin(q5))/50 - (q3*qd4*qd5*cos(q2)*cos(q5)*sin(q4))/25 - (qd4*qd5*cos(q4)*cos(q5)*sin(q1)*sin(q2))/2500 - (q3*qdd4*cos(q4)*sin(q1)*sin(q2)*sin(q5))/100 - (q3*qdd5*cos(q5)*sin(q1)*sin(q2)*sin(q4))/100 - (q3*qd4*qd5*cos(q4)*cos(q5)*sin(q1)*sin(q2))/25,                         q3^2*qdd2 + q3^2*qd1^2*sin(2*q2) - q3*cos(q1)*sin(q2) + 4*q3*qd2*qd3];
W(3+(i-1)*6,:)=[                                                                                                                                                                                                                                                                                                          0,     0,                                                                                                                                                                                                                                                                     0,                                    0,                                                                                                                                                         qdd3 - cos(q1)*cos(q2) + 2*qd1^2*cos(q2)^2 - 2*q3*qd2^2 + 2*qd2^2 - 2*q3*qd1^2*cos(q2)^2,                                                                       0,                                0,                                                                       0,                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                 0,                                                                                                          0,                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                                                                                                                                                                                                                                                                                           0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  0,                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0,                                            0,                                                 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      qdd5*cos(q4)*cos(q5)*sin(q2) - qdd5*cos(q1)*cos(q2)*sin(q5) - qdd4*sin(q2)*sin(q4)*sin(q5) - 2*qd5^2*cos(q1)*cos(q2)*cos(q5) - 2*qd4^2*cos(q4)*sin(q2)*sin(q5) - 2*qd5^2*cos(q4)*sin(q2)*sin(q5) + qdd4*cos(q2)*cos(q4)*sin(q1)*sin(q5) + qdd5*cos(q2)*cos(q5)*sin(q1)*sin(q4) - 2*qd4^2*cos(q2)*sin(q1)*sin(q4)*sin(q5) - 2*qd5^2*cos(q2)*sin(q1)*sin(q4)*sin(q5) - 4*qd4*qd5*cos(q5)*sin(q2)*sin(q4) + 4*qd4*qd5*cos(q2)*cos(q4)*cos(q5)*sin(q1),       0,                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       qdd4*cos(q4)*sin(q2) - 2*qd4^2*sin(q2)*sin(q4) - qdd6*cos(q1)*cos(q2)*sin(q6) - 2*qd6^2*cos(q1)*cos(q2)*cos(q6) - qdd6*cos(q2)*cos(q4)*cos(q6)*sin(q1) + qdd4*cos(q2)*sin(q1)*sin(q4)*sin(q6) + 2*qd4^2*cos(q2)*cos(q4)*sin(q1)*sin(q6) + 2*qd6^2*cos(q2)*cos(q4)*sin(q1)*sin(q6) + 4*qd4*qd6*cos(q2)*cos(q6)*sin(q1)*sin(q4),                                                        - 2*qd1^2*cos(q2)^2 - 2*qd2^2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         2*qdd3 - 2*cos(q1)*cos(q2) - (qd1^2*cos(q2)^2)/25 - 4*q3*qd2^2 - qd2^2/25 - 4*q3*qd1^2*cos(q2)^2 - (qdd5*cos(q1)*cos(q2)*sin(q5))/100 + (qdd5*cos(q4)*cos(q5)*sin(q2))/100 - (qdd4*sin(q2)*sin(q4)*sin(q5))/100 - (qd5^2*cos(q1)*cos(q2)*cos(q5))/50 - (qd4^2*cos(q4)*sin(q2)*sin(q5))/50 - (qd5^2*cos(q4)*sin(q2)*sin(q5))/50 + (qdd4*cos(q2)*cos(q4)*sin(q1)*sin(q5))/100 + (qdd5*cos(q2)*cos(q5)*sin(q1)*sin(q4))/100 - (qd4^2*cos(q2)*sin(q1)*sin(q4)*sin(q5))/50 - (qd5^2*cos(q2)*sin(q1)*sin(q4)*sin(q5))/50 - (qd4*qd5*cos(q5)*sin(q2)*sin(q4))/25 + (qd4*qd5*cos(q2)*cos(q4)*cos(q5)*sin(q1))/25,                                   qdd3 + cos(q1)*cos(q2) - 2*q3*qd2^2 - 2*q3*qd1^2*cos(q2)^2];
W(4+(i-1)*6,:)=[                                                                                                                                                                                    qd2^2*sin(2*q4) - qd1^2*sin(2*q4) - 2*qd1*qd2*sin(q2) + 2*qd1^2*cos(q2)^2*cos(q4)*sin(q4) + 4*qd1*qd2*cos(q4)^2*sin(q2),     0,                                                                                                                                               qd1^2*sin(2*q4) - qd2^2*sin(2*q4) + 2*qd1*qd2*sin(q2) - 2*qd1^2*cos(q2)^2*cos(q4)*sin(q4) - 4*qd1*qd2*cos(q4)^2*sin(q2),                                    0,                                                                                                                                                                                                                                                0,                                      - qdd1*sin(q2) - 2*qd1*qd2*cos(q2),                            -qdd2,                                 qdd4 - qdd1*cos(q2) + 2*qd1*qd2*sin(q2),                                                                                                                                                     2*qd2*qd5*cos(q4) - qdd2*sin(q4) - qdd1*cos(q4)*sin(q2) - 2*qd1*qd5*sin(q2)*sin(q4) + 2*qd1^2*cos(q2)*sin(q2)*sin(q4) - 4*qd1*qd2*cos(q2)*cos(q4),                                                                                                                                                                             2*qd2^2*cos(2*q4) - 2*qd1^2*cos(q2)^2 - 4*qd1^2*cos(q4)^2 + 2*qd1^2 + 4*qd1^2*cos(q2)^2*cos(q4)^2 - 8*qd1*qd2*cos(q4)*sin(q2)*sin(q4),                                                             qdd4 + qdd5 - qdd1*cos(q2) + 2*qd1*qd2*sin(q2),                                                                                                                                                     qdd2*cos(q4) + 2*qd2*qd5*sin(q4) - qdd1*sin(q2)*sin(q4) - 2*qd1^2*cos(q2)*cos(q4)*sin(q2) - 4*qd1*qd2*cos(q2)*sin(q4) + 2*qd1*qd5*cos(q4)*sin(q2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        qdd4/2 + qdd5/2 - (qdd4*cos(2*q5))/2 - (qdd5*cos(2*q5))/2 - (qd2^2*sin(2*q4))/2 + 2*qd5^2*sin(2*q5) - (qdd1*cos(q2))/2 + qd1*qd2*sin(q2) + 2*qd4*qd5*sin(2*q5) - (qd2^2*cos(2*q5)*sin(2*q4))/2 + (qdd1*cos(2*q5)*cos(q2))/2 - (qdd2*sin(2*q5)*sin(q4))/2 + 2*qd1^2*cos(q4)*cos(q5)^2*sin(q4) - qd1*qd2*cos(2*q5)*sin(q2) - 2*qd1*qd5*sin(2*q5)*cos(q2) - 2*qd2*qd5*cos(2*q5)*sin(q4) + qd2*qd5*sin(2*q5)*cos(q4) + 2*qd1*qd2*cos(q5)^2*sin(q2) - (qdd1*sin(2*q5)*cos(q4)*sin(q2))/2 - qd1*qd2*sin(2*q5)*cos(q2)*cos(q4) - 2*qd1*qd5*cos(2*q5)*cos(q4)*sin(q2) - qd1*qd5*sin(2*q5)*sin(q2)*sin(q4) - 2*qd1^2*cos(q2)^2*cos(q4)*cos(q5)^2*sin(q4) - 4*qd1*qd2*cos(q4)^2*cos(q5)^2*sin(q2) + 2*qd1^2*cos(q2)*cos(q5)*sin(q2)*sin(q4)*sin(q5) - 2*qd1*qd2*cos(q2)*cos(q4)*cos(q5)*sin(q5),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        2*qd1^2*cos(q2)^2*cos(q5) - qdd6*sin(q5) - 2*qd5*qd6*cos(q5) - 2*qd2^2*cos(2*q4)*cos(q5) - 2*qd1^2*cos(q5) + 4*qd1^2*cos(q4)^2*cos(q5) - qdd2*cos(q4)*sin(q5) - 2*qd2*qd5*sin(q4)*sin(q5) - 4*qd1^2*cos(q2)^2*cos(q4)^2*cos(q5) + qdd1*sin(q2)*sin(q4)*sin(q5) - 2*qd2*qd5*cos(q4)*cos(q5) - 2*qd2*qd6*cos(q4)*cos(q5) + 2*qd1^2*cos(q2)*cos(q4)*sin(q2)*sin(q5) + 4*qd1*qd2*cos(q2)*sin(q4)*sin(q5) - 2*qd1*qd5*cos(q4)*sin(q2)*sin(q5) + 2*qd1*qd5*cos(q5)*sin(q2)*sin(q4) + 2*qd1*qd6*cos(q5)*sin(q2)*sin(q4) + 8*qd1*qd2*cos(q4)*cos(q5)*sin(q2)*sin(q4),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  qdd4*sin(2*q5) + qdd5*sin(2*q5) + 4*qd5^2*cos(2*q5) + 4*qd4*qd5*cos(2*q5) + qd2^2*sin(2*q4)*sin(2*q5) - qdd1*sin(2*q5)*cos(q2) - qdd2*cos(2*q5)*sin(q4) - 4*qd1*qd5*cos(2*q5)*cos(q2) + 2*qd2*qd5*cos(2*q5)*cos(q4) + 2*qd1*qd2*sin(2*q5)*sin(q2) + 4*qd2*qd5*sin(2*q5)*sin(q4) - qdd1*cos(2*q5)*cos(q4)*sin(q2) - 2*qd1^2*cos(q2)*sin(q2)*sin(q4) + 2*qd1*qd2*cos(q2)*cos(q4) + 4*qd1^2*cos(q2)*cos(q5)^2*sin(q2)*sin(q4) - 2*qd1*qd2*cos(2*q5)*cos(q2)*cos(q4) - 4*qd1*qd2*cos(q2)*cos(q4)*cos(q5)^2 - 2*qd1*qd5*cos(2*q5)*sin(q2)*sin(q4) + 4*qd1*qd5*sin(2*q5)*cos(q4)*sin(q2) - 4*qd1^2*cos(q4)*cos(q5)*sin(q4)*sin(q5) - 4*qd1*qd2*cos(q5)*sin(q2)*sin(q5) + 8*qd1*qd2*cos(q4)^2*cos(q5)*sin(q2)*sin(q5) + 4*qd1^2*cos(q2)^2*cos(q4)*cos(q5)*sin(q4)*sin(q5),                                                                                                                                                                                                                     qd2^2*sin(2*q4) - qd1^2*sin(2*q4) - 2*qd1*qd2*sin(q2) + 2*qd2*qd6*sin(q4) + 2*qd1^2*cos(q2)^2*cos(q4)*sin(q4) + 4*qd1*qd2*cos(q4)^2*sin(q2) + 2*qd1*qd6*cos(q4)*sin(q2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        2*qd1^2*sin(q5) - qdd6*cos(q5) + 2*qd5*qd6*sin(q5) + 2*qd2^2*cos(2*q4)*sin(q5) - 2*qd1^2*cos(q2)^2*sin(q5) - 4*qd1^2*cos(q4)^2*sin(q5) - qdd2*cos(q4)*cos(q5) + qdd1*cos(q5)*sin(q2)*sin(q4) + 4*qd1^2*cos(q2)^2*cos(q4)^2*sin(q5) + 2*qd2*qd5*cos(q4)*sin(q5) - 2*qd2*qd5*cos(q5)*sin(q4) + 2*qd2*qd6*cos(q4)*sin(q5) + 2*qd1^2*cos(q2)*cos(q4)*cos(q5)*sin(q2) + 4*qd1*qd2*cos(q2)*cos(q5)*sin(q4) - 2*qd1*qd5*cos(q4)*cos(q5)*sin(q2) - 2*qd1*qd5*sin(q2)*sin(q4)*sin(q5) - 2*qd1*qd6*sin(q2)*sin(q4)*sin(q5) - 8*qd1*qd2*cos(q4)*sin(q2)*sin(q4)*sin(q5),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        qdd4/2 + qdd5/2 + (qdd4*cos(2*q5))/2 + (qdd5*cos(2*q5))/2 + qd1^2*sin(2*q4) - (qd2^2*sin(2*q4))/2 - 2*qd5^2*sin(2*q5) - (qdd1*cos(q2))/2 + 3*qd1*qd2*sin(q2) - 2*qd4*qd5*sin(2*q5) + (qd2^2*cos(2*q5)*sin(2*q4))/2 - (qdd1*cos(2*q5)*cos(q2))/2 + (qdd2*sin(2*q5)*sin(q4))/2 - 2*qd1^2*cos(q2)^2*cos(q4)*sin(q4) - 2*qd1^2*cos(q4)*cos(q5)^2*sin(q4) + qd1*qd2*cos(2*q5)*sin(q2) + 2*qd1*qd5*sin(2*q5)*cos(q2) + 2*qd2*qd5*cos(2*q5)*sin(q4) - qd2*qd5*sin(2*q5)*cos(q4) - 4*qd1*qd2*cos(q4)^2*sin(q2) - 2*qd1*qd2*cos(q5)^2*sin(q2) + (qdd1*sin(2*q5)*cos(q4)*sin(q2))/2 + qd1*qd2*sin(2*q5)*cos(q2)*cos(q4) + 2*qd1*qd5*cos(2*q5)*cos(q4)*sin(q2) + qd1*qd5*sin(2*q5)*sin(q2)*sin(q4) + 2*qd1^2*cos(q2)^2*cos(q4)*cos(q5)^2*sin(q4) + 4*qd1*qd2*cos(q4)^2*cos(q5)^2*sin(q2) - 2*qd1^2*cos(q2)*cos(q5)*sin(q2)*sin(q4)*sin(q5) + 2*qd1*qd2*cos(q2)*cos(q4)*cos(q5)*sin(q5),                                                                                                                                                                               qd1^2*sin(2*q4) - qd2^2*sin(2*q4) + 2*qd1*qd2*sin(q2) - 2*qd1^2*cos(q2)^2*cos(q4)*sin(q4) - 4*qd1*qd2*cos(q4)^2*sin(q2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 2*qd1^2*cos(q2)*sin(q2)*sin(q4) - qd2^2*sin(2*q4)*sin(2*q5) - 2*qd1*qd2*cos(q2)*cos(q4) - 4*qd1^2*cos(q2)*cos(q5)^2*sin(q2)*sin(q4) + 4*qd1*qd2*cos(q2)*cos(q4)*cos(q5)^2 + 4*qd1^2*cos(q4)*cos(q5)*sin(q4)*sin(q5) + 4*qd1*qd2*cos(q5)*sin(q2)*sin(q5) - 8*qd1*qd2*cos(q4)^2*cos(q5)*sin(q2)*sin(q5) - 4*qd1^2*cos(q2)^2*cos(q4)*cos(q5)*sin(q4)*sin(q5),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       2*qd1^2*cos(q2)^2*cos(q5) - 2*qd2^2*cos(2*q4)*cos(q5) - 2*qd1^2*cos(q5) + 4*qd1^2*cos(q4)^2*cos(q5) - 4*qd1^2*cos(q2)^2*cos(q4)^2*cos(q5) + 2*qd1^2*cos(q2)*cos(q4)*sin(q2)*sin(q5) + 2*qd1*qd2*cos(q2)*sin(q4)*sin(q5) + 8*qd1*qd2*cos(q4)*cos(q5)*sin(q2)*sin(q4),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       2*qd1^2*cos(q2)^2*sin(q5) - 2*qd2^2*cos(2*q4)*sin(q5) - 2*qd1^2*sin(q5) + 4*qd1^2*cos(q4)^2*sin(q5) - 4*qd1^2*cos(q2)^2*cos(q4)^2*sin(q5) - 2*qd1^2*cos(q2)*cos(q4)*cos(q5)*sin(q2) - 2*qd1*qd2*cos(q2)*cos(q5)*sin(q4) + 8*qd1*qd2*cos(q4)*sin(q2)*sin(q4)*sin(q5),                                            0, qdd4/2 - (qdd4*cos(2*q5))/2 + 2*qd4*qd5*sin(2*q5),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        (qd2^2*sin(q2)*sin(q4)*sin(q5))/50 - qdd3*sin(q2)*sin(q4)*sin(q5) - (qdd2*cos(q2)*sin(q4)*sin(q5))/100 + (qdd1*cos(q1)*cos(q2)*cos(q4)*sin(q5))/100 + qdd3*cos(q2)*cos(q4)*sin(q1)*sin(q5) + 2*q3*qd2^2*sin(q2)*sin(q4)*sin(q5) - (qdd2*cos(q4)*sin(q1)*sin(q2)*sin(q5))/100 - (qd1^2*cos(q2)*cos(q4)*sin(q1)*sin(q5))/50 - (qd2^2*cos(q2)*cos(q4)*sin(q1)*sin(q5))/50 - q3*qdd2*cos(q2)*sin(q4)*sin(q5) - 4*qd2*qd3*cos(q2)*sin(q4)*sin(q5) - 2*q3*qd1^2*cos(q2)*cos(q4)*sin(q1)*sin(q5) - 2*q3*qd2^2*cos(q2)*cos(q4)*sin(q1)*sin(q5) + q3*qdd1*cos(q1)*cos(q2)*cos(q4)*sin(q5) + 4*qd1*qd3*cos(q1)*cos(q2)*cos(q4)*sin(q5) - (qd1*qd2*cos(q1)*cos(q4)*sin(q2)*sin(q5))/25 - q3*qdd2*cos(q4)*sin(q1)*sin(q2)*sin(q5) - 4*qd2*qd3*cos(q4)*sin(q1)*sin(q2)*sin(q5) - 4*q3*qd1*qd2*cos(q1)*cos(q4)*sin(q2)*sin(q5),       0, (3*qdd4)/4 + (qdd4*cos(2*q4))/4 - (qdd4*cos(2*q6))/4 - (qd4^2*sin(2*q4))/2 + (qd6^2*sin(2*q4))/2 + (qdd4*cos(2*q4)*cos(2*q6))/4 - (qdd6*sin(2*q4)*sin(2*q6))/4 + qd4*qd6*sin(2*q6) - (qd4^2*cos(2*q6)*sin(2*q4))/2 - (qd6^2*cos(2*q6)*sin(2*q4))/2 - qd4*qd6*cos(2*q4)*sin(2*q6), (qdd5*cos(q5))/200 - (qd5^2*sin(q5))/100 - (qd4^2*cos(2*q4)*sin(q5))/50 - (qd5^2*cos(2*q4)*sin(q5))/100 + (qdd2*cos(q2)*cos(q4))/100 + qdd3*cos(q4)*sin(q2) + (qdd5*cos(q5)*sin(q6))/200 - (qdd6*cos(q6)*sin(q5))/200 + (qdd5*cos(2*q4)*cos(q5))/200 - (qd2^2*cos(q4)*sin(q2))/50 - (qdd4*sin(2*q4)*sin(q5))/100 - (qd5^2*sin(q5)*sin(q6))/100 + (qd6^2*sin(q5)*sin(q6))/100 + (qd4^2*cos(2*q4)*sin(q5)*sin(q6))/50 + (qd5^2*cos(2*q4)*sin(q5)*sin(q6))/100 + (qd6^2*cos(2*q4)*sin(q5)*sin(q6))/100 - 2*q3*qd2^2*cos(q4)*sin(q2) - (qd4*qd5*sin(2*q4)*cos(q5))/50 - (qdd5*cos(2*q4)*cos(q5)*sin(q6))/200 - (qdd6*cos(2*q4)*cos(q6)*sin(q5))/200 + (qdd4*sin(2*q4)*sin(q5)*sin(q6))/100 + q3*qdd2*cos(q2)*cos(q4) + 4*qd2*qd3*cos(q2)*cos(q4) + (qd4*qd5*sin(2*q4)*cos(q5)*sin(q6))/50 + (qd4*qd6*sin(2*q4)*cos(q6)*sin(q5))/50 + (qdd1*cos(q1)*cos(q2)*sin(q4)*sin(q6))/100 + qdd3*cos(q2)*sin(q1)*sin(q4)*sin(q6) - (qdd2*sin(q1)*sin(q2)*sin(q4)*sin(q6))/100 - (qd1^2*cos(q2)*sin(q1)*sin(q4)*sin(q6))/50 - (qd2^2*cos(q2)*sin(q1)*sin(q4)*sin(q6))/50 - 2*q3*qd1^2*cos(q2)*sin(q1)*sin(q4)*sin(q6) - 2*q3*qd2^2*cos(q2)*sin(q1)*sin(q4)*sin(q6) + q3*qdd1*cos(q1)*cos(q2)*sin(q4)*sin(q6) + 4*qd1*qd3*cos(q1)*cos(q2)*sin(q4)*sin(q6) - (qd1*qd2*cos(q1)*sin(q2)*sin(q4)*sin(q6))/25 - q3*qdd2*sin(q1)*sin(q2)*sin(q4)*sin(q6) - 4*qd2*qd3*sin(q1)*sin(q2)*sin(q4)*sin(q6) - 4*q3*qd1*qd2*cos(q1)*sin(q2)*sin(q4)*sin(q6),                                                                                    0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               qdd4/20000 - (qdd4*cos(2*q5))/20000 + (qd4*qd5*sin(2*q5))/5000 - (qdd2*cos(q2)*sin(q4)*sin(q5))/10000 - (qdd3*sin(q2)*sin(q4)*sin(q5))/100 + (qd2^2*sin(q2)*sin(q4)*sin(q5))/5000 + (qdd1*cos(q1)*cos(q2)*cos(q4)*sin(q5))/10000 + (qdd3*cos(q2)*cos(q4)*sin(q1)*sin(q5))/100 + (q3*qd2^2*sin(q2)*sin(q4)*sin(q5))/50 - (qdd2*cos(q4)*sin(q1)*sin(q2)*sin(q5))/10000 - (qd1^2*cos(q2)*cos(q4)*sin(q1)*sin(q5))/5000 - (qd2^2*cos(q2)*cos(q4)*sin(q1)*sin(q5))/5000 - (q3*qdd2*cos(q2)*sin(q4)*sin(q5))/100 - (qd2*qd3*cos(q2)*sin(q4)*sin(q5))/25 - (q3*qd1^2*cos(q2)*cos(q4)*sin(q1)*sin(q5))/50 - (q3*qd2^2*cos(q2)*cos(q4)*sin(q1)*sin(q5))/50 + (q3*qdd1*cos(q1)*cos(q2)*cos(q4)*sin(q5))/100 + (qd1*qd3*cos(q1)*cos(q2)*cos(q4)*sin(q5))/25 - (qd1*qd2*cos(q1)*cos(q4)*sin(q2)*sin(q5))/2500 - (q3*qdd2*cos(q4)*sin(q1)*sin(q2)*sin(q5))/100 - (qd2*qd3*cos(q4)*sin(q1)*sin(q2)*sin(q5))/25 - (q3*qd1*qd2*cos(q1)*cos(q4)*sin(q2)*sin(q5))/25,                                                                                            0];
W(5+(i-1)*6,:)=[                                                                                                                                                                                                                                                                                                          0,     0,                                                                                                                                                                                                                                                                     0,                                    0,                                                                                                                                                                                                                                                0,                                                                       0,                                0,                                                                       0,                                                                                                                                                                                       2*qd1*qd4*sin(q2)*sin(q4) - 2*qd2*qd4*cos(q4) - qdd1*cos(q4)*sin(q2) - qdd2*sin(q4) - 2*qd1*qd2*cos(q2)*cos(q4),                                                                                                                                                                                                                                                                                                                 0,                                                             qdd4 + qdd5 - qdd1*cos(q2) + 2*qd1*qd2*sin(q2),                                                                                                                                                                                       qdd2*cos(q4) - 2*qd2*qd4*sin(q4) - qdd1*sin(q2)*sin(q4) - 2*qd1*qd2*cos(q2)*sin(q4) - 2*qd1*qd4*cos(q4)*sin(q2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                qdd4/2 + qdd5 - (qdd4*cos(2*q5))/2 - qdd5*cos(q5)^2 + (qd2^2*sin(2*q5))/2 - qd4^2*sin(2*q5) + qd5^2*sin(2*q5) - (qdd1*cos(q2))/2 + qd1*qd2*sin(q2) - (qd2^2*cos(2*q4)*sin(2*q5))/2 + (qdd1*cos(2*q5)*cos(q2))/2 - (qdd2*sin(2*q5)*sin(q4))/2 - 2*qd1^2*cos(q2)^2*cos(q5)*sin(q5) + 2*qd1^2*cos(q4)^2*cos(q5)*sin(q5) - qd1*qd2*cos(2*q5)*sin(q2) + 2*qd1*qd4*sin(2*q5)*cos(q2) + 2*qd2*qd4*cos(2*q5)*sin(q4) - qd2*qd4*sin(2*q5)*cos(q4) + 2*qd1^2*cos(q2)*cos(q4)*sin(q2) - (qdd1*sin(2*q5)*cos(q4)*sin(q2))/2 + 2*qd1*qd2*cos(q2)*sin(q4) - qd1*qd2*sin(2*q5)*cos(q2)*cos(q4) + 2*qd1*qd4*cos(2*q5)*cos(q4)*sin(q2) - 4*qd1*qd2*cos(q2)*cos(q5)^2*sin(q4) + qd1*qd4*sin(2*q5)*sin(q2)*sin(q4) - 2*qd1^2*cos(q2)^2*cos(q4)^2*cos(q5)*sin(q5) - 4*qd1^2*cos(q2)*cos(q4)*cos(q5)^2*sin(q2) + 4*qd1*qd2*cos(q4)*cos(q5)*sin(q2)*sin(q4)*sin(q5),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      2*qd4*qd6*cos(q5) - qdd6*sin(q5) + qd2^2*sin(2*q4)*sin(q5) - qdd2*cos(q4)*sin(q5) - 2*qd1*qd2*sin(q2)*sin(q5) + 2*qd2*qd4*sin(q4)*sin(q5) + 2*qd2*qd6*sin(q4)*sin(q5) + qdd1*sin(q2)*sin(q4)*sin(q5) - 2*qd1^2*cos(q4)*sin(q4)*sin(q5) - 2*qd1*qd6*cos(q2)*cos(q5) + 2*qd2*qd4*cos(q4)*cos(q5) + 2*qd1^2*cos(q2)^2*cos(q4)*sin(q4)*sin(q5) + 4*qd1*qd2*cos(q4)^2*sin(q2)*sin(q5) + 2*qd1^2*cos(q2)*cos(q5)*sin(q2)*sin(q4) - 2*qd1*qd2*cos(q2)*cos(q4)*cos(q5) + 2*qd1*qd2*cos(q2)*sin(q4)*sin(q5) + 2*qd1*qd4*cos(q4)*sin(q2)*sin(q5) - 2*qd1*qd4*cos(q5)*sin(q2)*sin(q4) + 2*qd1*qd6*cos(q4)*sin(q2)*sin(q5),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              qdd4*sin(2*q5) + qdd5*sin(2*q5) + qd2^2*cos(2*q5) - 2*qd4^2*cos(2*q5) + 2*qd1^2*cos(q2)^2 - 2*qd1^2*cos(q4)^2 + 4*qd5^2*cos(q5)^2 - 2*qd5^2 - qd2^2*cos(2*q4)*cos(2*q5) + 2*qd1^2*cos(q2)^2*cos(q4)^2 - 4*qd1^2*cos(q2)^2*cos(q5)^2 + 4*qd1^2*cos(q4)^2*cos(q5)^2 - qdd1*sin(2*q5)*cos(q2) - qdd2*cos(2*q5)*sin(q4) + 4*qd1*qd4*cos(2*q5)*cos(q2) - 2*qd2*qd4*cos(2*q5)*cos(q4) + 2*qd1*qd2*sin(2*q5)*sin(q2) - 4*qd2*qd4*sin(2*q5)*sin(q4) - qdd1*cos(2*q5)*cos(q4)*sin(q2) - 4*qd1^2*cos(q2)^2*cos(q4)^2*cos(q5)^2 - 2*qd1*qd2*cos(2*q5)*cos(q2)*cos(q4) + 2*qd1*qd4*cos(2*q5)*sin(q2)*sin(q4) - 4*qd1*qd4*sin(2*q5)*cos(q4)*sin(q2) - 4*qd1*qd2*cos(q4)*sin(q2)*sin(q4) + 8*qd1*qd2*cos(q4)*cos(q5)^2*sin(q2)*sin(q4) + 8*qd1^2*cos(q2)*cos(q4)*cos(q5)*sin(q2)*sin(q5) + 8*qd1*qd2*cos(q2)*cos(q5)*sin(q4)*sin(q5),                                                                                                                                                                                                                                                                                                                                                                                           0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      qd2^2*sin(2*q4)*cos(q5) - 2*qd4*qd6*sin(q5) - qdd6*cos(q5) - qdd2*cos(q4)*cos(q5) + qdd1*cos(q5)*sin(q2)*sin(q4) - 2*qd1^2*cos(q4)*cos(q5)*sin(q4) - 2*qd1*qd2*cos(q5)*sin(q2) + 2*qd1*qd6*cos(q2)*sin(q5) - 2*qd2*qd4*cos(q4)*sin(q5) + 2*qd2*qd4*cos(q5)*sin(q4) + 2*qd2*qd6*cos(q5)*sin(q4) + 4*qd1*qd2*cos(q4)^2*cos(q5)*sin(q2) - 2*qd1^2*cos(q2)*sin(q2)*sin(q4)*sin(q5) + 2*qd1*qd2*cos(q2)*cos(q4)*sin(q5) + 2*qd1*qd2*cos(q2)*cos(q5)*sin(q4) + 2*qd1*qd4*cos(q4)*cos(q5)*sin(q2) + 2*qd1*qd6*cos(q4)*cos(q5)*sin(q2) + 2*qd1*qd4*sin(q2)*sin(q4)*sin(q5) + 2*qd1^2*cos(q2)^2*cos(q4)*cos(q5)*sin(q4),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             qdd4/2 + (qdd4*cos(2*q5))/2 + qdd5*cos(q5)^2 - (qd2^2*sin(2*q5))/2 + qd4^2*sin(2*q5) - qd5^2*sin(2*q5) - (qdd1*cos(q2))/2 + qd1*qd2*sin(q2) + (qd2^2*cos(2*q4)*sin(2*q5))/2 - (qdd1*cos(2*q5)*cos(q2))/2 + (qdd2*sin(2*q5)*sin(q4))/2 + 2*qd1^2*cos(q2)^2*cos(q5)*sin(q5) - 2*qd1^2*cos(q4)^2*cos(q5)*sin(q5) + qd1*qd2*cos(2*q5)*sin(q2) - 2*qd1*qd4*sin(2*q5)*cos(q2) - 2*qd2*qd4*cos(2*q5)*sin(q4) + qd2*qd4*sin(2*q5)*cos(q4) - 2*qd1^2*cos(q2)*cos(q4)*sin(q2) + (qdd1*sin(2*q5)*cos(q4)*sin(q2))/2 - 2*qd1*qd2*cos(q2)*sin(q4) + qd1*qd2*sin(2*q5)*cos(q2)*cos(q4) - 2*qd1*qd4*cos(2*q5)*cos(q4)*sin(q2) + 4*qd1*qd2*cos(q2)*cos(q5)^2*sin(q4) - qd1*qd4*sin(2*q5)*sin(q2)*sin(q4) + 2*qd1^2*cos(q2)^2*cos(q4)^2*cos(q5)*sin(q5) + 4*qd1^2*cos(q2)*cos(q4)*cos(q5)^2*sin(q2) - 4*qd1*qd2*cos(q4)*cos(q5)*sin(q2)*sin(q4)*sin(q5),                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     2*qd1^2*cos(q4)^2 - 2*qd1^2*cos(q2)^2 - qd2^2*cos(2*q5) + qd2^2*cos(2*q4)*cos(2*q5) - 2*qd1^2*cos(q2)^2*cos(q4)^2 + 4*qd1^2*cos(q2)^2*cos(q5)^2 - 4*qd1^2*cos(q4)^2*cos(q5)^2 + 4*qd1^2*cos(q2)^2*cos(q4)^2*cos(q5)^2 + 4*qd1*qd2*cos(q4)*sin(q2)*sin(q4) - 8*qd1*qd2*cos(q4)*cos(q5)^2*sin(q2)*sin(q4) - 8*qd1^2*cos(q2)*cos(q4)*cos(q5)*sin(q2)*sin(q5) - 8*qd1*qd2*cos(q2)*cos(q5)*sin(q4)*sin(q5),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     qd2^2*sin(2*q4)*sin(q5) - 2*qd1*qd2*sin(q2)*sin(q5) - 2*qd1^2*cos(q4)*sin(q4)*sin(q5) + 2*qd1^2*cos(q2)^2*cos(q4)*sin(q4)*sin(q5) + 4*qd1*qd2*cos(q4)^2*sin(q2)*sin(q5) + 2*qd1^2*cos(q2)*cos(q5)*sin(q2)*sin(q4) - 2*qd1*qd2*cos(q2)*cos(q4)*cos(q5),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     2*qd1^2*cos(q4)*cos(q5)*sin(q4) - qd2^2*sin(2*q4)*cos(q5) + 2*qd1*qd2*cos(q5)*sin(q2) - 4*qd1*qd2*cos(q4)^2*cos(q5)*sin(q2) + 2*qd1^2*cos(q2)*sin(q2)*sin(q4)*sin(q5) - 2*qd1*qd2*cos(q2)*cos(q4)*sin(q5) - 2*qd1^2*cos(q2)^2*cos(q4)*cos(q5)*sin(q4),                                            0,                          - sin(2*q5)*qd4^2 + qdd5, sin(q5) + (qdd2*cos(q2)*cos(q4)*cos(q5))/100 - qdd3*cos(q1)*cos(q2)*sin(q5) + qdd3*cos(q4)*cos(q5)*sin(q2) + (qdd1*cos(q2)*sin(q1)*sin(q5))/100 + (qdd2*cos(q1)*sin(q2)*sin(q5))/100 + (qd1^2*cos(q1)*cos(q2)*sin(q5))/50 + (qd2^2*cos(q1)*cos(q2)*sin(q5))/50 - (qd2^2*cos(q4)*cos(q5)*sin(q2))/50 + 2*q3*qd1^2*cos(q1)*cos(q2)*sin(q5) + 2*q3*qd2^2*cos(q1)*cos(q2)*sin(q5) - 2*q3*qd2^2*cos(q4)*cos(q5)*sin(q2) + (qdd1*cos(q1)*cos(q2)*cos(q5)*sin(q4))/100 + qdd3*cos(q2)*cos(q5)*sin(q1)*sin(q4) - (qdd2*cos(q5)*sin(q1)*sin(q2)*sin(q4))/100 - (qd1^2*cos(q2)*cos(q5)*sin(q1)*sin(q4))/50 - (qd2^2*cos(q2)*cos(q5)*sin(q1)*sin(q4))/50 + q3*qdd2*cos(q2)*cos(q4)*cos(q5) + 4*qd2*qd3*cos(q2)*cos(q4)*cos(q5) + q3*qdd1*cos(q2)*sin(q1)*sin(q5) + q3*qdd2*cos(q1)*sin(q2)*sin(q5) + 4*qd1*qd3*cos(q2)*sin(q1)*sin(q5) + 4*qd2*qd3*cos(q1)*sin(q2)*sin(q5) - (qd1*qd2*sin(q1)*sin(q2)*sin(q5))/25 - 2*q3*qd1^2*cos(q2)*cos(q5)*sin(q1)*sin(q4) - 2*q3*qd2^2*cos(q2)*cos(q5)*sin(q1)*sin(q4) - 4*q3*qd1*qd2*sin(q1)*sin(q2)*sin(q5) + q3*qdd1*cos(q1)*cos(q2)*cos(q5)*sin(q4) + 4*qd1*qd3*cos(q1)*cos(q2)*cos(q5)*sin(q4) - (qd1*qd2*cos(q1)*cos(q5)*sin(q2)*sin(q4))/25 - q3*qdd2*cos(q5)*sin(q1)*sin(q2)*sin(q4) - 4*qd2*qd3*cos(q5)*sin(q1)*sin(q2)*sin(q4) - 4*q3*qd1*qd2*cos(q1)*cos(q5)*sin(q2)*sin(q4), sin(q5),                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      (qdd4*cos(q5))/200 - (qd4^2*sin(2*q4)*cos(q5))/100 + (qdd4*cos(q5)*sin(q6))/200 + (qdd6*sin(q5)*sin(q6))/100 + (qdd4*cos(2*q4)*cos(q5))/200 + (qd6^2*cos(q6)*sin(q5))/50 + (qd4^2*sin(2*q4)*cos(q5)*sin(q6))/100 + (qd6^2*sin(2*q4)*cos(q5)*sin(q6))/100 - (qdd4*cos(2*q4)*cos(q5)*sin(q6))/200 - (qdd6*sin(2*q4)*cos(q5)*cos(q6))/200 + (qd4*qd6*cos(q5)*cos(q6))/50 - (qd4*qd6*cos(2*q4)*cos(q5)*cos(q6))/50,                                                                                    0, qdd5/10000 - (qd4^2*sin(2*q5))/10000 + (qdd2*cos(q2)*cos(q4)*cos(q5))/10000 - (qdd3*cos(q1)*cos(q2)*sin(q5))/100 + (qdd3*cos(q4)*cos(q5)*sin(q2))/100 + (qdd1*cos(q2)*sin(q1)*sin(q5))/10000 + (qdd2*cos(q1)*sin(q2)*sin(q5))/10000 + (qd1^2*cos(q1)*cos(q2)*sin(q5))/5000 + (qd2^2*cos(q1)*cos(q2)*sin(q5))/5000 - (qd2^2*cos(q4)*cos(q5)*sin(q2))/5000 + (q3*qd1^2*cos(q1)*cos(q2)*sin(q5))/50 + (q3*qd2^2*cos(q1)*cos(q2)*sin(q5))/50 - (q3*qd2^2*cos(q4)*cos(q5)*sin(q2))/50 + (qdd1*cos(q1)*cos(q2)*cos(q5)*sin(q4))/10000 + (qdd3*cos(q2)*cos(q5)*sin(q1)*sin(q4))/100 - (qdd2*cos(q5)*sin(q1)*sin(q2)*sin(q4))/10000 - (qd1^2*cos(q2)*cos(q5)*sin(q1)*sin(q4))/5000 - (qd2^2*cos(q2)*cos(q5)*sin(q1)*sin(q4))/5000 + (q3*qdd2*cos(q2)*cos(q4)*cos(q5))/100 + (qd2*qd3*cos(q2)*cos(q4)*cos(q5))/25 + (q3*qdd1*cos(q2)*sin(q1)*sin(q5))/100 + (q3*qdd2*cos(q1)*sin(q2)*sin(q5))/100 + (qd1*qd3*cos(q2)*sin(q1)*sin(q5))/25 + (qd2*qd3*cos(q1)*sin(q2)*sin(q5))/25 - (qd1*qd2*sin(q1)*sin(q2)*sin(q5))/2500 - (q3*qd1^2*cos(q2)*cos(q5)*sin(q1)*sin(q4))/50 - (q3*qd2^2*cos(q2)*cos(q5)*sin(q1)*sin(q4))/50 - (q3*qd1*qd2*sin(q1)*sin(q2)*sin(q5))/25 + (q3*qdd1*cos(q1)*cos(q2)*cos(q5)*sin(q4))/100 + (qd1*qd3*cos(q1)*cos(q2)*cos(q5)*sin(q4))/25 - (qd1*qd2*cos(q1)*cos(q5)*sin(q2)*sin(q4))/2500 - (q3*qdd2*cos(q5)*sin(q1)*sin(q2)*sin(q4))/100 - (qd2*qd3*cos(q5)*sin(q1)*sin(q2)*sin(q4))/25 - (q3*qd1*qd2*cos(q1)*cos(q5)*sin(q2)*sin(q4))/25,                                                                                            0];
W(6+(i-1)*6,:)=[                                                                                                                                                                                                                                                                                                          0,     0,                                                                                                                                                                                                                                                                     0,                                    0,                                                                                                                                                                                                                                                0,                                                                       0,                                0,                                                                       0,                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                 0,                                                                                                          0,                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          qdd1*cos(q2)*sin(q5) - qdd4*sin(q5) - qdd5*sin(q5) - 2*qd4*qd5*cos(q5) - 2*qd5^2*cos(q5) + qdd2*cos(q5)*sin(q4) - 2*qd1*qd2*sin(q2)*sin(q5) - 2*qd2*qd5*sin(q4)*sin(q5) + qdd1*cos(q4)*cos(q5)*sin(q2) + 2*qd1*qd5*cos(q2)*cos(q5) + 2*qd2*qd4*cos(q4)*cos(q5) + 2*qd1*qd2*cos(q2)*cos(q4)*cos(q5) - 2*qd1*qd4*cos(q5)*sin(q2)*sin(q4) - 2*qd1*qd5*cos(q4)*sin(q2)*sin(q5),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                                                                                                                                                                      qdd6 + qdd2*cos(q4) - 2*qd2*qd4*sin(q4) - qdd1*sin(q2)*sin(q4) - 2*qd1*qd2*cos(q2)*sin(q4) - 2*qd1*qd4*cos(q4)*sin(q2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          2*qd5^2*sin(q5) - qdd4*cos(q5) - qdd5*cos(q5) + 2*qd4*qd5*sin(q5) + qdd1*cos(q2)*cos(q5) - qdd2*sin(q4)*sin(q5) - qdd1*cos(q4)*sin(q2)*sin(q5) - 2*qd1*qd2*cos(q5)*sin(q2) - 2*qd1*qd5*cos(q2)*sin(q5) - 2*qd2*qd4*cos(q4)*sin(q5) - 2*qd2*qd5*cos(q5)*sin(q4) - 2*qd1*qd2*cos(q2)*cos(q4)*sin(q5) - 2*qd1*qd5*cos(q4)*cos(q5)*sin(q2) + 2*qd1*qd4*sin(q2)*sin(q4)*sin(q5),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  0,                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0,                                            0,                                                 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       0,       0, (3*qdd6)/4 + (qdd6*cos(2*q4))/4 - (qdd6*cos(2*q6))/4 - (qd4^2*sin(2*q6))/2 + (qd6^2*sin(2*q6))/2 + (qdd6*cos(2*q4)*cos(2*q6))/4 - (qdd4*sin(2*q4)*sin(2*q6))/4 - qd4*qd6*sin(2*q4) - (qd4^2*cos(2*q4)*sin(2*q6))/2 - (qd6^2*cos(2*q4)*sin(2*q6))/2 - qd4*qd6*cos(2*q6)*sin(2*q4),    sin(q6) - (qdd4*cos(q6)*sin(q5))/200 + (qdd5*sin(q5)*sin(q6))/100 + (qd5^2*cos(q5)*sin(q6))/50 + (qd4^2*sin(2*q4)*cos(q6)*sin(q5))/100 + (qd5^2*sin(2*q4)*cos(q6)*sin(q5))/100 - qdd3*cos(q1)*cos(q2)*sin(q6) + (qdd1*cos(q2)*sin(q1)*sin(q6))/100 + (qdd2*cos(q1)*sin(q2)*sin(q6))/100 - (qdd4*cos(2*q4)*cos(q6)*sin(q5))/200 - (qdd5*sin(2*q4)*cos(q5)*cos(q6))/200 + (qd1^2*cos(q1)*cos(q2)*sin(q6))/50 + (qd2^2*cos(q1)*cos(q2)*sin(q6))/50 - (qd4*qd5*cos(q5)*cos(q6))/50 - (qd4*qd5*cos(2*q4)*cos(q5)*cos(q6))/50 - (qdd1*cos(q1)*cos(q2)*cos(q4)*cos(q6))/100 + 2*q3*qd1^2*cos(q1)*cos(q2)*sin(q6) + 2*q3*qd2^2*cos(q1)*cos(q2)*sin(q6) - qdd3*cos(q2)*cos(q4)*cos(q6)*sin(q1) + (qdd2*cos(q4)*cos(q6)*sin(q1)*sin(q2))/100 + (qd1^2*cos(q2)*cos(q4)*cos(q6)*sin(q1))/50 + (qd2^2*cos(q2)*cos(q4)*cos(q6)*sin(q1))/50 + q3*qdd1*cos(q2)*sin(q1)*sin(q6) + q3*qdd2*cos(q1)*sin(q2)*sin(q6) + 4*qd1*qd3*cos(q2)*sin(q1)*sin(q6) + 4*qd2*qd3*cos(q1)*sin(q2)*sin(q6) - (qd1*qd2*sin(q1)*sin(q2)*sin(q6))/25 + 2*q3*qd1^2*cos(q2)*cos(q4)*cos(q6)*sin(q1) + 2*q3*qd2^2*cos(q2)*cos(q4)*cos(q6)*sin(q1) - 4*q3*qd1*qd2*sin(q1)*sin(q2)*sin(q6) - q3*qdd1*cos(q1)*cos(q2)*cos(q4)*cos(q6) - 4*qd1*qd3*cos(q1)*cos(q2)*cos(q4)*cos(q6) + (qd1*qd2*cos(q1)*cos(q4)*cos(q6)*sin(q2))/25 + q3*qdd2*cos(q4)*cos(q6)*sin(q1)*sin(q2) + 4*qd2*qd3*cos(q4)*cos(q6)*sin(q1)*sin(q2) + 4*q3*qd1*qd2*cos(q1)*cos(q4)*cos(q6)*sin(q2),                                                                                    0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                0,                                                                                            0];
 

end

cond_w=cond(W);

if cond_w<cond_save
    cond_save=cond_w
    x_save=x;
    v_save=v;

end 
end 

disp("Perfecto!")
