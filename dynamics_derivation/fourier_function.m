function [val]=fourier_function(z,four)

%tic

n = 2*four.N+1;

for j = 1:four.dof
for t=1:n
temp1 = sprintf('z(%d)',(j-1)*n+t);
temp2 = sprintf('v(%d,%d)',[j, t]);
eval(strcat(temp2,'=',temp1,';'));


end
end
%toc
% disc_num = four.tf/four.ts;
% time = linspace(0,four.tf-four.ts,disc_num);



F=zeros(four.dof*four.disc_num,four.size);

for k = 1:four.disc_num 
qi   =  zeros(four.dof,1);
qdi  =  zeros(four.dof,1);
qddi =  zeros(four.dof,1);

for j = 1:four.dof
qi(j) = v(j,n);

for i =1:four.N
    t = four.time(k);
    qi(j) = qi(j)+v(j,i)/(four.w*i)*sin(four.w*i*t)-v(j,four.N+i)/(four.w*i)*cos(four.w*i*t);
    qdi(j) = qdi(j)+v(j,i)*cos(four.w*i*t)+v(j,four.N+i)*sin(four.w*i*t);
    qddi(j) = qddi(j)-v(j,i)*(four.w*i)*sin(four.w*i*t)+v(j,four.N+i)*(four.w*i)*cos(four.w*i*t);    
end
end

%F((k-1)*four.dof+1:(k-1)*four.dof+four.dof,:) = four.fun(qi(1),qi(2),qi(3),qdi(1),qdi(2),qdi(3),qddi(1),qddi(2),qddi(3)).*(1./four.scale_noise.');


q1 = qi(1);
q2 = qi(2);
q3 = qi(3);

qd1 = qdi(1);
qd2 = qdi(2);
qd3 = qdi(3);

qdd1 = qddi(1);
qdd2 = qddi(2);
qdd3 = qddi(3);

%July_svd
F((k-1)*four.dof+1,:)=[ (10735061*qdd1)/200000000 + (2107*cos(q1 - q2))/10000 - (141169*sin(q1 - q2))/100000 - (147*sin(q1 + q2 - 5239260779425957/18014398509481984))/200 - (147*sin(q1 - q2 + 5239260779425957/18014398509481984))/200 - (2107*cos(q1 + q2))/10000 - (141169*sin(q1 + q2))/100000 + (8115261*qdd1*cos(2*q2))/200000000 - (123883*qdd1*sin(2*q2))/10000000 - (2881*q3*qdd1)/10000 - (2881*qd1*qd3)/5000 + (49*q3*sin(q1 + q2))/10 + (q3^2*qdd1)/2 + (8643*qdd1*cos(5239260779425957/18014398509481984))/200000 - (129*qdd1*sin(5239260779425957/18014398509481984))/20000 + (9*qdd1*cos(2*q2 - 5239260779425957/9007199254740992))/800 + (8643*qdd1*cos(2*q2 - 5239260779425957/18014398509481984))/200000 + (49*q3*sin(q1 - q2))/10 - (129*qdd1*sin(2*q2 - 5239260779425957/18014398509481984))/20000 - (3*q3*qdd1*cos(5239260779425957/18014398509481984))/20 - (3*qd1*qd3*cos(5239260779425957/18014398509481984))/10 - (3*q3*qdd1*cos(2*q2 - 5239260779425957/18014398509481984))/20 - (129*qd1*qd2*cos(2*q2 - 5239260779425957/18014398509481984))/5000 - (3*qd1*qd3*cos(2*q2 - 5239260779425957/18014398509481984))/10 - (9*qd1*qd2*sin(2*q2 - 5239260779425957/9007199254740992))/200 - (8643*qd1*qd2*sin(2*q2 - 5239260779425957/18014398509481984))/50000 - (2881*q3*qdd1*cos(2*q2))/10000 - (123883*qd1*qd2*cos(2*q2))/2500000 - (2881*qd1*qd3*cos(2*q2))/5000 + (43*q3*qdd1*sin(2*q2))/1000 - (8115261*qd1*qd2*sin(2*q2))/50000000 + (43*qd1*qd3*sin(2*q2))/500 + 2*q3*qd1*qd3 + (q3^2*qdd1*cos(2*q2))/2 - 2*q3^2*qd1*qd2*sin(2*q2) + (3*q3*qd1*qd2*sin(2*q2 - 5239260779425957/18014398509481984))/5 + (43*q3*qd1*qd2*cos(2*q2))/250 + 2*q3*qd1*qd3*cos(2*q2) + (2881*q3*qd1*qd2*sin(2*q2))/2500, (9*qdd1)/800 - (147*sin(q1 + q2 - 5239260779425957/18014398509481984))/200 - (147*sin(q1 - q2 + 5239260779425957/18014398509481984))/200 - (11809*q3*sin(q1 + q2))/4000 + (58081*q3^2*qdd1)/320000 + (9*qdd1*cos(2*q2 - 5239260779425957/9007199254740992))/800 - (11809*q3*sin(q1 - q2))/4000 + (723*q3*qdd1*cos(5239260779425957/18014398509481984))/8000 + (723*qd1*qd3*cos(5239260779425957/18014398509481984))/4000 + (723*q3*qdd1*cos(2*q2 - 5239260779425957/18014398509481984))/8000 + (723*qd1*qd3*cos(2*q2 - 5239260779425957/18014398509481984))/4000 - (9*qd1*qd2*sin(2*q2 - 5239260779425957/9007199254740992))/200 + (58081*q3*qd1*qd3)/80000 + (58081*q3^2*qdd1*cos(2*q2))/320000 - (58081*q3^2*qd1*qd2*sin(2*q2))/80000 - (723*q3*qd1*qd2*sin(2*q2 - 5239260779425957/18014398509481984))/2000 + (58081*q3*qd1*qd3*cos(2*q2))/80000, (49*sin(q1))/5,   0, -q1,    0,    0, -qd1, 0,                                                0,                                           0,          0, -sign(qd1), (241*q3*qdd1)/400 - (49*sin(q1 + q2))/10 - (49*sin(q1 - q2))/10 + (241*qd1*qd3)/200 + (3*qdd1*cos(5239260779425957/18014398509481984))/20 + (3*qdd1*cos(2*q2 - 5239260779425957/18014398509481984))/20 - (3*qd1*qd2*sin(2*q2 - 5239260779425957/18014398509481984))/5 + (241*q3*qdd1*cos(2*q2))/400 + (241*qd1*qd3*cos(2*q2))/200 - (241*q3*qd1*qd2*sin(2*q2))/100, qdd1/2 + (qdd1*cos(2*q2))/2 - 2*qd1*qd2*sin(2*q2), - 2*sin(q2)*qd2^2 + qdd2*cos(q2), (49*cos(q1 + q2))/10 - (49*cos(q1 - q2))/10 - (43*qdd1)/1000 + (43*qdd1*cos(2*q2))/1000 + (2881*qdd1*sin(2*q2))/10000 + (3*qdd1*sin(5239260779425957/18014398509481984))/20 + (3*qdd1*sin(2*q2 - 5239260779425957/18014398509481984))/20 + (3*qd1*qd2*cos(2*q2 - 5239260779425957/18014398509481984))/5 + (2881*qd1*qd2*cos(2*q2))/2500 - q3*qdd1*sin(2*q2) - (43*qd1*qd2*sin(2*q2))/250 - 2*qd1*qd3*sin(2*q2) - 4*q3*qd1*qd2*cos(2*q2),   (49*cos(q1 - q2))/10 - (49*cos(q1 + q2))/10, -(49*cos(q1))/5, (3*qdd1*cos(q2 - 5239260779425957/9007199254740992))/20 - (49*sin(q1 + 5239260779425957/18014398509481984))/10 - (49*sin(q1 - 5239260779425957/18014398509481984))/10 + (3*qdd1*cos(q2))/20 - (3*qd1*qd2*sin(q2))/10 - (3*qd1*qd2*sin(q2 - 5239260779425957/9007199254740992))/10,    0, (9*qdd1)/800 - (147*sin(q1 + q2 - 5239260779425957/18014398509481984))/200 - (147*sin(q1 - q2 + 5239260779425957/18014398509481984))/200 + (9*qdd1*cos(2*q2 - 5239260779425957/9007199254740992))/800 - (9*qd1*qd2*sin(2*q2 - 5239260779425957/9007199254740992))/200, qdd1/2 - (qdd1*cos(2*q2))/2 + 2*qd1*qd2*sin(2*q2), - 2*cos(q2)*qd2^2 - qdd2*sin(q2), -qdd2, qdd1/2 - (qdd1*cos(2*q2 - 5239260779425957/9007199254740992))/2 + 2*qd1*qd2*sin(2*q2 - 5239260779425957/9007199254740992), (2881*qd2^2*cos(q2))/5000 - (49*cos(q1))/5 - (43*qd2^2*sin(q2))/500 + (3*qdd2*sin(q2 - 5239260779425957/18014398509481984))/20 + (43*qdd2*cos(q2))/1000 + qdd3*cos(q2) + (2881*qdd2*sin(q2))/10000 + (3*qd2^2*cos(q2 - 5239260779425957/18014398509481984))/10 - q3*qdd2*sin(q2) - 4*qd2*qd3*sin(q2) - 2*q3*qd2^2*cos(q2)];
F((k-1)*four.dof+2,:)=[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          (10735061*qdd2)/100000000 + (43*qdd3)/1000 - (2107*cos(q1 - q2))/10000 + (141169*sin(q1 - q2))/100000 - (147*sin(q1 + q2 - 5239260779425957/18014398509481984))/200 + (147*sin(q1 - q2 + 5239260779425957/18014398509481984))/200 - (2107*cos(q1 + q2))/10000 - (141169*sin(q1 + q2))/100000 + (129*qd1^2*cos(2*q2 - 5239260779425957/18014398509481984))/10000 - (2881*q3*qdd2)/5000 - (2881*qd2*qd3)/2500 + (9*qd1^2*sin(2*q2 - 5239260779425957/9007199254740992))/400 + (8643*qd1^2*sin(2*q2 - 5239260779425957/18014398509481984))/100000 + (123883*qd1^2*cos(2*q2))/5000000 + (8115261*qd1^2*sin(2*q2))/100000000 + (49*q3*sin(q1 + q2))/10 + q3^2*qdd2 + (8643*qdd2*cos(5239260779425957/18014398509481984))/100000 - (129*qdd2*sin(5239260779425957/18014398509481984))/10000 - (3*qdd3*sin(5239260779425957/18014398509481984))/20 - (49*q3*sin(q1 - q2))/10 - (3*q3*qdd2*cos(5239260779425957/18014398509481984))/10 - (3*qd2*qd3*cos(5239260779425957/18014398509481984))/5 + q3^2*qd1^2*sin(2*q2) + 4*q3*qd2*qd3 - (3*q3*qd1^2*sin(2*q2 - 5239260779425957/18014398509481984))/10 - (43*q3*qd1^2*cos(2*q2))/500 - (2881*q3*qd1^2*sin(2*q2))/5000,                                                                                                                                                                                                                           (9*qdd2)/400 - (147*sin(q1 + q2 - 5239260779425957/18014398509481984))/200 + (147*sin(q1 - q2 + 5239260779425957/18014398509481984))/200 + (9*qd1^2*sin(2*q2 - 5239260779425957/9007199254740992))/400 - (11809*q3*sin(q1 + q2))/4000 + (58081*q3^2*qdd2)/160000 + (723*qdd3*sin(5239260779425957/18014398509481984))/8000 + (11809*q3*sin(q1 - q2))/4000 + (723*q3*qdd2*cos(5239260779425957/18014398509481984))/4000 + (723*qd2*qd3*cos(5239260779425957/18014398509481984))/2000 + (58081*q3^2*qd1^2*sin(2*q2))/160000 + (58081*q3*qd2*qd3)/40000 + (723*q3*qd1^2*sin(2*q2 - 5239260779425957/18014398509481984))/4000,              0, -q2,   0,    0, -qd2,    0, 0,                                                0,                                           0, -sign(qd2),          0,                                                                                                                             (49*sin(q1 - q2))/10 - (49*sin(q1 + q2))/10 + (241*q3*qdd2)/200 + (241*qd2*qd3)/100 + (3*qd1^2*sin(2*q2 - 5239260779425957/18014398509481984))/10 + (3*qdd2*cos(5239260779425957/18014398509481984))/10 + (241*q3*qd1^2*sin(2*q2))/200,                            sin(2*q2)*qd1^2 + qdd2,                     qdd1*cos(q2),                                                                                                                                                                  (49*cos(q1 - q2))/10 - qdd3 - (43*qdd2)/500 + (49*cos(q1 + q2))/10 - (3*qd1^2*cos(2*q2 - 5239260779425957/18014398509481984))/10 - (2881*qd1^2*cos(2*q2))/5000 + (43*qd1^2*sin(2*q2))/500 + (3*qdd2*sin(5239260779425957/18014398509481984))/10 + 2*q3*qd1^2*cos(2*q2), - (49*cos(q1 - q2))/10 - (49*cos(q1 + q2))/10,               0,                                                                                                                                                                                                   (3*qd1^2*sin(q2))/20 + (3*qd1^2*sin(q2 - 5239260779425957/9007199254740992))/20, qdd2,                                                                (9*sin(2*q2 - 5239260779425957/9007199254740992)*qd1^2)/400 + (9*qdd2)/400 - (147*sin(q1 + q2 - 5239260779425957/18014398509481984))/200 + (147*sin(q1 - q2 + 5239260779425957/18014398509481984))/200,                          - sin(2*q2)*qd1^2 + qdd2,                    -qdd1*sin(q2), -qdd1,                                                                      -qd1^2*sin(2*q2 - 5239260779425957/9007199254740992),                                                                                                                                                                                           (3*qdd1*sin(q2 - 5239260779425957/18014398509481984))/20 + (43*qdd1*cos(q2))/1000 + (2881*qdd1*sin(q2))/10000 - q3*qdd1*sin(q2)];
F((k-1)*four.dof+3,:)=[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 (43*qdd2)/1000 + qdd3 - (49*cos(q1)*cos(q2))/5 + (3*qd2^2*cos(5239260779425957/18014398509481984))/10 + (2881*qd1^2*cos(q2)^2)/5000 - (43*qd1^2*sin(2*q2))/1000 - 2*q3*qd2^2 - (3*qdd2*sin(5239260779425957/18014398509481984))/20 + (2881*qd2^2)/5000 + (3*qd1^2*cos(q2)^2*cos(5239260779425957/18014398509481984))/10 - 2*q3*qd1^2*cos(q2)^2 + (3*qd1^2*cos(q2)*sin(q2)*sin(5239260779425957/18014398509481984))/10,                                                                                                                                                                                                                                                                                                                                                                                                                                                                 (58081*qdd3)/160000 + (11809*cos(q1)*cos(q2))/2000 - (723*qd2^2*cos(5239260779425957/18014398509481984))/4000 - (58081*q3*qd2^2)/80000 + (723*qdd2*sin(5239260779425957/18014398509481984))/8000 - (723*qd1^2*cos(q2)^2*cos(5239260779425957/18014398509481984))/4000 - (58081*q3*qd1^2*cos(q2)^2)/80000 - (723*qd1^2*cos(q2)*sin(q2)*sin(5239260779425957/18014398509481984))/4000,              0,   0,   0, -qd3,    0,    0, 1, sign(qd3)*(exp(-((2000*abs(qd3))/11)^(3/5)) - 1), -exp(-((2000*abs(qd3))/11)^(3/5))*sign(qd3),          0,          0,                                                                                                                                                                                                                                                                                                                      - (241*qd1^2*cos(q2)^2)/200 - (241*qd2^2)/200,                                                 0,                                0,                                                                                                                                                                                                                                                                                                                                                                                                                  sin(2*q2)*qd1^2 - qdd2,                                             0,               0,                                                                                                                                                                                                                                                                                 0,    0,                                                                                                                                                                                                                                                                     0,                                                 0,                                0,     0,                                                                                                                         0,                                                                                                                                                                                                                                                                                                              qdd1*cos(q2)];
 

%Friction
% F((k-1)*four.dof+1,:)=[ (10735061*qdd1)/200000000 + (2107*cos(q1 - q2))/10000 - (141169*sin(q1 - q2))/100000 - (147*sin(q1 + q2 - 5239260779425957/18014398509481984))/200 - (147*sin(q1 - q2 + 5239260779425957/18014398509481984))/200 - (2107*cos(q1 + q2))/10000 - (141169*sin(q1 + q2))/100000 + (8115261*qdd1*cos(2*q2))/200000000 - (123883*qdd1*sin(2*q2))/10000000 - (2881*q3*qdd1)/10000 - (2881*qd1*qd3)/5000 + (49*q3*sin(q1 + q2))/10 + (q3^2*qdd1)/2 + (8643*qdd1*cos(5239260779425957/18014398509481984))/200000 - (129*qdd1*sin(5239260779425957/18014398509481984))/20000 + (9*qdd1*cos(2*q2 - 5239260779425957/9007199254740992))/800 + (8643*qdd1*cos(2*q2 - 5239260779425957/18014398509481984))/200000 + (49*q3*sin(q1 - q2))/10 - (129*qdd1*sin(2*q2 - 5239260779425957/18014398509481984))/20000 - (3*q3*qdd1*cos(5239260779425957/18014398509481984))/20 - (3*qd1*qd3*cos(5239260779425957/18014398509481984))/10 - (3*q3*qdd1*cos(2*q2 - 5239260779425957/18014398509481984))/20 - (129*qd1*qd2*cos(2*q2 - 5239260779425957/18014398509481984))/5000 - (3*qd1*qd3*cos(2*q2 - 5239260779425957/18014398509481984))/10 - (9*qd1*qd2*sin(2*q2 - 5239260779425957/9007199254740992))/200 - (8643*qd1*qd2*sin(2*q2 - 5239260779425957/18014398509481984))/50000 - (2881*q3*qdd1*cos(2*q2))/10000 - (123883*qd1*qd2*cos(2*q2))/2500000 - (2881*qd1*qd3*cos(2*q2))/5000 + (43*q3*qdd1*sin(2*q2))/1000 - (8115261*qd1*qd2*sin(2*q2))/50000000 + (43*qd1*qd3*sin(2*q2))/500 + 2*q3*qd1*qd3 + (q3^2*qdd1*cos(2*q2))/2 - 2*q3^2*qd1*qd2*sin(2*q2) + (3*q3*qd1*qd2*sin(2*q2 - 5239260779425957/18014398509481984))/5 + (43*q3*qd1*qd2*cos(2*q2))/250 + 2*q3*qd1*qd3*cos(2*q2) + (2881*q3*qd1*qd2*sin(2*q2))/2500, (58081*q3^2*qdd1)/320000 - (11809*q3*sin(q1 - q2 + 5239260779425957/18014398509481984))/4000 - (11809*q3*sin(q1 + q2 - 5239260779425957/18014398509481984))/4000 + (58081*q3^2*qdd1*cos(2*q2 - 5239260779425957/9007199254740992))/320000 + (58081*q3*qd1*qd3)/80000 - (58081*q3^2*qd1*qd2*sin(2*q2 - 5239260779425957/9007199254740992))/80000 + (58081*q3*qd1*qd3*cos(2*q2 - 5239260779425957/9007199254740992))/80000, (49*sin(q1 - q2))/10 - (2881*qdd1)/10000 + (49*sin(q1 + q2))/10 - (2881*qdd1*cos(2*q2))/10000 + (43*qdd1*sin(2*q2))/1000 + q3*qdd1 + 2*qd1*qd3 - (3*qdd1*cos(5239260779425957/18014398509481984))/20 - (3*qdd1*cos(2*q2 - 5239260779425957/18014398509481984))/20 + (3*qd1*qd2*sin(2*q2 - 5239260779425957/18014398509481984))/5 + q3*qdd1*cos(2*q2) + (43*qd1*qd2*cos(2*q2))/250 + 2*qd1*qd3*cos(2*q2) + (2881*qd1*qd2*sin(2*q2))/2500 - 4*q3*qd1*qd2*sin(2*q2), (2881*qd2^2*cos(q2))/5000 - (49*cos(q1))/5 - (43*qd2^2*sin(q2))/500 + (3*qdd2*sin(q2 - 5239260779425957/18014398509481984))/20 + (43*qdd2*cos(q2))/1000 + qdd3*cos(q2) + (2881*qdd2*sin(q2))/10000 + (3*qd2^2*cos(q2 - 5239260779425957/18014398509481984))/10 - q3*qdd2*sin(q2) - 4*qd2*qd3*sin(q2) - 2*q3*qd2^2*cos(q2), (49*cos(q1 + q2))/10 - (49*cos(q1 - q2))/10 - (43*qdd1)/1000 + (43*qdd1*cos(2*q2))/1000 + (2881*qdd1*sin(2*q2))/10000 + (3*qdd1*sin(5239260779425957/18014398509481984))/20 + (3*qdd1*sin(2*q2 - 5239260779425957/18014398509481984))/20 + (3*qd1*qd2*cos(2*q2 - 5239260779425957/18014398509481984))/5 + (2881*qd1*qd2*cos(2*q2))/2500 - q3*qdd1*sin(2*q2) - (43*qd1*qd2*sin(2*q2))/250 - 2*qd1*qd3*sin(2*q2) - 4*q3*qd1*qd2*cos(2*q2), (49*sin(q1))/5, (241*q3*qdd1)/400 - (49*sin(q1 - q2 + 5239260779425957/18014398509481984))/10 - (49*sin(q1 + q2 - 5239260779425957/18014398509481984))/10 + (241*qd1*qd3)/200 + (241*q3*qdd1*cos(2*q2 - 5239260779425957/9007199254740992))/400 + (241*qd1*qd3*cos(2*q2 - 5239260779425957/9007199254740992))/200 - (241*q3*qd1*qd2*sin(2*q2 - 5239260779425957/9007199254740992))/100, (49*cos(q1))/5 + (241*qdd3*cos(q2 - 5239260779425957/18014398509481984))/400 - (241*q3*qd2^2*cos(q2 - 5239260779425957/18014398509481984))/200 - (241*q3*qdd2*sin(q2 - 5239260779425957/18014398509481984))/400 - (241*qd2*qd3*sin(q2 - 5239260779425957/18014398509481984))/100, (49*cos(q1 + q2 - 5239260779425957/18014398509481984))/10 - (49*cos(q1 - q2 + 5239260779425957/18014398509481984))/10 + (241*q3*qdd1*sin(2*q2 - 5239260779425957/9007199254740992))/400 + (241*qd1*qd3*sin(2*q2 - 5239260779425957/9007199254740992))/200 + (241*q3*qd1*qd2*cos(2*q2 - 5239260779425957/9007199254740992))/100,   0, -q1,    0,    0, -qd1, 0,                                                0,                                           0,          0, -sign(qd1), -(49*cos(q1))/5, 2*cos(q2 - 5239260779425957/18014398509481984)*qd2^2 + qdd2*sin(q2 - 5239260779425957/18014398509481984), - 2*cos(q2)*qd2^2 - qdd2*sin(q2),   (49*cos(q1 - q2))/10 - (49*cos(q1 + q2))/10, (49*cos(q1 + 5239260779425957/18014398509481984))/10 - (49*cos(q1 - 5239260779425957/18014398509481984))/10 - (3*qdd1*sin(q2 - 5239260779425957/9007199254740992))/20 + (3*qdd1*sin(q2))/20 + (3*qd1*qd2*cos(q2))/10 - (3*qd1*qd2*cos(q2 - 5239260779425957/9007199254740992))/10, qdd1/2 - (qdd1*cos(2*q2))/2 + 2*qd1*qd2*sin(2*q2), qdd1*sin(2*q2 - 5239260779425957/9007199254740992) + 4*qd1*qd2*cos(2*q2 - 5239260779425957/9007199254740992), qdd1/2 + (qdd1*cos(2*q2 - 5239260779425957/9007199254740992))/2 - 2*qd1*qd2*sin(2*q2 - 5239260779425957/9007199254740992), (49*sin(q1 - q2))/10 + (49*sin(q1 + q2))/10 - (3*qdd1*cos(5239260779425957/18014398509481984))/20 - (3*qdd1*cos(2*q2 - 5239260779425957/18014398509481984))/20 + (3*qd1*qd2*sin(2*q2 - 5239260779425957/18014398509481984))/5,    0, -qdd2];
% F((k-1)*four.dof+2,:)=[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          (10735061*qdd2)/100000000 + (43*qdd3)/1000 - (2107*cos(q1 - q2))/10000 + (141169*sin(q1 - q2))/100000 - (147*sin(q1 + q2 - 5239260779425957/18014398509481984))/200 + (147*sin(q1 - q2 + 5239260779425957/18014398509481984))/200 - (2107*cos(q1 + q2))/10000 - (141169*sin(q1 + q2))/100000 + (129*qd1^2*cos(2*q2 - 5239260779425957/18014398509481984))/10000 - (2881*q3*qdd2)/5000 - (2881*qd2*qd3)/2500 + (9*qd1^2*sin(2*q2 - 5239260779425957/9007199254740992))/400 + (8643*qd1^2*sin(2*q2 - 5239260779425957/18014398509481984))/100000 + (123883*qd1^2*cos(2*q2))/5000000 + (8115261*qd1^2*sin(2*q2))/100000000 + (49*q3*sin(q1 + q2))/10 + q3^2*qdd2 + (8643*qdd2*cos(5239260779425957/18014398509481984))/100000 - (129*qdd2*sin(5239260779425957/18014398509481984))/10000 - (3*qdd3*sin(5239260779425957/18014398509481984))/20 - (49*q3*sin(q1 - q2))/10 - (3*q3*qdd2*cos(5239260779425957/18014398509481984))/10 - (3*qd2*qd3*cos(5239260779425957/18014398509481984))/5 + q3^2*qd1^2*sin(2*q2) + 4*q3*qd2*qd3 - (3*q3*qd1^2*sin(2*q2 - 5239260779425957/18014398509481984))/10 - (43*q3*qd1^2*cos(2*q2))/500 - (2881*q3*qd1^2*sin(2*q2))/5000,                                                                                                                                                    (11809*q3*sin(q1 - q2 + 5239260779425957/18014398509481984))/4000 + (58081*q3^2*qdd2)/160000 - (11809*q3*sin(q1 + q2 - 5239260779425957/18014398509481984))/4000 + (58081*q3^2*qd1^2*sin(2*q2 - 5239260779425957/9007199254740992))/160000 + (58081*q3*qd2*qd3)/40000,                                                                                                                                                                       (49*sin(q1 + q2))/10 - (49*sin(q1 - q2))/10 - (2881*qdd2)/5000 + 2*q3*qdd2 + 4*qd2*qd3 - (3*qd1^2*sin(2*q2 - 5239260779425957/18014398509481984))/10 - (43*qd1^2*cos(2*q2))/500 - (2881*qd1^2*sin(2*q2))/5000 - (3*qdd2*cos(5239260779425957/18014398509481984))/10 + 2*q3*qd1^2*sin(2*q2),                                                                                                                                                                                           (3*qdd1*sin(q2 - 5239260779425957/18014398509481984))/20 + (43*qdd1*cos(q2))/1000 + (2881*qdd1*sin(q2))/10000 - q3*qdd1*sin(q2),                                                                                                                                                                  (49*cos(q1 - q2))/10 - qdd3 - (43*qdd2)/500 + (49*cos(q1 + q2))/10 - (3*qd1^2*cos(2*q2 - 5239260779425957/18014398509481984))/10 - (2881*qd1^2*cos(2*q2))/5000 + (43*qd1^2*sin(2*q2))/500 + (3*qdd2*sin(5239260779425957/18014398509481984))/10 + 2*q3*qd1^2*cos(2*q2),              0,                                                                                                                                       (241*q3*sin(2*q2 - 5239260779425957/9007199254740992)*qd1^2)/200 - (49*sin(q1 + q2 - 5239260779425957/18014398509481984))/10 + (49*sin(q1 - q2 + 5239260779425957/18014398509481984))/10 + (241*q3*qdd2)/200 + (241*qd2*qd3)/100,                                                                                                                                                                                                                  -(241*q3*qdd1*sin(q2 - 5239260779425957/18014398509481984))/400,                                                                                                                      (241*qdd3)/400 + (49*cos(q1 + q2 - 5239260779425957/18014398509481984))/10 + (49*cos(q1 - q2 + 5239260779425957/18014398509481984))/10 - (241*q3*qd1^2*cos(2*q2 - 5239260779425957/9007199254740992))/200, -q2,   0,    0, -qd2,    0, 0,                                                0,                                           0, -sign(qd2),          0,               0,                                                        qdd1*sin(q2 - 5239260779425957/18014398509481984),                    -qdd1*sin(q2), - (49*cos(q1 - q2))/10 - (49*cos(q1 + q2))/10,                                                                                                                                                                                                   (3*qd1^2*cos(q2 - 5239260779425957/9007199254740992))/20 - (3*qd1^2*cos(q2))/20,                          - sin(2*q2)*qd1^2 + qdd2,                                                       -2*qd1^2*cos(2*q2 - 5239260779425957/9007199254740992),                                                                sin(2*q2 - 5239260779425957/9007199254740992)*qd1^2 + qdd2,                                                               (49*sin(q1 + q2))/10 - (49*sin(q1 - q2))/10 - (3*qd1^2*sin(2*q2 - 5239260779425957/18014398509481984))/10 - (3*qdd2*cos(5239260779425957/18014398509481984))/10, qdd2, -qdd1];
% F((k-1)*four.dof+3,:)=[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                (43*qdd2)/1000 + qdd3 - (49*cos(q1 - q2))/10 - (49*cos(q1 + q2))/10 + (3*qd1^2*cos(5239260779425957/18014398509481984))/20 + (3*qd2^2*cos(5239260779425957/18014398509481984))/10 + (3*qd1^2*cos(2*q2 - 5239260779425957/18014398509481984))/20 + (2881*qd1^2*cos(2*q2))/10000 - (43*qd1^2*sin(2*q2))/1000 - q3*qd1^2 - 2*q3*qd2^2 - (3*qdd2*sin(5239260779425957/18014398509481984))/20 + (2881*qd1^2)/10000 + (2881*qd2^2)/5000 - q3*qd1^2*cos(2*q2),                                                                                                                                         (58081*qdd3)/160000 + (11809*cos(q1 + q2 - 5239260779425957/18014398509481984))/4000 + (11809*cos(q1 - q2 + 5239260779425957/18014398509481984))/4000 - (58081*q3*qd1^2)/160000 - (58081*q3*qd2^2)/80000 - (58081*q3*qd1^2*cos(2*q2 - 5239260779425957/9007199254740992))/160000,                                                                                                                                                                                                                                                                                                                                                                                                                              - qd1^2*cos(2*q2) - qd1^2 - 2*qd2^2,                                                                                                                                                                                                                                                                                                              qdd1*cos(q2),                                                                                                                                                                                                                                                                                                                                                                                                                  sin(2*q2)*qd1^2 - qdd2,              0,                                                                                                                                                                                                                                                                    - (241*qd1^2*cos(2*q2 - 5239260779425957/9007199254740992))/400 - (241*qd1^2)/400 - (241*qd2^2)/200,                                                                                                                                                                                                                      (241*qdd1*cos(q2 - 5239260779425957/18014398509481984))/400,                                                                                                                                                                                                                                                 (241*qdd2)/400 - (241*qd1^2*sin(2*q2 - 5239260779425957/9007199254740992))/400,   0,   0, -qd3,    0,    0, 1, sign(qd3)*(exp(-((2000*abs(qd3))/11)^(3/5)) - 1), -exp(-((2000*abs(qd3))/11)^(3/5))*sign(qd3),          0,          0,               0,                                                                                                        0,                                0,                                             0,                                                                                                                                                                                                                                                                                 0,                                                 0,                                                                                                            0,                                                                                                                         0,                                                                                                                                                                                                                             0,    0,     0];
%  
%Newer test_3dof_svd
% F((k-1)*four.dof+1,:)=[ (10735061*qdd1)/200000000 + (2107*cos(q1 - q2))/10000 - (141169*sin(q1 - q2))/100000 - (147*sin(q1 + q2 - 5239260779425957/18014398509481984))/200 - (147*sin(q1 - q2 + 5239260779425957/18014398509481984))/200 - (2107*cos(q1 + q2))/10000 - (141169*sin(q1 + q2))/100000 + (8115261*qdd1*cos(2*q2))/200000000 - (123883*qdd1*sin(2*q2))/10000000 - (2881*q3*qdd1)/10000 - (2881*qd1*qd3)/5000 + (49*q3*sin(q1 + q2))/10 + (q3^2*qdd1)/2 + (8643*qdd1*cos(5239260779425957/18014398509481984))/200000 - (129*qdd1*sin(5239260779425957/18014398509481984))/20000 + (9*qdd1*cos(2*q2 - 5239260779425957/9007199254740992))/800 + (8643*qdd1*cos(2*q2 - 5239260779425957/18014398509481984))/200000 + (49*q3*sin(q1 - q2))/10 - (129*qdd1*sin(2*q2 - 5239260779425957/18014398509481984))/20000 - (3*q3*qdd1*cos(5239260779425957/18014398509481984))/20 - (3*qd1*qd3*cos(5239260779425957/18014398509481984))/10 - (3*q3*qdd1*cos(2*q2 - 5239260779425957/18014398509481984))/20 - (129*qd1*qd2*cos(2*q2 - 5239260779425957/18014398509481984))/5000 - (3*qd1*qd3*cos(2*q2 - 5239260779425957/18014398509481984))/10 - (9*qd1*qd2*sin(2*q2 - 5239260779425957/9007199254740992))/200 - (8643*qd1*qd2*sin(2*q2 - 5239260779425957/18014398509481984))/50000 - (2881*q3*qdd1*cos(2*q2))/10000 - (123883*qd1*qd2*cos(2*q2))/2500000 - (2881*qd1*qd3*cos(2*q2))/5000 + (43*q3*qdd1*sin(2*q2))/1000 - (8115261*qd1*qd2*sin(2*q2))/50000000 + (43*qd1*qd3*sin(2*q2))/500 + 2*q3*qd1*qd3 + (q3^2*qdd1*cos(2*q2))/2 - 2*q3^2*qd1*qd2*sin(2*q2) + (3*q3*qd1*qd2*sin(2*q2 - 5239260779425957/18014398509481984))/5 + (43*q3*qd1*qd2*cos(2*q2))/250 + 2*q3*qd1*qd3*cos(2*q2) + (2881*q3*qd1*qd2*sin(2*q2))/2500, (58081*q3^2*qdd1)/320000 - (11809*q3*sin(q1 - q2 + 5239260779425957/18014398509481984))/4000 - (11809*q3*sin(q1 + q2 - 5239260779425957/18014398509481984))/4000 + (58081*q3^2*qdd1*cos(2*q2 - 5239260779425957/9007199254740992))/320000 + (58081*q3*qd1*qd3)/80000 - (58081*q3^2*qd1*qd2*sin(2*q2 - 5239260779425957/9007199254740992))/80000 + (58081*q3*qd1*qd3*cos(2*q2 - 5239260779425957/9007199254740992))/80000, (49*sin(q1 - q2))/10 - (2881*qdd1)/10000 + (49*sin(q1 + q2))/10 - (2881*qdd1*cos(2*q2))/10000 + (43*qdd1*sin(2*q2))/1000 + q3*qdd1 + 2*qd1*qd3 - (3*qdd1*cos(5239260779425957/18014398509481984))/20 - (3*qdd1*cos(2*q2 - 5239260779425957/18014398509481984))/20 + (3*qd1*qd2*sin(2*q2 - 5239260779425957/18014398509481984))/5 + q3*qdd1*cos(2*q2) + (43*qd1*qd2*cos(2*q2))/250 + 2*qd1*qd3*cos(2*q2) + (2881*qd1*qd2*sin(2*q2))/2500 - 4*q3*qd1*qd2*sin(2*q2), (2881*qd2^2*cos(q2))/5000 - (49*cos(q1))/5 - (43*qd2^2*sin(q2))/500 + (3*qdd2*sin(q2 - 5239260779425957/18014398509481984))/20 + (43*qdd2*cos(q2))/1000 + qdd3*cos(q2) + (2881*qdd2*sin(q2))/10000 + (3*qd2^2*cos(q2 - 5239260779425957/18014398509481984))/10 - q3*qdd2*sin(q2) - 4*qd2*qd3*sin(q2) - 2*q3*qd2^2*cos(q2), (49*cos(q1 + q2))/10 - (49*cos(q1 - q2))/10 - (43*qdd1)/1000 + (43*qdd1*cos(2*q2))/1000 + (2881*qdd1*sin(2*q2))/10000 + (3*qdd1*sin(5239260779425957/18014398509481984))/20 + (3*qdd1*sin(2*q2 - 5239260779425957/18014398509481984))/20 + (3*qd1*qd2*cos(2*q2 - 5239260779425957/18014398509481984))/5 + (2881*qd1*qd2*cos(2*q2))/2500 - q3*qdd1*sin(2*q2) - (43*qd1*qd2*sin(2*q2))/250 - 2*qd1*qd3*sin(2*q2) - 4*q3*qd1*qd2*cos(2*q2), (49*sin(q1))/5, (241*q3*qdd1)/400 - (49*sin(q1 - q2 + 5239260779425957/18014398509481984))/10 - (49*sin(q1 + q2 - 5239260779425957/18014398509481984))/10 + (241*qd1*qd3)/200 + (241*q3*qdd1*cos(2*q2 - 5239260779425957/9007199254740992))/400 + (241*qd1*qd3*cos(2*q2 - 5239260779425957/9007199254740992))/200 - (241*q3*qd1*qd2*sin(2*q2 - 5239260779425957/9007199254740992))/100, (49*cos(q1))/5 + (241*qdd3*cos(q2 - 5239260779425957/18014398509481984))/400 - (241*q3*qd2^2*cos(q2 - 5239260779425957/18014398509481984))/200 - (241*q3*qdd2*sin(q2 - 5239260779425957/18014398509481984))/400 - (241*qd2*qd3*sin(q2 - 5239260779425957/18014398509481984))/100, (49*cos(q1 + q2 - 5239260779425957/18014398509481984))/10 - (49*cos(q1 - q2 + 5239260779425957/18014398509481984))/10 + (241*q3*qdd1*sin(2*q2 - 5239260779425957/9007199254740992))/400 + (241*qd1*qd3*sin(2*q2 - 5239260779425957/9007199254740992))/200 + (241*q3*qd1*qd2*cos(2*q2 - 5239260779425957/9007199254740992))/100,   0, -q1,    0,    0, -qd1,          0,          0, -sign(qd1), - (49*sin(q1 - q2))/10 - (49*sin(q1 + q2))/10, 2*cos(q2 - 5239260779425957/18014398509481984)*qd2^2 + qdd2*sin(q2 - 5239260779425957/18014398509481984), (3*cos(q2 - 5239260779425957/18014398509481984)*qd2^2)/10 - (49*cos(q1))/5 + (3*qdd2*sin(q2 - 5239260779425957/18014398509481984))/20, (49*cos(q1 - q2))/10 - (49*cos(q1 + q2))/10 - (3*qdd1*sin(5239260779425957/18014398509481984))/20 - (3*qdd1*sin(2*q2 - 5239260779425957/18014398509481984))/20 - (3*qd1*qd2*cos(2*q2 - 5239260779425957/18014398509481984))/5, - 2*cos(q2)*qd2^2 - qdd2*sin(q2), (3*qdd1*cos(q2 - 5239260779425957/9007199254740992))/20 - (49*sin(q1 + 5239260779425957/18014398509481984))/10 - (49*sin(q1 - 5239260779425957/18014398509481984))/10 + (3*qdd1*cos(q2))/20 - (3*qd1*qd2*sin(q2))/10 - (3*qd1*qd2*sin(q2 - 5239260779425957/9007199254740992))/10, qdd1/2 + (qdd1*cos(2*q2))/2 - 2*qd1*qd2*sin(2*q2), qdd1/2 - (qdd1*cos(2*q2 - 5239260779425957/9007199254740992))/2 + 2*qd1*qd2*sin(2*q2 - 5239260779425957/9007199254740992), -qdd2, qdd1, - qdd1*sin(2*q2 - 5239260779425957/9007199254740992) - 4*qd1*qd2*cos(2*q2 - 5239260779425957/9007199254740992)];
% F((k-1)*four.dof+2,:)=[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          (10735061*qdd2)/100000000 + (43*qdd3)/1000 - (2107*cos(q1 - q2))/10000 + (141169*sin(q1 - q2))/100000 - (147*sin(q1 + q2 - 5239260779425957/18014398509481984))/200 + (147*sin(q1 - q2 + 5239260779425957/18014398509481984))/200 - (2107*cos(q1 + q2))/10000 - (141169*sin(q1 + q2))/100000 + (129*qd1^2*cos(2*q2 - 5239260779425957/18014398509481984))/10000 - (2881*q3*qdd2)/5000 - (2881*qd2*qd3)/2500 + (9*qd1^2*sin(2*q2 - 5239260779425957/9007199254740992))/400 + (8643*qd1^2*sin(2*q2 - 5239260779425957/18014398509481984))/100000 + (123883*qd1^2*cos(2*q2))/5000000 + (8115261*qd1^2*sin(2*q2))/100000000 + (49*q3*sin(q1 + q2))/10 + q3^2*qdd2 + (8643*qdd2*cos(5239260779425957/18014398509481984))/100000 - (129*qdd2*sin(5239260779425957/18014398509481984))/10000 - (3*qdd3*sin(5239260779425957/18014398509481984))/20 - (49*q3*sin(q1 - q2))/10 - (3*q3*qdd2*cos(5239260779425957/18014398509481984))/10 - (3*qd2*qd3*cos(5239260779425957/18014398509481984))/5 + q3^2*qd1^2*sin(2*q2) + 4*q3*qd2*qd3 - (3*q3*qd1^2*sin(2*q2 - 5239260779425957/18014398509481984))/10 - (43*q3*qd1^2*cos(2*q2))/500 - (2881*q3*qd1^2*sin(2*q2))/5000,                                                                                                                                                    (11809*q3*sin(q1 - q2 + 5239260779425957/18014398509481984))/4000 + (58081*q3^2*qdd2)/160000 - (11809*q3*sin(q1 + q2 - 5239260779425957/18014398509481984))/4000 + (58081*q3^2*qd1^2*sin(2*q2 - 5239260779425957/9007199254740992))/160000 + (58081*q3*qd2*qd3)/40000,                                                                                                                                                                       (49*sin(q1 + q2))/10 - (49*sin(q1 - q2))/10 - (2881*qdd2)/5000 + 2*q3*qdd2 + 4*qd2*qd3 - (3*qd1^2*sin(2*q2 - 5239260779425957/18014398509481984))/10 - (43*qd1^2*cos(2*q2))/500 - (2881*qd1^2*sin(2*q2))/5000 - (3*qdd2*cos(5239260779425957/18014398509481984))/10 + 2*q3*qd1^2*sin(2*q2),                                                                                                                                                                                           (3*qdd1*sin(q2 - 5239260779425957/18014398509481984))/20 + (43*qdd1*cos(q2))/1000 + (2881*qdd1*sin(q2))/10000 - q3*qdd1*sin(q2),                                                                                                                                                                  (49*cos(q1 - q2))/10 - qdd3 - (43*qdd2)/500 + (49*cos(q1 + q2))/10 - (3*qd1^2*cos(2*q2 - 5239260779425957/18014398509481984))/10 - (2881*qd1^2*cos(2*q2))/5000 + (43*qd1^2*sin(2*q2))/500 + (3*qdd2*sin(5239260779425957/18014398509481984))/10 + 2*q3*qd1^2*cos(2*q2),              0,                                                                                                                                       (241*q3*sin(2*q2 - 5239260779425957/9007199254740992)*qd1^2)/200 - (49*sin(q1 + q2 - 5239260779425957/18014398509481984))/10 + (49*sin(q1 - q2 + 5239260779425957/18014398509481984))/10 + (241*q3*qdd2)/200 + (241*qd2*qd3)/100,                                                                                                                                                                                                                  -(241*q3*qdd1*sin(q2 - 5239260779425957/18014398509481984))/400,                                                                                                                      (241*qdd3)/400 + (49*cos(q1 + q2 - 5239260779425957/18014398509481984))/10 + (49*cos(q1 - q2 + 5239260779425957/18014398509481984))/10 - (241*q3*qd1^2*cos(2*q2 - 5239260779425957/9007199254740992))/200, -q2,   0,    0, -qd2,    0,          0, -sign(qd2),          0,   (49*sin(q1 - q2))/10 - (49*sin(q1 + q2))/10,                                                        qdd1*sin(q2 - 5239260779425957/18014398509481984),                                                                              (3*qdd1*sin(q2 - 5239260779425957/18014398509481984))/20,                                                               (3*cos(2*q2 - 5239260779425957/18014398509481984)*qd1^2)/10 - (49*cos(q1 - q2))/10 - (49*cos(q1 + q2))/10 - (3*qdd2*sin(5239260779425957/18014398509481984))/10,                    -qdd1*sin(q2),                                                                                                                                                                                                   (3*qd1^2*sin(q2))/20 + (3*qd1^2*sin(q2 - 5239260779425957/9007199254740992))/20,                                   qd1^2*sin(2*q2),                                                              - sin(2*q2 - 5239260779425957/9007199254740992)*qd1^2 + qdd2, -qdd1,    0,                                                          2*qd1^2*cos(2*q2 - 5239260779425957/9007199254740992)];
% F((k-1)*four.dof+3,:)=[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                (43*qdd2)/1000 + qdd3 - (49*cos(q1 - q2))/10 - (49*cos(q1 + q2))/10 + (3*qd1^2*cos(5239260779425957/18014398509481984))/20 + (3*qd2^2*cos(5239260779425957/18014398509481984))/10 + (3*qd1^2*cos(2*q2 - 5239260779425957/18014398509481984))/20 + (2881*qd1^2*cos(2*q2))/10000 - (43*qd1^2*sin(2*q2))/1000 - q3*qd1^2 - 2*q3*qd2^2 - (3*qdd2*sin(5239260779425957/18014398509481984))/20 + (2881*qd1^2)/10000 + (2881*qd2^2)/5000 - q3*qd1^2*cos(2*q2),                                                                                                                                         (58081*qdd3)/160000 + (11809*cos(q1 + q2 - 5239260779425957/18014398509481984))/4000 + (11809*cos(q1 - q2 + 5239260779425957/18014398509481984))/4000 - (58081*q3*qd1^2)/160000 - (58081*q3*qd2^2)/80000 - (58081*q3*qd1^2*cos(2*q2 - 5239260779425957/9007199254740992))/160000,                                                                                                                                                                                                                                                                                                                                                                                                                              - qd1^2*cos(2*q2) - qd1^2 - 2*qd2^2,                                                                                                                                                                                                                                                                                                              qdd1*cos(q2),                                                                                                                                                                                                                                                                                                                                                                                                                  sin(2*q2)*qd1^2 - qdd2,              0,                                                                                                                                                                                                                                                                    - (241*qd1^2*cos(2*q2 - 5239260779425957/9007199254740992))/400 - (241*qd1^2)/400 - (241*qd2^2)/200,                                                                                                                                                                                                                      (241*qdd1*cos(q2 - 5239260779425957/18014398509481984))/400,                                                                                                                                                                                                                                                 (241*qdd2)/400 - (241*qd1^2*sin(2*q2 - 5239260779425957/9007199254740992))/400,   0,   0, -qd3,    0,    0, -sign(qd3),          0,          0,                                             0,                                                                                                        0,                                                                                                                                     0,                                                                                                                                                                                                                             0,                                0,                                                                                                                                                                                                                                                                                 0,                                                 0,                                                                                                                         0,     0,    0,                                                                                                              0];
%  

%test_3dof_svd
% F((k-1)*four.dof+1,:)=[ (10735061*qdd1)/200000000 + (2107*cos(q1 - q2))/10000 - (141169*sin(q1 - q2))/100000 - (147*sin(q1 + q2 - 5239260779425957/18014398509481984))/200 - (147*sin(q1 - q2 + 5239260779425957/18014398509481984))/200 - (2107*cos(q1 + q2))/10000 - (141169*sin(q1 + q2))/100000 + (8115261*qdd1*cos(2*q2))/200000000 - (123883*qdd1*sin(2*q2))/10000000 - (2881*q3*qdd1)/10000 - (2881*qd1*qd3)/5000 + (49*q3*sin(q1 + q2))/10 + (q3^2*qdd1)/2 + (8643*qdd1*cos(5239260779425957/18014398509481984))/200000 - (129*qdd1*sin(5239260779425957/18014398509481984))/20000 + (9*qdd1*cos(2*q2 - 5239260779425957/9007199254740992))/800 + (8643*qdd1*cos(2*q2 - 5239260779425957/18014398509481984))/200000 + (49*q3*sin(q1 - q2))/10 - (129*qdd1*sin(2*q2 - 5239260779425957/18014398509481984))/20000 - (3*q3*qdd1*cos(5239260779425957/18014398509481984))/20 - (3*qd1*qd3*cos(5239260779425957/18014398509481984))/10 - (3*q3*qdd1*cos(2*q2 - 5239260779425957/18014398509481984))/20 - (129*qd1*qd2*cos(2*q2 - 5239260779425957/18014398509481984))/5000 - (3*qd1*qd3*cos(2*q2 - 5239260779425957/18014398509481984))/10 - (9*qd1*qd2*sin(2*q2 - 5239260779425957/9007199254740992))/200 - (8643*qd1*qd2*sin(2*q2 - 5239260779425957/18014398509481984))/50000 - (2881*q3*qdd1*cos(2*q2))/10000 - (123883*qd1*qd2*cos(2*q2))/2500000 - (2881*qd1*qd3*cos(2*q2))/5000 + (43*q3*qdd1*sin(2*q2))/1000 - (8115261*qd1*qd2*sin(2*q2))/50000000 + (43*qd1*qd3*sin(2*q2))/500 + 2*q3*qd1*qd3 + (q3^2*qdd1*cos(2*q2))/2 - 2*q3^2*qd1*qd2*sin(2*q2) + (3*q3*qd1*qd2*sin(2*q2 - 5239260779425957/18014398509481984))/5 + (43*q3*qd1*qd2*cos(2*q2))/250 + 2*q3*qd1*qd3*cos(2*q2) + (2881*q3*qd1*qd2*sin(2*q2))/2500, (q3^2*qdd1)/2 - (49*q3*sin(q1 - q2 + 5239260779425957/18014398509481984))/10 - (49*q3*sin(q1 + q2 - 5239260779425957/18014398509481984))/10 + (q3^2*qdd1*cos(2*q2 - 5239260779425957/9007199254740992))/2 + 2*q3*qd1*qd3 - 2*q3^2*qd1*qd2*sin(2*q2 - 5239260779425957/9007199254740992) + 2*q3*qd1*qd3*cos(2*q2 - 5239260779425957/9007199254740992), (49*sin(q1 - q2))/10 - (2881*qdd1)/10000 + (49*sin(q1 + q2))/10 - (2881*qdd1*cos(2*q2))/10000 + (43*qdd1*sin(2*q2))/1000 + q3*qdd1 + 2*qd1*qd3 - (3*qdd1*cos(5239260779425957/18014398509481984))/20 - (3*qdd1*cos(2*q2 - 5239260779425957/18014398509481984))/20 + (3*qd1*qd2*sin(2*q2 - 5239260779425957/18014398509481984))/5 + q3*qdd1*cos(2*q2) + (43*qd1*qd2*cos(2*q2))/250 + 2*qd1*qd3*cos(2*q2) + (2881*qd1*qd2*sin(2*q2))/2500 - 4*q3*qd1*qd2*sin(2*q2), (2881*qd2^2*cos(q2))/5000 - (49*cos(q1))/5 - (43*qd2^2*sin(q2))/500 + (3*qdd2*sin(q2 - 5239260779425957/18014398509481984))/20 + (43*qdd2*cos(q2))/1000 + qdd3*cos(q2) + (2881*qdd2*sin(q2))/10000 + (3*qd2^2*cos(q2 - 5239260779425957/18014398509481984))/10 - q3*qdd2*sin(q2) - 4*qd2*qd3*sin(q2) - 2*q3*qd2^2*cos(q2), (49*cos(q1 + q2))/10 - (49*cos(q1 - q2))/10 - (43*qdd1)/1000 + (43*qdd1*cos(2*q2))/1000 + (2881*qdd1*sin(2*q2))/10000 + (3*qdd1*sin(5239260779425957/18014398509481984))/20 + (3*qdd1*sin(2*q2 - 5239260779425957/18014398509481984))/20 + (3*qd1*qd2*cos(2*q2 - 5239260779425957/18014398509481984))/5 + (2881*qd1*qd2*cos(2*q2))/2500 - q3*qdd1*sin(2*q2) - (43*qd1*qd2*sin(2*q2))/250 - 2*qd1*qd3*sin(2*q2) - 4*q3*qd1*qd2*cos(2*q2), (49*sin(q1))/5, q3*qdd1 - (49*sin(q1 - q2 + 5239260779425957/18014398509481984))/10 - (49*sin(q1 + q2 - 5239260779425957/18014398509481984))/10 + 2*qd1*qd3 + q3*qdd1*cos(2*q2 - 5239260779425957/9007199254740992) + 2*qd1*qd3*cos(2*q2 - 5239260779425957/9007199254740992) - 4*q3*qd1*qd2*sin(2*q2 - 5239260779425957/9007199254740992), - 2*q3*cos(q2 - 5239260779425957/18014398509481984)*qd2^2 - 4*qd3*sin(q2 - 5239260779425957/18014398509481984)*qd2 + (49*cos(q1))/5 + qdd3*cos(q2 - 5239260779425957/18014398509481984) - q3*qdd2*sin(q2 - 5239260779425957/18014398509481984), (49*cos(q1 + q2 - 5239260779425957/18014398509481984))/5 - (49*cos(q1 - q2 + 5239260779425957/18014398509481984))/5 + 2*q3*qdd1*sin(2*q2 - 5239260779425957/9007199254740992) + 4*qd1*qd3*sin(2*q2 - 5239260779425957/9007199254740992) + 8*q3*qd1*qd2*cos(2*q2 - 5239260779425957/9007199254740992),   0, -q1,    0,    0, -qd1,          0,          0, -sign(qd1), qdd1/2 - (qdd1*cos(2*q2))/2 + 2*qd1*qd2*sin(2*q2), - (49*sin(q1 - q2))/10 - (49*sin(q1 + q2))/10, (3*cos(q2 - 5239260779425957/18014398509481984)*qd2^2)/10 - (49*cos(q1))/5 + (3*qdd2*sin(q2 - 5239260779425957/18014398509481984))/20,    0, -qdd2,   (49*cos(q1 - q2))/10 - (49*cos(q1 + q2))/10, qdd1, (49*cos(q1 - q2))/10 - (49*cos(q1 + q2))/10 - (3*qdd1*sin(5239260779425957/18014398509481984))/20 - (3*qdd1*sin(2*q2 - 5239260779425957/18014398509481984))/20 - (3*qd1*qd2*cos(2*q2 - 5239260779425957/18014398509481984))/5, - 2*sin(q2)*qd2^2 + qdd2*cos(q2), 2*cos(q2 - 5239260779425957/18014398509481984)*qd2^2 + qdd2*sin(q2 - 5239260779425957/18014398509481984), (3*qdd1*cos(q2 - 5239260779425957/9007199254740992))/20 - (49*sin(q1 + 5239260779425957/18014398509481984))/10 - (49*sin(q1 - 5239260779425957/18014398509481984))/10 + (3*qdd1*cos(q2))/20 - (3*qd1*qd2*sin(q2))/10 - (3*qd1*qd2*sin(q2 - 5239260779425957/9007199254740992))/10];
% F((k-1)*four.dof+2,:)=[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          (10735061*qdd2)/100000000 + (43*qdd3)/1000 - (2107*cos(q1 - q2))/10000 + (141169*sin(q1 - q2))/100000 - (147*sin(q1 + q2 - 5239260779425957/18014398509481984))/200 + (147*sin(q1 - q2 + 5239260779425957/18014398509481984))/200 - (2107*cos(q1 + q2))/10000 - (141169*sin(q1 + q2))/100000 + (129*qd1^2*cos(2*q2 - 5239260779425957/18014398509481984))/10000 - (2881*q3*qdd2)/5000 - (2881*qd2*qd3)/2500 + (9*qd1^2*sin(2*q2 - 5239260779425957/9007199254740992))/400 + (8643*qd1^2*sin(2*q2 - 5239260779425957/18014398509481984))/100000 + (123883*qd1^2*cos(2*q2))/5000000 + (8115261*qd1^2*sin(2*q2))/100000000 + (49*q3*sin(q1 + q2))/10 + q3^2*qdd2 + (8643*qdd2*cos(5239260779425957/18014398509481984))/100000 - (129*qdd2*sin(5239260779425957/18014398509481984))/10000 - (3*qdd3*sin(5239260779425957/18014398509481984))/20 - (49*q3*sin(q1 - q2))/10 - (3*q3*qdd2*cos(5239260779425957/18014398509481984))/10 - (3*qd2*qd3*cos(5239260779425957/18014398509481984))/5 + q3^2*qd1^2*sin(2*q2) + 4*q3*qd2*qd3 - (3*q3*qd1^2*sin(2*q2 - 5239260779425957/18014398509481984))/10 - (43*q3*qd1^2*cos(2*q2))/500 - (2881*q3*qd1^2*sin(2*q2))/5000,                                                                                                                                    (49*q3*sin(q1 - q2 + 5239260779425957/18014398509481984))/10 + q3^2*qdd2 - (49*q3*sin(q1 + q2 - 5239260779425957/18014398509481984))/10 + q3^2*qd1^2*sin(2*q2 - 5239260779425957/9007199254740992) + 4*q3*qd2*qd3,                                                                                                                                                                       (49*sin(q1 + q2))/10 - (49*sin(q1 - q2))/10 - (2881*qdd2)/5000 + 2*q3*qdd2 + 4*qd2*qd3 - (3*qd1^2*sin(2*q2 - 5239260779425957/18014398509481984))/10 - (43*qd1^2*cos(2*q2))/500 - (2881*qd1^2*sin(2*q2))/5000 - (3*qdd2*cos(5239260779425957/18014398509481984))/10 + 2*q3*qd1^2*sin(2*q2),                                                                                                                                                                                           (3*qdd1*sin(q2 - 5239260779425957/18014398509481984))/20 + (43*qdd1*cos(q2))/1000 + (2881*qdd1*sin(q2))/10000 - q3*qdd1*sin(q2),                                                                                                                                                                  (49*cos(q1 - q2))/10 - qdd3 - (43*qdd2)/500 + (49*cos(q1 + q2))/10 - (3*qd1^2*cos(2*q2 - 5239260779425957/18014398509481984))/10 - (2881*qd1^2*cos(2*q2))/5000 + (43*qd1^2*sin(2*q2))/500 + (3*qdd2*sin(5239260779425957/18014398509481984))/10 + 2*q3*qd1^2*cos(2*q2),              0,                                                                                                                   2*q3*sin(2*q2 - 5239260779425957/9007199254740992)*qd1^2 - (49*sin(q1 + q2 - 5239260779425957/18014398509481984))/10 + (49*sin(q1 - q2 + 5239260779425957/18014398509481984))/10 + 2*q3*qdd2 + 4*qd2*qd3,                                                                                                                                                                                          -q3*qdd1*sin(q2 - 5239260779425957/18014398509481984),                                                                                                            - 4*q3*cos(2*q2 - 5239260779425957/9007199254740992)*qd1^2 + 2*qdd3 + (49*cos(q1 + q2 - 5239260779425957/18014398509481984))/5 + (49*cos(q1 - q2 + 5239260779425957/18014398509481984))/5, -q2,   0,    0, -qd2,    0,          0, -sign(qd2),          0,                          - sin(2*q2)*qd1^2 + qdd2,   (49*sin(q1 - q2))/10 - (49*sin(q1 + q2))/10,                                                                              (3*qdd1*sin(q2 - 5239260779425957/18014398509481984))/20, qdd2, -qdd1, - (49*cos(q1 - q2))/10 - (49*cos(q1 + q2))/10,    0,                                                               (3*cos(2*q2 - 5239260779425957/18014398509481984)*qd1^2)/10 - (49*cos(q1 - q2))/10 - (49*cos(q1 + q2))/10 - (3*qdd2*sin(5239260779425957/18014398509481984))/10,                     qdd1*cos(q2),                                                        qdd1*sin(q2 - 5239260779425957/18014398509481984),                                                                                                                                                                                                   (3*qd1^2*sin(q2))/20 + (3*qd1^2*sin(q2 - 5239260779425957/9007199254740992))/20];
% F((k-1)*four.dof+3,:)=[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                (43*qdd2)/1000 + qdd3 - (49*cos(q1 - q2))/10 - (49*cos(q1 + q2))/10 + (3*qd1^2*cos(5239260779425957/18014398509481984))/20 + (3*qd2^2*cos(5239260779425957/18014398509481984))/10 + (3*qd1^2*cos(2*q2 - 5239260779425957/18014398509481984))/20 + (2881*qd1^2*cos(2*q2))/10000 - (43*qd1^2*sin(2*q2))/1000 - q3*qd1^2 - 2*q3*qd2^2 - (3*qdd2*sin(5239260779425957/18014398509481984))/20 + (2881*qd1^2)/10000 + (2881*qd2^2)/5000 - q3*qd1^2*cos(2*q2),                                                                                                                                        qdd3 + (49*cos(q1 + q2 - 5239260779425957/18014398509481984))/10 + (49*cos(q1 - q2 + 5239260779425957/18014398509481984))/10 - q3*qd1^2 - 2*q3*qd2^2 - q3*qd1^2*cos(2*q2 - 5239260779425957/9007199254740992),                                                                                                                                                                                                                                                                                                                                                                                                                              - qd1^2*cos(2*q2) - qd1^2 - 2*qd2^2,                                                                                                                                                                                                                                                                                                              qdd1*cos(q2),                                                                                                                                                                                                                                                                                                                                                                                                                  sin(2*q2)*qd1^2 - qdd2,              0,                                                                                                                                                                                                                                                    - qd1^2*cos(2*q2 - 5239260779425957/9007199254740992) - qd1^2 - 2*qd2^2,                                                                                                                                                                                              qdd1*cos(q2 - 5239260779425957/18014398509481984),                                                                                                                                                                                                                                     - 2*sin(2*q2 - 5239260779425957/9007199254740992)*qd1^2 + 2*qdd2,   0,   0, -qd3,    0,    0, -sign(qd3),          0,          0,                                                 0,                                             0,                                                                                                                                     0,    0,     0,                                             0,    0,                                                                                                                                                                                                                             0,                                0,                                                                                                        0,                                                                                                                                                                                                                                                                                 0];
%  
%3dof_svd
% F((k-1)*four.dof+1,:)= [ (q3^2*qdd1)/2 + 2*q3*qd1*qd3 - (49*q3*cos(q2)*cos(5239260779425957/18014398509481984)*sin(q1))/5 - (49*q3*sin(q1)*sin(q2)*sin(5239260779425957/18014398509481984))/5 + (q3^2*qdd1*cos(2*q2)*cos(5239260779425957/9007199254740992))/2 + (q3^2*qdd1*sin(2*q2)*sin(5239260779425957/9007199254740992))/2 + 2*q3^2*qd1*qd2*cos(2*q2)*sin(5239260779425957/9007199254740992) - 2*q3^2*qd1*qd2*sin(2*q2)*cos(5239260779425957/9007199254740992) + 2*q3*qd1*qd3*cos(2*q2)*cos(5239260779425957/9007199254740992) + 2*q3*qd1*qd3*sin(2*q2)*sin(5239260779425957/9007199254740992), (43*qdd1*sin(q3))/1000 - (49*cos(q1)*cos(q3))/5 + (49*sin(q1)*sin(q2)*sin(q3))/5 + (43*qd1*qd3*cos(q3))/500 + (43*qdd2*cos(q2)*cos(q3))/1000 + (2881*qdd2*cos(q3)*sin(q2))/10000 - (2881*qdd3*cos(q2)*sin(q3))/10000 + (43*qdd3*sin(q2)*sin(q3))/1000 - (3*qdd1*sin(q3)*sin(5239260779425957/18014398509481984))/20 + (2881*qd2^2*cos(q2)*cos(q3))/5000 - (2881*qd3^2*cos(q2)*cos(q3))/5000 - (43*qdd1*cos(2*q2)*sin(q3))/1000 - (43*qd2^2*cos(q3)*sin(q2))/500 + (43*qd3^2*cos(q3)*sin(q2))/500 - (2881*qdd1*sin(2*q2)*sin(q3))/10000 - (43*qd1*qd3*cos(2*q2)*cos(q3))/500 - (2881*qd1*qd2*cos(2*q2)*sin(q3))/2500 - (2881*qd1*qd3*sin(2*q2)*cos(q3))/5000 - (3*qdd2*cos(q2)*cos(q3)*sin(5239260779425957/18014398509481984))/20 + (3*qdd2*cos(q3)*cos(5239260779425957/18014398509481984)*sin(q2))/20 - (3*qdd3*cos(q2)*cos(5239260779425957/18014398509481984)*sin(q3))/20 + (43*qd1*qd2*sin(2*q2)*sin(q3))/250 - (3*qdd3*sin(q2)*sin(q3)*sin(5239260779425957/18014398509481984))/20 + (3*qd2^2*cos(q2)*cos(q3)*cos(5239260779425957/18014398509481984))/10 - (3*qd3^2*cos(q2)*cos(q3)*cos(5239260779425957/18014398509481984))/10 + (3*qdd1*cos(2*q2)*sin(q3)*sin(5239260779425957/18014398509481984))/20 - (3*qdd1*sin(2*q2)*cos(5239260779425957/18014398509481984)*sin(q3))/20 + (3*qd2^2*cos(q3)*sin(q2)*sin(5239260779425957/18014398509481984))/10 - (3*qd3^2*cos(q3)*sin(q2)*sin(5239260779425957/18014398509481984))/10 - (3*qd1*qd3*cos(q3)*sin(5239260779425957/18014398509481984))/10 - (3*qd1*qd2*cos(2*q2)*cos(5239260779425957/18014398509481984)*sin(q3))/5 + (3*qd1*qd3*cos(2*q2)*cos(q3)*sin(5239260779425957/18014398509481984))/10 - (3*qd1*qd3*sin(2*q2)*cos(q3)*cos(5239260779425957/18014398509481984))/10 - (3*qd1*qd2*sin(2*q2)*sin(q3)*sin(5239260779425957/18014398509481984))/5, - 2*cos(q2)*cos(q3)*qd2^2 + 4*qd1*cos(2*q2)*sin(q3)*qd2 + 2*cos(q2)*cos(q3)*qd3^2 + 2*qd1*sin(2*q2)*cos(q3)*qd3 - qdd2*cos(q3)*sin(q2) + qdd3*cos(q2)*sin(q3) + qdd1*sin(2*q2)*sin(q3), (3*qdd1)/4 - (qdd1*cos(2*q2))/4 + (qdd1*cos(2*q3))/4 + qdd3*sin(q2) + 2*qd2*qd3*cos(q2) + (qdd1*cos(2*q2)*cos(2*q3))/4 - qd2^2*sin(2*q3)*sin(q2) + qd1*qd2*sin(2*q2) - qd1*qd3*sin(2*q3) + (qdd2*sin(2*q3)*cos(q2))/2 + 2*qd2*qd3*cos(2*q3)*cos(q2) - qd1*qd2*cos(2*q3)*sin(2*q2) - qd1*qd3*cos(2*q2)*sin(2*q3), (43*qd1*qd3*sin(q3))/500 - (43*qdd1*cos(q3))/1000 - (49*cos(q1)*sin(q3))/5 + (2881*qdd3*cos(q2)*cos(q3))/10000 + (43*qdd2*cos(q2)*sin(q3))/1000 - (43*qdd3*cos(q3)*sin(q2))/1000 + (3*qdd1*cos(q3)*sin(5239260779425957/18014398509481984))/20 + (2881*qdd2*sin(q2)*sin(q3))/10000 + (43*qdd1*cos(2*q2)*cos(q3))/1000 + (2881*qdd1*sin(2*q2)*cos(q3))/10000 + (2881*qd2^2*cos(q2)*sin(q3))/5000 - (2881*qd3^2*cos(q2)*sin(q3))/5000 - (43*qd2^2*sin(q2)*sin(q3))/500 + (43*qd3^2*sin(q2)*sin(q3))/500 - (49*cos(q3)*sin(q1)*sin(q2))/5 - (3*qd1*qd3*sin(q3)*sin(5239260779425957/18014398509481984))/10 + (2881*qd1*qd2*cos(2*q2)*cos(q3))/2500 + (3*qdd3*cos(q2)*cos(q3)*cos(5239260779425957/18014398509481984))/20 - (43*qd1*qd2*sin(2*q2)*cos(q3))/250 - (43*qd1*qd3*cos(2*q2)*sin(q3))/500 - (2881*qd1*qd3*sin(2*q2)*sin(q3))/5000 - (3*qdd2*cos(q2)*sin(q3)*sin(5239260779425957/18014398509481984))/20 + (3*qdd2*cos(5239260779425957/18014398509481984)*sin(q2)*sin(q3))/20 + (3*qdd3*cos(q3)*sin(q2)*sin(5239260779425957/18014398509481984))/20 - (3*qdd1*cos(2*q2)*cos(q3)*sin(5239260779425957/18014398509481984))/20 + (3*qdd1*sin(2*q2)*cos(q3)*cos(5239260779425957/18014398509481984))/20 + (3*qd2^2*cos(q2)*cos(5239260779425957/18014398509481984)*sin(q3))/10 - (3*qd3^2*cos(q2)*cos(5239260779425957/18014398509481984)*sin(q3))/10 + (3*qd2^2*sin(q2)*sin(q3)*sin(5239260779425957/18014398509481984))/10 - (3*qd3^2*sin(q2)*sin(q3)*sin(5239260779425957/18014398509481984))/10 + (3*qd1*qd2*cos(2*q2)*cos(q3)*cos(5239260779425957/18014398509481984))/5 + (3*qd1*qd2*sin(2*q2)*cos(q3)*sin(5239260779425957/18014398509481984))/5 + (3*qd1*qd3*cos(2*q2)*sin(q3)*sin(5239260779425957/18014398509481984))/10 - (3*qd1*qd3*sin(2*q2)*cos(5239260779425957/18014398509481984)*sin(q3))/10, - 2*cos(q2)*sin(q3)*qd2^2 - 4*qd1*cos(2*q2)*cos(q3)*qd2 + 2*cos(q2)*sin(q3)*qd3^2 + 2*qd1*sin(2*q2)*sin(q3)*qd3 - qdd3*cos(q2)*cos(q3) - qdd2*sin(q2)*sin(q3) - qdd1*sin(2*q2)*cos(q3), (qdd1*sin(2*q3))/2 + (qdd1*cos(2*q2)*sin(2*q3))/2 + 2*qd2^2*cos(2*q3)*sin(q2) + 2*qd1*qd3*cos(2*q3) - qdd2*cos(2*q3)*cos(q2) + 4*qd2*qd3*sin(2*q3)*cos(q2) + 2*qd1*qd3*cos(2*q2)*cos(2*q3) - 2*qd1*qd2*sin(2*q2)*sin(2*q3), (3*qdd1)/4 - (qdd1*cos(2*q2))/4 - (qdd1*cos(2*q3))/4 + qdd3*sin(q2) + 2*qd2*qd3*cos(q2) - (qdd1*cos(2*q2)*cos(2*q3))/4 + qd2^2*sin(2*q3)*sin(q2) + qd1*qd2*sin(2*q2) + qd1*qd3*sin(2*q3) - (qdd2*sin(2*q3)*cos(q2))/2 - 2*qd2*qd3*cos(2*q3)*cos(q2) + qd1*qd2*cos(2*q3)*sin(2*q2) + qd1*qd3*cos(2*q2)*sin(2*q3), (49*sin(q1))/5, q3*qdd1 + 2*qd1*qd3 - (49*sin(q1)*sin(q2)*sin(5239260779425957/18014398509481984))/5 - (49*cos(q2)*cos(5239260779425957/18014398509481984)*sin(q1))/5 + q3*qdd1*cos(2*q2)*cos(5239260779425957/9007199254740992) + 2*qd1*qd3*cos(2*q2)*cos(5239260779425957/9007199254740992) + q3*qdd1*sin(2*q2)*sin(5239260779425957/9007199254740992) + 2*qd1*qd3*sin(2*q2)*sin(5239260779425957/9007199254740992) + 4*q3*qd1*qd2*cos(2*q2)*sin(5239260779425957/9007199254740992) - 4*q3*qd1*qd2*sin(2*q2)*cos(5239260779425957/9007199254740992), (49*cos(q1))/5 + qdd3*cos(q2)*cos(5239260779425957/18014398509481984) + qdd3*sin(q2)*sin(5239260779425957/18014398509481984) - 2*q3*qd2^2*cos(q2)*cos(5239260779425957/18014398509481984) - 2*q3*qd2^2*sin(q2)*sin(5239260779425957/18014398509481984) + q3*qdd2*cos(q2)*sin(5239260779425957/18014398509481984) - q3*qdd2*cos(5239260779425957/18014398509481984)*sin(q2) + 4*qd2*qd3*cos(q2)*sin(5239260779425957/18014398509481984) - 4*qd2*qd3*cos(5239260779425957/18014398509481984)*sin(q2), (98*cos(q2)*sin(q1)*sin(5239260779425957/18014398509481984))/5 - (98*cos(5239260779425957/18014398509481984)*sin(q1)*sin(q2))/5 - 2*q3*qdd1*cos(2*q2)*sin(5239260779425957/9007199254740992) + 2*q3*qdd1*sin(2*q2)*cos(5239260779425957/9007199254740992) - 4*qd1*qd3*cos(2*q2)*sin(5239260779425957/9007199254740992) + 4*qd1*qd3*sin(2*q2)*cos(5239260779425957/9007199254740992) + 8*q3*qd1*qd2*cos(2*q2)*cos(5239260779425957/9007199254740992) + 8*q3*qd1*qd2*sin(2*q2)*sin(5239260779425957/9007199254740992),   0, -q1,    0,    0, -qd1,          0,          0, -sign(qd1), qdd1*sin(5239260779425957/9007199254740992), 2*qd2^2*cos(5239260779425957/18014398509481984)*sin(q2) - qdd2*sin(q2)*sin(5239260779425957/18014398509481984) - 2*qd2^2*cos(q2)*sin(5239260779425957/18014398509481984) - qdd2*cos(q2)*cos(5239260779425957/18014398509481984), qdd1*cos(2*q2)*sin(5239260779425957/9007199254740992) - qdd1*sin(2*q2)*cos(5239260779425957/9007199254740992) - 4*qd1*qd2*cos(2*q2)*cos(5239260779425957/9007199254740992) - 4*qd1*qd2*sin(2*q2)*sin(5239260779425957/9007199254740992), qdd1/2 + (qdd1*cos(2*q2)*cos(5239260779425957/9007199254740992))/2 + (qdd1*sin(2*q2)*sin(5239260779425957/9007199254740992))/2 + 2*qd1*qd2*cos(2*q2)*sin(5239260779425957/9007199254740992) - 2*qd1*qd2*sin(2*q2)*cos(5239260779425957/9007199254740992), (49*sin(q1)*sin(q2))/5 - (3*qdd1*sin(5239260779425957/18014398509481984))/20 + (3*qdd1*cos(2*q2)*sin(5239260779425957/18014398509481984))/20 - (3*qdd1*sin(2*q2)*cos(5239260779425957/18014398509481984))/20 - (3*qd1*qd2*cos(2*q2)*cos(5239260779425957/18014398509481984))/5 - (3*qd1*qd2*sin(2*q2)*sin(5239260779425957/18014398509481984))/5, (3*qdd1*cos(q2))/20 - (49*cos(5239260779425957/18014398509481984)*sin(q1))/5 - (3*qd1*qd2*sin(q2))/10 + (3*qdd1*cos(q2)*cos(5239260779425957/9007199254740992))/20 + (3*qdd1*sin(q2)*sin(5239260779425957/9007199254740992))/20 + (3*qd1*qd2*cos(q2)*sin(5239260779425957/9007199254740992))/10 - (3*qd1*qd2*cos(5239260779425957/9007199254740992)*sin(q2))/10, -qdd2, qdd2*cos(5239260779425957/18014398509481984)*sin(q2) - qdd2*cos(q2)*sin(5239260779425957/18014398509481984) + 2*qd2^2*cos(q2)*cos(5239260779425957/18014398509481984) + 2*qd2^2*sin(q2)*sin(5239260779425957/18014398509481984), (10735061*qdd1)/200000000 + (8115261*qdd1*cos(2*q2))/200000000 - (123883*qdd1*sin(2*q2))/10000000 - (141169*cos(q2)*sin(q1))/50000 + (2107*sin(q1)*sin(q2))/5000 + (8643*qdd1*cos(5239260779425957/18014398509481984))/200000 - (129*qdd1*sin(5239260779425957/18014398509481984))/20000 - (147*sin(q1)*sin(q2)*sin(5239260779425957/18014398509481984))/100 - (123883*qd1*qd2*cos(2*q2))/2500000 - (8115261*qd1*qd2*sin(2*q2))/50000000 + (8643*qdd1*cos(2*q2)*cos(5239260779425957/18014398509481984))/200000 + (9*qdd1*cos(2*q2)*cos(5239260779425957/9007199254740992))/800 + (129*qdd1*cos(2*q2)*sin(5239260779425957/18014398509481984))/20000 - (129*qdd1*sin(2*q2)*cos(5239260779425957/18014398509481984))/20000 - (147*cos(q2)*cos(5239260779425957/18014398509481984)*sin(q1))/100 + (8643*qdd1*sin(2*q2)*sin(5239260779425957/18014398509481984))/200000 + (9*qdd1*sin(2*q2)*sin(5239260779425957/9007199254740992))/800 - (129*qd1*qd2*cos(2*q2)*cos(5239260779425957/18014398509481984))/5000 + (8643*qd1*qd2*cos(2*q2)*sin(5239260779425957/18014398509481984))/50000 + (9*qd1*qd2*cos(2*q2)*sin(5239260779425957/9007199254740992))/200 - (8643*qd1*qd2*sin(2*q2)*cos(5239260779425957/18014398509481984))/50000 - (9*qd1*qd2*sin(2*q2)*cos(5239260779425957/9007199254740992))/200 - (129*qd1*qd2*sin(2*q2)*sin(5239260779425957/18014398509481984))/5000, qdd1/2 + (qdd1*cos(2*q2))/2 - 2*qd1*qd2*sin(2*q2), (3*qdd2*cos(5239260779425957/18014398509481984)*sin(q2))/20 - (3*qdd2*cos(q2)*sin(5239260779425957/18014398509481984))/20 - (49*cos(q1))/5 + (3*qd2^2*cos(q2)*cos(5239260779425957/18014398509481984))/10 + (3*qd2^2*sin(q2)*sin(5239260779425957/18014398509481984))/10];
% F((k-1)*four.dof+2,:)= [                                                                                                                                                                                                                                                                               q3^2*qdd2 + 4*q3*qd2*qd3 - q3^2*qd1^2*cos(2*q2)*sin(5239260779425957/9007199254740992) + q3^2*qd1^2*sin(2*q2)*cos(5239260779425957/9007199254740992) + (49*q3*cos(q1)*cos(q2)*sin(5239260779425957/18014398509481984))/5 - (49*q3*cos(q1)*cos(5239260779425957/18014398509481984)*sin(q2))/5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       (2881*qdd3*cos(q3))/10000 - (2881*qd3^2*sin(q3))/5000 + (43*qdd2*sin(q3))/500 + (43*qd2*qd3*cos(q3))/250 + (2881*qd1^2*cos(2*q2)*sin(q3))/5000 - (43*qd1^2*sin(2*q2)*sin(q3))/500 + (43*qdd1*cos(q2)*cos(q3))/1000 + (3*qdd3*cos(q3)*cos(5239260779425957/18014398509481984))/20 + (2881*qdd1*cos(q3)*sin(q2))/10000 - (3*qdd2*sin(q3)*sin(5239260779425957/18014398509481984))/10 - (49*cos(q1)*cos(q2)*sin(q3))/5 - (3*qd3^2*cos(5239260779425957/18014398509481984)*sin(q3))/10 - (2881*qd1*qd3*sin(q2)*sin(q3))/2500 + (3*qd1^2*cos(2*q2)*cos(5239260779425957/18014398509481984)*sin(q3))/10 + (3*qd1^2*sin(2*q2)*sin(q3)*sin(5239260779425957/18014398509481984))/10 - (3*qdd1*cos(q2)*cos(q3)*sin(5239260779425957/18014398509481984))/20 + (3*qdd1*cos(q3)*cos(5239260779425957/18014398509481984)*sin(q2))/20 - (43*qd1*qd3*cos(q2)*sin(q3))/250 - (3*qd2*qd3*cos(q3)*sin(5239260779425957/18014398509481984))/5 + (3*qd1*qd3*cos(q2)*sin(q3)*sin(5239260779425957/18014398509481984))/5 - (3*qd1*qd3*cos(5239260779425957/18014398509481984)*sin(q2)*sin(q3))/5,                                                                        - 2*cos(2*q2)*sin(q3)*qd1^2 + 4*sin(q2)*sin(q3)*qd1*qd3 + 2*sin(q3)*qd3^2 - qdd3*cos(q3) - qdd1*cos(q3)*sin(q2),                                                                                                                          qdd2/2 - (qdd2*cos(2*q3))/2 - (qd1^2*sin(2*q2))/2 - 2*qd1*qd3*cos(q2) + 2*qd2*qd3*sin(2*q3) + (qd1^2*cos(2*q3)*sin(2*q2))/2 + (qdd1*sin(2*q3)*cos(q2))/2 + 2*qd1*qd3*cos(2*q3)*cos(q2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       (2881*qd3^2*cos(q3))/5000 - (43*qdd2*cos(q3))/500 + (2881*qdd3*sin(q3))/10000 + (43*qd2*qd3*sin(q3))/250 - (2881*qd1^2*cos(2*q2)*cos(q3))/5000 + (43*qd1^2*sin(2*q2)*cos(q3))/500 + (43*qdd1*cos(q2)*sin(q3))/1000 + (3*qdd2*cos(q3)*sin(5239260779425957/18014398509481984))/10 + (3*qdd3*cos(5239260779425957/18014398509481984)*sin(q3))/20 + (2881*qdd1*sin(q2)*sin(q3))/10000 + (49*cos(q1)*cos(q2)*cos(q3))/5 + (3*qd3^2*cos(q3)*cos(5239260779425957/18014398509481984))/10 - (3*qd2*qd3*sin(q3)*sin(5239260779425957/18014398509481984))/5 - (3*qd1^2*cos(2*q2)*cos(q3)*cos(5239260779425957/18014398509481984))/10 - (3*qd1^2*sin(2*q2)*cos(q3)*sin(5239260779425957/18014398509481984))/10 - (3*qdd1*cos(q2)*sin(q3)*sin(5239260779425957/18014398509481984))/20 + (3*qdd1*cos(5239260779425957/18014398509481984)*sin(q2)*sin(q3))/20 + (43*qd1*qd3*cos(q2)*cos(q3))/250 + (2881*qd1*qd3*cos(q3)*sin(q2))/2500 - (3*qd1*qd3*cos(q2)*cos(q3)*sin(5239260779425957/18014398509481984))/5 + (3*qd1*qd3*cos(q3)*cos(5239260779425957/18014398509481984)*sin(q2))/5,                                                                          2*cos(2*q2)*cos(q3)*qd1^2 - 4*cos(q3)*sin(q2)*qd1*qd3 - 2*cos(q3)*qd3^2 - qdd3*sin(q3) - qdd1*sin(q2)*sin(q3),                                                                                                    sin(2*q2)*sin(2*q3)*qd1^2 + 4*qd3*sin(2*q3)*cos(q2)*qd1 - qdd2*sin(2*q3) - 4*qd2*qd3*cos(2*q3) - qdd1*cos(2*q3)*cos(q2),                                                                                                                          qdd2/2 + (qdd2*cos(2*q3))/2 - (qd1^2*sin(2*q2))/2 - 2*qd1*qd3*cos(q2) - 2*qd2*qd3*sin(2*q3) - (qd1^2*cos(2*q3)*sin(2*q2))/2 - (qdd1*sin(2*q3)*cos(q2))/2 - 2*qd1*qd3*cos(2*q3)*cos(q2),              0,                                                                                                                                                                                                                                                   2*q3*qdd2 + 4*qd2*qd3 + (49*cos(q1)*cos(q2)*sin(5239260779425957/18014398509481984))/5 - (49*cos(q1)*cos(5239260779425957/18014398509481984)*sin(q2))/5 - 2*q3*qd1^2*cos(2*q2)*sin(5239260779425957/9007199254740992) + 2*q3*qd1^2*sin(2*q2)*cos(5239260779425957/9007199254740992),                                                                                                                                                                                                                                                                                                                                                                                  q3*qdd1*cos(q2)*sin(5239260779425957/18014398509481984) - q3*qdd1*cos(5239260779425957/18014398509481984)*sin(q2),                                                                                                                                                                                                                                                2*qdd3 + (98*cos(q1)*sin(q2)*sin(5239260779425957/18014398509481984))/5 + (98*cos(q1)*cos(q2)*cos(5239260779425957/18014398509481984))/5 - 4*q3*qd1^2*cos(2*q2)*cos(5239260779425957/9007199254740992) - 4*q3*qd1^2*sin(2*q2)*sin(5239260779425957/9007199254740992), -q2,   0,    0, -qd2,    0,          0, -sign(qd2),          0,                                           0,                                                                                                                   - qdd1*cos(q2)*cos(5239260779425957/18014398509481984) - qdd1*sin(q2)*sin(5239260779425957/18014398509481984),                                                                                                                     2*qd1^2*cos(2*q2)*cos(5239260779425957/9007199254740992) + 2*qd1^2*sin(2*q2)*sin(5239260779425957/9007199254740992),                                                                                                                                   qdd2 - qd1^2*cos(2*q2)*sin(5239260779425957/9007199254740992) + qd1^2*sin(2*q2)*cos(5239260779425957/9007199254740992),                                                                                                                                   (3*qd1^2*cos(2*q2)*cos(5239260779425957/18014398509481984))/10 - (3*qdd2*sin(5239260779425957/18014398509481984))/10 - (49*cos(q1)*cos(q2))/5 + (3*qd1^2*sin(2*q2)*sin(5239260779425957/18014398509481984))/10,                                                                                                                                                                                                                (3*qd1^2*sin(q2))/20 - (3*qd1^2*cos(q2)*sin(5239260779425957/9007199254740992))/20 + (3*qd1^2*cos(5239260779425957/9007199254740992)*sin(q2))/20, -qdd1,                                                                                                                     qdd1*cos(5239260779425957/18014398509481984)*sin(q2) - qdd1*cos(q2)*sin(5239260779425957/18014398509481984),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            (10735061*qdd2)/100000000 - (2107*cos(q1)*cos(q2))/5000 - (141169*cos(q1)*sin(q2))/50000 + (123883*qd1^2*cos(2*q2))/5000000 + (8115261*qd1^2*sin(2*q2))/100000000 + (8643*qdd2*cos(5239260779425957/18014398509481984))/100000 - (129*qdd2*sin(5239260779425957/18014398509481984))/10000 + (129*qd1^2*cos(2*q2)*cos(5239260779425957/18014398509481984))/10000 - (8643*qd1^2*cos(2*q2)*sin(5239260779425957/18014398509481984))/100000 - (9*qd1^2*cos(2*q2)*sin(5239260779425957/9007199254740992))/400 + (8643*qd1^2*sin(2*q2)*cos(5239260779425957/18014398509481984))/100000 + (9*qd1^2*sin(2*q2)*cos(5239260779425957/9007199254740992))/400 + (129*qd1^2*sin(2*q2)*sin(5239260779425957/18014398509481984))/10000 + (147*cos(q1)*cos(q2)*sin(5239260779425957/18014398509481984))/100 - (147*cos(q1)*cos(5239260779425957/18014398509481984)*sin(q2))/100,                                   qd1^2*sin(2*q2),                                                                                                                                                (3*qdd1*cos(5239260779425957/18014398509481984)*sin(q2))/20 - (3*qdd1*cos(q2)*sin(5239260779425957/18014398509481984))/20];
% F((k-1)*four.dof+3,:)= [                                                                                                                                               qdd3 - 2*q3*qd1^2 - 2*q3*qd2^2 + (49*cos(q1)*sin(q2)*sin(5239260779425957/18014398509481984))/5 + 2*q3*qd1^2*cos(q2)^2 + 2*q3*qd1^2*cos(5239260779425957/18014398509481984)^2 + (49*cos(q1)*cos(q2)*cos(5239260779425957/18014398509481984))/5 - 4*q3*qd1^2*cos(q2)^2*cos(5239260779425957/18014398509481984)^2 - 4*q3*qd1^2*cos(q2)*cos(5239260779425957/18014398509481984)*sin(q2)*sin(5239260779425957/18014398509481984),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              (49*sin(q1)*sin(q3))/5 - (43*qd2^2*cos(q3))/500 - (43*qd1^2*cos(q3))/500 + (2881*qdd2*cos(q3))/10000 + (43*qd1^2*cos(q2)^2*cos(q3))/500 + (3*qdd2*cos(q3)*cos(5239260779425957/18014398509481984))/20 - (2881*qdd1*cos(q2)*sin(q3))/10000 + (43*qdd1*sin(q2)*sin(q3))/1000 - (49*cos(q1)*cos(q3)*sin(q2))/5 + (3*qd1^2*cos(q3)*sin(5239260779425957/18014398509481984))/10 + (3*qd2^2*cos(q3)*sin(5239260779425957/18014398509481984))/10 + (2881*qd1*qd2*sin(q2)*sin(q3))/2500 - (3*qd1^2*cos(q2)^2*cos(q3)*sin(5239260779425957/18014398509481984))/10 - (3*qdd1*cos(q2)*cos(5239260779425957/18014398509481984)*sin(q3))/20 - (3*qdd1*sin(q2)*sin(q3)*sin(5239260779425957/18014398509481984))/20 + (2881*qd1^2*cos(q2)*cos(q3)*sin(q2))/5000 + (43*qd1*qd2*cos(q2)*sin(q3))/250 + (3*qd1^2*cos(q2)*cos(q3)*cos(5239260779425957/18014398509481984)*sin(q2))/10 - (3*qd1*qd2*cos(q2)*sin(q3)*sin(5239260779425957/18014398509481984))/5 + (3*qd1*qd2*cos(5239260779425957/18014398509481984)*sin(q2)*sin(q3))/5,                                                                                    - 2*cos(q2)*cos(q3)*sin(q2)*qd1^2 - 4*qd2*sin(q2)*sin(q3)*qd1 - qdd2*cos(q3) + qdd1*cos(q2)*sin(q3),                                                                                                                                                                                     qdd3 - qd2^2*sin(2*q3) + qdd1*sin(q2) + 4*qd1*qd2*cos(q2) + 2*qd1^2*cos(q2)^2*cos(q3)*sin(q3) - 4*qd1*qd2*cos(q2)*cos(q3)^2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              (2881*qdd2*sin(q3))/10000 - (43*qd2^2*sin(q3))/500 - (49*cos(q3)*sin(q1))/5 - (43*qd1^2*sin(q3))/500 + (43*qd1^2*cos(q2)^2*sin(q3))/500 + (2881*qdd1*cos(q2)*cos(q3))/10000 - (43*qdd1*cos(q3)*sin(q2))/1000 + (3*qdd2*cos(5239260779425957/18014398509481984)*sin(q3))/20 - (49*cos(q1)*sin(q2)*sin(q3))/5 + (3*qd1^2*sin(q3)*sin(5239260779425957/18014398509481984))/10 + (3*qd2^2*sin(q3)*sin(5239260779425957/18014398509481984))/10 - (3*qd1^2*cos(q2)^2*sin(q3)*sin(5239260779425957/18014398509481984))/10 + (3*qdd1*cos(q2)*cos(q3)*cos(5239260779425957/18014398509481984))/20 + (3*qdd1*cos(q3)*sin(q2)*sin(5239260779425957/18014398509481984))/20 + (2881*qd1^2*cos(q2)*sin(q2)*sin(q3))/5000 - (43*qd1*qd2*cos(q2)*cos(q3))/250 - (2881*qd1*qd2*cos(q3)*sin(q2))/2500 + (3*qd1^2*cos(q2)*cos(5239260779425957/18014398509481984)*sin(q2)*sin(q3))/10 + (3*qd1*qd2*cos(q2)*cos(q3)*sin(5239260779425957/18014398509481984))/5 - (3*qd1*qd2*cos(q3)*cos(5239260779425957/18014398509481984)*sin(q2))/5,                                                                                    - 2*cos(q2)*sin(q2)*sin(q3)*qd1^2 + 4*qd2*cos(q3)*sin(q2)*qd1 - qdd2*sin(q3) - qdd1*cos(q2)*cos(q3),                                                                                                          2*qd1^2*cos(q2)^2 + 4*qd2^2*cos(q3)^2 - 2*qd2^2 - 4*qd1^2*cos(q2)^2*cos(q3)^2 - 8*qd1*qd2*cos(q2)*cos(q3)*sin(q3),                                                                                                                                                                                                         qdd3 + qd2^2*sin(2*q3) + qdd1*sin(q2) - 2*qd1^2*cos(q2)^2*cos(q3)*sin(q3) + 4*qd1*qd2*cos(q2)*cos(q3)^2,              0,                                                                                                                                                                                                                                                                     2*qd1^2*cos(q2)^2 + 2*qd1^2*cos(5239260779425957/18014398509481984)^2 - 2*qd1^2 - 2*qd2^2 - 4*qd1^2*cos(q2)^2*cos(5239260779425957/18014398509481984)^2 - 4*qd1^2*cos(q2)*cos(5239260779425957/18014398509481984)*sin(q2)*sin(5239260779425957/18014398509481984),                                                                                                                                                                                                                                                                                                                                                                                        qdd1*cos(q2)*cos(5239260779425957/18014398509481984) + qdd1*sin(q2)*sin(5239260779425957/18014398509481984),                                                                                                                                                                                                                                                                 2*qdd2 - 2*qd1^2*sin(5239260779425957/9007199254740992) + 2*qd1^2*sin(2*q2) - 8*qd1^2*cos(q2)*cos(5239260779425957/18014398509481984)^2*sin(q2) + 8*qd1^2*cos(q2)^2*cos(5239260779425957/18014398509481984)*sin(5239260779425957/18014398509481984),   0,   0, -qd3,    0,    0, -sign(qd3),          0,          0,                                           0,                                                                                                                                                                                                                               0,                                                                                                                                                                                                                                       0,                                                                                                                                                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                                                               0,     0,                                                                                                                                                                                                                               0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                 0,                                                                                                                                                                                                                                                                        0];
%  

%3dof inplane
%F((k-1)*four.dof+1:(k-1)*four.dof+four.dof,:) = eval(four.Ys2);

% F((k-1)*four.dof+1,:)=[ (q3^2*qdd1)/2 + 2*q3*qd1*qd3 - (49*q3*cos(q2)*cos(5239260779425957/18014398509481984)*sin(q1))/5 - (49*q3*sin(q1)*sin(q2)*sin(5239260779425957/18014398509481984))/5 + (q3^2*qdd1*cos(2*q2)*cos(5239260779425957/9007199254740992))/2 + (q3^2*qdd1*sin(2*q2)*sin(5239260779425957/9007199254740992))/2 + 2*q3^2*qd1*qd2*cos(2*q2)*sin(5239260779425957/9007199254740992) - 2*q3^2*qd1*qd2*sin(2*q2)*cos(5239260779425957/9007199254740992) + 2*q3*qd1*qd3*cos(2*q2)*cos(5239260779425957/9007199254740992) + 2*q3*qd1*qd3*sin(2*q2)*sin(5239260779425957/9007199254740992), (43*qdd1*sin(q3))/1000 - (49*cos(q1)*cos(q3))/5 + (49*sin(q1)*sin(q2)*sin(q3))/5 + (43*qd1*qd3*cos(q3))/500 + (43*qdd2*cos(q2)*cos(q3))/1000 + (2881*qdd2*cos(q3)*sin(q2))/10000 - (2881*qdd3*cos(q2)*sin(q3))/10000 + (43*qdd3*sin(q2)*sin(q3))/1000 - (3*qdd1*sin(q3)*sin(5239260779425957/18014398509481984))/20 + (2881*qd2^2*cos(q2)*cos(q3))/5000 - (2881*qd3^2*cos(q2)*cos(q3))/5000 - (43*qdd1*cos(2*q2)*sin(q3))/1000 - (43*qd2^2*cos(q3)*sin(q2))/500 + (43*qd3^2*cos(q3)*sin(q2))/500 - (2881*qdd1*sin(2*q2)*sin(q3))/10000 - (43*qd1*qd3*cos(2*q2)*cos(q3))/500 - (2881*qd1*qd2*cos(2*q2)*sin(q3))/2500 - (2881*qd1*qd3*sin(2*q2)*cos(q3))/5000 - (3*qdd2*cos(q2)*cos(q3)*sin(5239260779425957/18014398509481984))/20 + (3*qdd2*cos(q3)*cos(5239260779425957/18014398509481984)*sin(q2))/20 - (3*qdd3*cos(q2)*cos(5239260779425957/18014398509481984)*sin(q3))/20 + (43*qd1*qd2*sin(2*q2)*sin(q3))/250 - (3*qdd3*sin(q2)*sin(q3)*sin(5239260779425957/18014398509481984))/20 + (3*qd2^2*cos(q2)*cos(q3)*cos(5239260779425957/18014398509481984))/10 - (3*qd3^2*cos(q2)*cos(q3)*cos(5239260779425957/18014398509481984))/10 + (3*qdd1*cos(2*q2)*sin(q3)*sin(5239260779425957/18014398509481984))/20 - (3*qdd1*sin(2*q2)*cos(5239260779425957/18014398509481984)*sin(q3))/20 + (3*qd2^2*cos(q3)*sin(q2)*sin(5239260779425957/18014398509481984))/10 - (3*qd3^2*cos(q3)*sin(q2)*sin(5239260779425957/18014398509481984))/10 - (3*qd1*qd3*cos(q3)*sin(5239260779425957/18014398509481984))/10 - (3*qd1*qd2*cos(2*q2)*cos(5239260779425957/18014398509481984)*sin(q3))/5 + (3*qd1*qd3*cos(2*q2)*cos(q3)*sin(5239260779425957/18014398509481984))/10 - (3*qd1*qd3*sin(2*q2)*cos(q3)*cos(5239260779425957/18014398509481984))/10 - (3*qd1*qd2*sin(2*q2)*sin(q3)*sin(5239260779425957/18014398509481984))/5, - 2*cos(q2)*cos(q3)*qd2^2 + 4*qd1*cos(2*q2)*sin(q3)*qd2 + 2*cos(q2)*cos(q3)*qd3^2 + 2*qd1*sin(2*q2)*cos(q3)*qd3 - qdd2*cos(q3)*sin(q2) + qdd3*cos(q2)*sin(q3) + qdd1*sin(2*q2)*sin(q3), (3*qdd1)/4 - (qdd1*cos(2*q2))/4 + (qdd1*cos(2*q3))/4 + qdd3*sin(q2) + 2*qd2*qd3*cos(q2) + (qdd1*cos(2*q2)*cos(2*q3))/4 - qd2^2*sin(2*q3)*sin(q2) + qd1*qd2*sin(2*q2) - qd1*qd3*sin(2*q3) + (qdd2*sin(2*q3)*cos(q2))/2 + 2*qd2*qd3*cos(2*q3)*cos(q2) - qd1*qd2*cos(2*q3)*sin(2*q2) - qd1*qd3*cos(2*q2)*sin(2*q3), (43*qd1*qd3*sin(q3))/500 - (43*qdd1*cos(q3))/1000 - (49*cos(q1)*sin(q3))/5 + (2881*qdd3*cos(q2)*cos(q3))/10000 + (43*qdd2*cos(q2)*sin(q3))/1000 - (43*qdd3*cos(q3)*sin(q2))/1000 + (3*qdd1*cos(q3)*sin(5239260779425957/18014398509481984))/20 + (2881*qdd2*sin(q2)*sin(q3))/10000 + (43*qdd1*cos(2*q2)*cos(q3))/1000 + (2881*qdd1*sin(2*q2)*cos(q3))/10000 + (2881*qd2^2*cos(q2)*sin(q3))/5000 - (2881*qd3^2*cos(q2)*sin(q3))/5000 - (43*qd2^2*sin(q2)*sin(q3))/500 + (43*qd3^2*sin(q2)*sin(q3))/500 - (49*cos(q3)*sin(q1)*sin(q2))/5 - (3*qd1*qd3*sin(q3)*sin(5239260779425957/18014398509481984))/10 + (2881*qd1*qd2*cos(2*q2)*cos(q3))/2500 + (3*qdd3*cos(q2)*cos(q3)*cos(5239260779425957/18014398509481984))/20 - (43*qd1*qd2*sin(2*q2)*cos(q3))/250 - (43*qd1*qd3*cos(2*q2)*sin(q3))/500 - (2881*qd1*qd3*sin(2*q2)*sin(q3))/5000 - (3*qdd2*cos(q2)*sin(q3)*sin(5239260779425957/18014398509481984))/20 + (3*qdd2*cos(5239260779425957/18014398509481984)*sin(q2)*sin(q3))/20 + (3*qdd3*cos(q3)*sin(q2)*sin(5239260779425957/18014398509481984))/20 - (3*qdd1*cos(2*q2)*cos(q3)*sin(5239260779425957/18014398509481984))/20 + (3*qdd1*sin(2*q2)*cos(q3)*cos(5239260779425957/18014398509481984))/20 + (3*qd2^2*cos(q2)*cos(5239260779425957/18014398509481984)*sin(q3))/10 - (3*qd3^2*cos(q2)*cos(5239260779425957/18014398509481984)*sin(q3))/10 + (3*qd2^2*sin(q2)*sin(q3)*sin(5239260779425957/18014398509481984))/10 - (3*qd3^2*sin(q2)*sin(q3)*sin(5239260779425957/18014398509481984))/10 + (3*qd1*qd2*cos(2*q2)*cos(q3)*cos(5239260779425957/18014398509481984))/5 + (3*qd1*qd2*sin(2*q2)*cos(q3)*sin(5239260779425957/18014398509481984))/5 + (3*qd1*qd3*cos(2*q2)*sin(q3)*sin(5239260779425957/18014398509481984))/10 - (3*qd1*qd3*sin(2*q2)*cos(5239260779425957/18014398509481984)*sin(q3))/10, - 2*cos(q2)*sin(q3)*qd2^2 - 4*qd1*cos(2*q2)*cos(q3)*qd2 + 2*cos(q2)*sin(q3)*qd3^2 + 2*qd1*sin(2*q2)*sin(q3)*qd3 - qdd3*cos(q2)*cos(q3) - qdd2*sin(q2)*sin(q3) - qdd1*sin(2*q2)*cos(q3), (qdd1*sin(2*q3))/2 + (qdd1*cos(2*q2)*sin(2*q3))/2 + 2*qd2^2*cos(2*q3)*sin(q2) + 2*qd1*qd3*cos(2*q3) - qdd2*cos(2*q3)*cos(q2) + 4*qd2*qd3*sin(2*q3)*cos(q2) + 2*qd1*qd3*cos(2*q2)*cos(2*q3) - 2*qd1*qd2*sin(2*q2)*sin(2*q3), (3*qdd1)/4 - (qdd1*cos(2*q2))/4 - (qdd1*cos(2*q3))/4 + qdd3*sin(q2) + 2*qd2*qd3*cos(q2) - (qdd1*cos(2*q2)*cos(2*q3))/4 + qd2^2*sin(2*q3)*sin(q2) + qd1*qd2*sin(2*q2) + qd1*qd3*sin(2*q3) - (qdd2*sin(2*q3)*cos(q2))/2 - 2*qd2*qd3*cos(2*q3)*cos(q2) + qd1*qd2*cos(2*q3)*sin(2*q2) + qd1*qd3*cos(2*q2)*sin(2*q3), (49*sin(q1))/5, q3*qdd1 + 2*qd1*qd3 - (49*sin(q1)*sin(q2)*sin(5239260779425957/18014398509481984))/5 - (49*cos(q2)*cos(5239260779425957/18014398509481984)*sin(q1))/5 + q3*qdd1*cos(2*q2)*cos(5239260779425957/9007199254740992) + 2*qd1*qd3*cos(2*q2)*cos(5239260779425957/9007199254740992) + q3*qdd1*sin(2*q2)*sin(5239260779425957/9007199254740992) + 2*qd1*qd3*sin(2*q2)*sin(5239260779425957/9007199254740992) + 4*q3*qd1*qd2*cos(2*q2)*sin(5239260779425957/9007199254740992) - 4*q3*qd1*qd2*sin(2*q2)*cos(5239260779425957/9007199254740992), (49*cos(q1))/5 + qdd3*cos(q2)*cos(5239260779425957/18014398509481984) + qdd3*sin(q2)*sin(5239260779425957/18014398509481984) - 2*q3*qd2^2*cos(q2)*cos(5239260779425957/18014398509481984) - 2*q3*qd2^2*sin(q2)*sin(5239260779425957/18014398509481984) + q3*qdd2*cos(q2)*sin(5239260779425957/18014398509481984) - q3*qdd2*cos(5239260779425957/18014398509481984)*sin(q2) + 4*qd2*qd3*cos(q2)*sin(5239260779425957/18014398509481984) - 4*qd2*qd3*cos(5239260779425957/18014398509481984)*sin(q2), (98*cos(q2)*sin(q1)*sin(5239260779425957/18014398509481984))/5 - (98*cos(5239260779425957/18014398509481984)*sin(q1)*sin(q2))/5 - 2*q3*qdd1*cos(2*q2)*sin(5239260779425957/9007199254740992) + 2*q3*qdd1*sin(2*q2)*cos(5239260779425957/9007199254740992) - 4*qd1*qd3*cos(2*q2)*sin(5239260779425957/9007199254740992) + 4*qd1*qd3*sin(2*q2)*cos(5239260779425957/9007199254740992) + 8*q3*qd1*qd2*cos(2*q2)*cos(5239260779425957/9007199254740992) + 8*q3*qd1*qd2*sin(2*q2)*sin(5239260779425957/9007199254740992),   0, -q1,    0,    0, -qd1,          0,          0, -sign(qd1), - 2*sin(q2)*qd2^2 + qdd2*cos(q2), (3*qdd2*cos(5239260779425957/18014398509481984)*sin(q2))/20 - (3*qdd2*cos(q2)*sin(5239260779425957/18014398509481984))/20 - (49*cos(q1))/5 + (3*qd2^2*cos(q2)*cos(5239260779425957/18014398509481984))/10 + (3*qd2^2*sin(q2)*sin(5239260779425957/18014398509481984))/10, - qdd1*sin(2*q2) - 4*qd1*qd2*cos(2*q2), qdd1/2 + (qdd1*cos(2*q2))/2 - 2*qd1*qd2*sin(2*q2), qdd1/2 - (qdd1*cos(2*q2))/2 + 2*qd1*qd2*sin(2*q2), -qdd2,  (49*sin(q1)*sin(q2))/5, (49*cos(q2)*sin(q1))/5 - (3*qdd1*cos(5239260779425957/18014398509481984))/20 - (3*qdd1*cos(2*q2)*cos(5239260779425957/18014398509481984))/20 - (3*qdd1*sin(2*q2)*sin(5239260779425957/18014398509481984))/20 - (3*qd1*qd2*cos(2*q2)*sin(5239260779425957/18014398509481984))/5 + (3*qd1*qd2*sin(2*q2)*cos(5239260779425957/18014398509481984))/5, -(49*cos(q1))/5, qdd1/2 - (qdd1*cos(2*q2))/2 + 2*qd1*qd2*sin(2*q2), (3*qdd1*cos(q2))/20 - (49*cos(5239260779425957/18014398509481984)*sin(q1))/5 - (3*qd1*qd2*sin(q2))/10 + (3*qdd1*cos(q2)*cos(5239260779425957/9007199254740992))/20 + (3*qdd1*sin(q2)*sin(5239260779425957/9007199254740992))/20 + (3*qd1*qd2*cos(q2)*sin(5239260779425957/9007199254740992))/10 - (3*qd1*qd2*cos(5239260779425957/9007199254740992)*sin(q2))/10];
% F((k-1)*four.dof+2,:)=[                                                                                                                                                                                                                                                                               q3^2*qdd2 + 4*q3*qd2*qd3 - q3^2*qd1^2*cos(2*q2)*sin(5239260779425957/9007199254740992) + q3^2*qd1^2*sin(2*q2)*cos(5239260779425957/9007199254740992) + (49*q3*cos(q1)*cos(q2)*sin(5239260779425957/18014398509481984))/5 - (49*q3*cos(q1)*cos(5239260779425957/18014398509481984)*sin(q2))/5,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       (2881*qdd3*cos(q3))/10000 - (2881*qd3^2*sin(q3))/5000 + (43*qdd2*sin(q3))/500 + (43*qd2*qd3*cos(q3))/250 + (2881*qd1^2*cos(2*q2)*sin(q3))/5000 - (43*qd1^2*sin(2*q2)*sin(q3))/500 + (43*qdd1*cos(q2)*cos(q3))/1000 + (3*qdd3*cos(q3)*cos(5239260779425957/18014398509481984))/20 + (2881*qdd1*cos(q3)*sin(q2))/10000 - (3*qdd2*sin(q3)*sin(5239260779425957/18014398509481984))/10 - (49*cos(q1)*cos(q2)*sin(q3))/5 - (3*qd3^2*cos(5239260779425957/18014398509481984)*sin(q3))/10 - (2881*qd1*qd3*sin(q2)*sin(q3))/2500 + (3*qd1^2*cos(2*q2)*cos(5239260779425957/18014398509481984)*sin(q3))/10 + (3*qd1^2*sin(2*q2)*sin(q3)*sin(5239260779425957/18014398509481984))/10 - (3*qdd1*cos(q2)*cos(q3)*sin(5239260779425957/18014398509481984))/20 + (3*qdd1*cos(q3)*cos(5239260779425957/18014398509481984)*sin(q2))/20 - (43*qd1*qd3*cos(q2)*sin(q3))/250 - (3*qd2*qd3*cos(q3)*sin(5239260779425957/18014398509481984))/5 + (3*qd1*qd3*cos(q2)*sin(q3)*sin(5239260779425957/18014398509481984))/5 - (3*qd1*qd3*cos(5239260779425957/18014398509481984)*sin(q2)*sin(q3))/5,                                                                        - 2*cos(2*q2)*sin(q3)*qd1^2 + 4*sin(q2)*sin(q3)*qd1*qd3 + 2*sin(q3)*qd3^2 - qdd3*cos(q3) - qdd1*cos(q3)*sin(q2),                                                                                                                          qdd2/2 - (qdd2*cos(2*q3))/2 - (qd1^2*sin(2*q2))/2 - 2*qd1*qd3*cos(q2) + 2*qd2*qd3*sin(2*q3) + (qd1^2*cos(2*q3)*sin(2*q2))/2 + (qdd1*sin(2*q3)*cos(q2))/2 + 2*qd1*qd3*cos(2*q3)*cos(q2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       (2881*qd3^2*cos(q3))/5000 - (43*qdd2*cos(q3))/500 + (2881*qdd3*sin(q3))/10000 + (43*qd2*qd3*sin(q3))/250 - (2881*qd1^2*cos(2*q2)*cos(q3))/5000 + (43*qd1^2*sin(2*q2)*cos(q3))/500 + (43*qdd1*cos(q2)*sin(q3))/1000 + (3*qdd2*cos(q3)*sin(5239260779425957/18014398509481984))/10 + (3*qdd3*cos(5239260779425957/18014398509481984)*sin(q3))/20 + (2881*qdd1*sin(q2)*sin(q3))/10000 + (49*cos(q1)*cos(q2)*cos(q3))/5 + (3*qd3^2*cos(q3)*cos(5239260779425957/18014398509481984))/10 - (3*qd2*qd3*sin(q3)*sin(5239260779425957/18014398509481984))/5 - (3*qd1^2*cos(2*q2)*cos(q3)*cos(5239260779425957/18014398509481984))/10 - (3*qd1^2*sin(2*q2)*cos(q3)*sin(5239260779425957/18014398509481984))/10 - (3*qdd1*cos(q2)*sin(q3)*sin(5239260779425957/18014398509481984))/20 + (3*qdd1*cos(5239260779425957/18014398509481984)*sin(q2)*sin(q3))/20 + (43*qd1*qd3*cos(q2)*cos(q3))/250 + (2881*qd1*qd3*cos(q3)*sin(q2))/2500 - (3*qd1*qd3*cos(q2)*cos(q3)*sin(5239260779425957/18014398509481984))/5 + (3*qd1*qd3*cos(q3)*cos(5239260779425957/18014398509481984)*sin(q2))/5,                                                                          2*cos(2*q2)*cos(q3)*qd1^2 - 4*cos(q3)*sin(q2)*qd1*qd3 - 2*cos(q3)*qd3^2 - qdd3*sin(q3) - qdd1*sin(q2)*sin(q3),                                                                                                    sin(2*q2)*sin(2*q3)*qd1^2 + 4*qd3*sin(2*q3)*cos(q2)*qd1 - qdd2*sin(2*q3) - 4*qd2*qd3*cos(2*q3) - qdd1*cos(2*q3)*cos(q2),                                                                                                                          qdd2/2 + (qdd2*cos(2*q3))/2 - (qd1^2*sin(2*q2))/2 - 2*qd1*qd3*cos(q2) - 2*qd2*qd3*sin(2*q3) - (qd1^2*cos(2*q3)*sin(2*q2))/2 - (qdd1*sin(2*q3)*cos(q2))/2 - 2*qd1*qd3*cos(2*q3)*cos(q2),              0,                                                                                                                                                                                                                                                   2*q3*qdd2 + 4*qd2*qd3 + (49*cos(q1)*cos(q2)*sin(5239260779425957/18014398509481984))/5 - (49*cos(q1)*cos(5239260779425957/18014398509481984)*sin(q2))/5 - 2*q3*qd1^2*cos(2*q2)*sin(5239260779425957/9007199254740992) + 2*q3*qd1^2*sin(2*q2)*cos(5239260779425957/9007199254740992),                                                                                                                                                                                                                                                                                                                                                                                  q3*qdd1*cos(q2)*sin(5239260779425957/18014398509481984) - q3*qdd1*cos(5239260779425957/18014398509481984)*sin(q2),                                                                                                                                                                                                                                                2*qdd3 + (98*cos(q1)*sin(q2)*sin(5239260779425957/18014398509481984))/5 + (98*cos(q1)*cos(q2)*cos(5239260779425957/18014398509481984))/5 - 4*q3*qd1^2*cos(2*q2)*cos(5239260779425957/9007199254740992) - 4*q3*qd1^2*sin(2*q2)*sin(5239260779425957/9007199254740992), -q2,   0,    0, -qd2,    0,          0, -sign(qd2),          0,                     qdd1*cos(q2),                                                                                                                                                (3*qdd1*cos(5239260779425957/18014398509481984)*sin(q2))/20 - (3*qdd1*cos(q2)*sin(5239260779425957/18014398509481984))/20,                      2*qd1^2*cos(2*q2),                            sin(2*q2)*qd1^2 + qdd2,                          - sin(2*q2)*qd1^2 + qdd2, -qdd1, -(49*cos(q1)*cos(q2))/5,                                                                                                                                   (49*cos(q1)*sin(q2))/5 - (3*qdd2*cos(5239260779425957/18014398509481984))/10 + (3*qd1^2*cos(2*q2)*sin(5239260779425957/18014398509481984))/10 - (3*qd1^2*sin(2*q2)*cos(5239260779425957/18014398509481984))/10,               0,                                  -qd1^2*sin(2*q2),                                                                                                                                                                                                                (3*qd1^2*sin(q2))/20 - (3*qd1^2*cos(q2)*sin(5239260779425957/9007199254740992))/20 + (3*qd1^2*cos(5239260779425957/9007199254740992)*sin(q2))/20];
% F((k-1)*four.dof+3,:)= [                                                                                                                                               qdd3 - 2*q3*qd1^2 - 2*q3*qd2^2 + (49*cos(q1)*sin(q2)*sin(5239260779425957/18014398509481984))/5 + 2*q3*qd1^2*cos(q2)^2 + 2*q3*qd1^2*cos(5239260779425957/18014398509481984)^2 + (49*cos(q1)*cos(q2)*cos(5239260779425957/18014398509481984))/5 - 4*q3*qd1^2*cos(q2)^2*cos(5239260779425957/18014398509481984)^2 - 4*q3*qd1^2*cos(q2)*cos(5239260779425957/18014398509481984)*sin(q2)*sin(5239260779425957/18014398509481984),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              (49*sin(q1)*sin(q3))/5 - (43*qd2^2*cos(q3))/500 - (43*qd1^2*cos(q3))/500 + (2881*qdd2*cos(q3))/10000 + (43*qd1^2*cos(q2)^2*cos(q3))/500 + (3*qdd2*cos(q3)*cos(5239260779425957/18014398509481984))/20 - (2881*qdd1*cos(q2)*sin(q3))/10000 + (43*qdd1*sin(q2)*sin(q3))/1000 - (49*cos(q1)*cos(q3)*sin(q2))/5 + (3*qd1^2*cos(q3)*sin(5239260779425957/18014398509481984))/10 + (3*qd2^2*cos(q3)*sin(5239260779425957/18014398509481984))/10 + (2881*qd1*qd2*sin(q2)*sin(q3))/2500 - (3*qd1^2*cos(q2)^2*cos(q3)*sin(5239260779425957/18014398509481984))/10 - (3*qdd1*cos(q2)*cos(5239260779425957/18014398509481984)*sin(q3))/20 - (3*qdd1*sin(q2)*sin(q3)*sin(5239260779425957/18014398509481984))/20 + (2881*qd1^2*cos(q2)*cos(q3)*sin(q2))/5000 + (43*qd1*qd2*cos(q2)*sin(q3))/250 + (3*qd1^2*cos(q2)*cos(q3)*cos(5239260779425957/18014398509481984)*sin(q2))/10 - (3*qd1*qd2*cos(q2)*sin(q3)*sin(5239260779425957/18014398509481984))/5 + (3*qd1*qd2*cos(5239260779425957/18014398509481984)*sin(q2)*sin(q3))/5,                                                                                    - 2*cos(q2)*cos(q3)*sin(q2)*qd1^2 - 4*qd2*sin(q2)*sin(q3)*qd1 - qdd2*cos(q3) + qdd1*cos(q2)*sin(q3),                                                                                                                                                                                     qdd3 - qd2^2*sin(2*q3) + qdd1*sin(q2) + 4*qd1*qd2*cos(q2) + 2*qd1^2*cos(q2)^2*cos(q3)*sin(q3) - 4*qd1*qd2*cos(q2)*cos(q3)^2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              (2881*qdd2*sin(q3))/10000 - (43*qd2^2*sin(q3))/500 - (49*cos(q3)*sin(q1))/5 - (43*qd1^2*sin(q3))/500 + (43*qd1^2*cos(q2)^2*sin(q3))/500 + (2881*qdd1*cos(q2)*cos(q3))/10000 - (43*qdd1*cos(q3)*sin(q2))/1000 + (3*qdd2*cos(5239260779425957/18014398509481984)*sin(q3))/20 - (49*cos(q1)*sin(q2)*sin(q3))/5 + (3*qd1^2*sin(q3)*sin(5239260779425957/18014398509481984))/10 + (3*qd2^2*sin(q3)*sin(5239260779425957/18014398509481984))/10 - (3*qd1^2*cos(q2)^2*sin(q3)*sin(5239260779425957/18014398509481984))/10 + (3*qdd1*cos(q2)*cos(q3)*cos(5239260779425957/18014398509481984))/20 + (3*qdd1*cos(q3)*sin(q2)*sin(5239260779425957/18014398509481984))/20 + (2881*qd1^2*cos(q2)*sin(q2)*sin(q3))/5000 - (43*qd1*qd2*cos(q2)*cos(q3))/250 - (2881*qd1*qd2*cos(q3)*sin(q2))/2500 + (3*qd1^2*cos(q2)*cos(5239260779425957/18014398509481984)*sin(q2)*sin(q3))/10 + (3*qd1*qd2*cos(q2)*cos(q3)*sin(5239260779425957/18014398509481984))/5 - (3*qd1*qd2*cos(q3)*cos(5239260779425957/18014398509481984)*sin(q2))/5,                                                                                    - 2*cos(q2)*sin(q2)*sin(q3)*qd1^2 + 4*qd2*cos(q3)*sin(q2)*qd1 - qdd2*sin(q3) - qdd1*cos(q2)*cos(q3),                                                                                                          2*qd1^2*cos(q2)^2 + 4*qd2^2*cos(q3)^2 - 2*qd2^2 - 4*qd1^2*cos(q2)^2*cos(q3)^2 - 8*qd1*qd2*cos(q2)*cos(q3)*sin(q3),                                                                                                                                                                                                         qdd3 + qd2^2*sin(2*q3) + qdd1*sin(q2) - 2*qd1^2*cos(q2)^2*cos(q3)*sin(q3) + 4*qd1*qd2*cos(q2)*cos(q3)^2,              0,                                                                                                                                                                                                                                                                     2*qd1^2*cos(q2)^2 + 2*qd1^2*cos(5239260779425957/18014398509481984)^2 - 2*qd1^2 - 2*qd2^2 - 4*qd1^2*cos(q2)^2*cos(5239260779425957/18014398509481984)^2 - 4*qd1^2*cos(q2)*cos(5239260779425957/18014398509481984)*sin(q2)*sin(5239260779425957/18014398509481984),                                                                                                                                                                                                                                                                                                                                                                                        qdd1*cos(q2)*cos(5239260779425957/18014398509481984) + qdd1*sin(q2)*sin(5239260779425957/18014398509481984),                                                                                                                                                                                                                                                                 2*qdd2 - 2*qd1^2*sin(5239260779425957/9007199254740992) + 2*qd1^2*sin(2*q2) - 8*qd1^2*cos(q2)*cos(5239260779425957/18014398509481984)^2*sin(q2) + 8*qd1^2*cos(q2)^2*cos(5239260779425957/18014398509481984)*sin(5239260779425957/18014398509481984),   0,   0, -qd3,    0,    0, -sign(qd3),          0,          0,                                0,                                                                                                                                                                                                                                                                        0,                                      0,                                                 0,                                                 0,     0,                       0,                                                                                                                                                                                                                                                                                                                                                0,               0,                                                 0,                                                                                                                                                                                                                                                                                                                                                               0];
%  
%latest_3dof_inaxis_svd
% F((k-1)*four.dof+1,:)=[ (4075861*qdd1)/200000000 + (2107*cos(q1 - q2))/10000 + (62769*sin(q1 - q2))/100000 - (147*sin(q1 + q2 - 5239260779425957/18014398509481984))/200 - (147*sin(q1 - q2 + 5239260779425957/18014398509481984))/200 - (2107*cos(q1 + q2))/10000 + (62769*sin(q1 + q2))/100000 + (1456061*qdd1*cos(2*q2))/200000000 + (55083*qdd1*sin(2*q2))/10000000 + (1281*q3*qdd1)/10000 + (1281*qd1*qd3)/5000 + (49*q3*sin(q1 + q2))/10 + (q3^2*qdd1)/2 - (3843*qdd1*cos(5239260779425957/18014398509481984))/200000 - (129*qdd1*sin(5239260779425957/18014398509481984))/20000 + (9*qdd1*cos(2*q2 - 5239260779425957/9007199254740992))/800 - (3843*qdd1*cos(2*q2 - 5239260779425957/18014398509481984))/200000 + (49*q3*sin(q1 - q2))/10 - (129*qdd1*sin(2*q2 - 5239260779425957/18014398509481984))/20000 - (3*q3*qdd1*cos(5239260779425957/18014398509481984))/20 - (3*qd1*qd3*cos(5239260779425957/18014398509481984))/10 - (3*q3*qdd1*cos(2*q2 - 5239260779425957/18014398509481984))/20 - (129*qd1*qd2*cos(2*q2 - 5239260779425957/18014398509481984))/5000 - (3*qd1*qd3*cos(2*q2 - 5239260779425957/18014398509481984))/10 - (9*qd1*qd2*sin(2*q2 - 5239260779425957/9007199254740992))/200 + (3843*qd1*qd2*sin(2*q2 - 5239260779425957/18014398509481984))/50000 + (1281*q3*qdd1*cos(2*q2))/10000 + (55083*qd1*qd2*cos(2*q2))/2500000 + (1281*qd1*qd3*cos(2*q2))/5000 + (43*q3*qdd1*sin(2*q2))/1000 - (1456061*qd1*qd2*sin(2*q2))/50000000 + (43*qd1*qd3*sin(2*q2))/500 + 2*q3*qd1*qd3 + (q3^2*qdd1*cos(2*q2))/2 - 2*q3^2*qd1*qd2*sin(2*q2) + (3*q3*qd1*qd2*sin(2*q2 - 5239260779425957/18014398509481984))/5 + (43*q3*qd1*qd2*cos(2*q2))/250 + 2*q3*qd1*qd3*cos(2*q2) - (1281*q3*qd1*qd2*sin(2*q2))/2500, (q3^2*qdd1)/2 - (49*q3*sin(q1 - q2 + 5239260779425957/18014398509481984))/10 - (49*q3*sin(q1 + q2 - 5239260779425957/18014398509481984))/10 + (q3^2*qdd1*cos(2*q2 - 5239260779425957/9007199254740992))/2 + 2*q3*qd1*qd3 - 2*q3^2*qd1*qd2*sin(2*q2 - 5239260779425957/9007199254740992) + 2*q3*qd1*qd3*cos(2*q2 - 5239260779425957/9007199254740992), (1281*qdd1)/10000 + (49*sin(q1 - q2))/10 + (49*sin(q1 + q2))/10 + (1281*qdd1*cos(2*q2))/10000 + (43*qdd1*sin(2*q2))/1000 + q3*qdd1 + 2*qd1*qd3 - (3*qdd1*cos(5239260779425957/18014398509481984))/20 - (3*qdd1*cos(2*q2 - 5239260779425957/18014398509481984))/20 + (3*qd1*qd2*sin(2*q2 - 5239260779425957/18014398509481984))/5 + q3*qdd1*cos(2*q2) + (43*qd1*qd2*cos(2*q2))/250 + 2*qd1*qd3*cos(2*q2) - (1281*qd1*qd2*sin(2*q2))/2500 - 4*q3*qd1*qd2*sin(2*q2), -(49*sin(q1))/5, q3*qdd1 - (49*sin(q1 - q2 + 5239260779425957/18014398509481984))/10 - (49*sin(q1 + q2 - 5239260779425957/18014398509481984))/10 + 2*qd1*qd3 + q3*qdd1*cos(2*q2 - 5239260779425957/9007199254740992) + 2*qd1*qd3*cos(2*q2 - 5239260779425957/9007199254740992) - 4*q3*qd1*qd2*sin(2*q2 - 5239260779425957/9007199254740992),   0, -q1,    0,    0, -qd1,          0,          0, -sign(qd1), 2*sin(q2 - 5239260779425957/18014398509481984)*qd2^2 - qdd2*cos(q2 - 5239260779425957/18014398509481984), 2*cos(q2 - 5239260779425957/18014398509481984)*qd2^2 + qdd2*sin(q2 - 5239260779425957/18014398509481984),    0, -qdd2, qdd1/2 + (qdd1*cos(2*q2 - 5239260779425957/9007199254740992))/2 - 2*qd1*qd2*sin(2*q2 - 5239260779425957/9007199254740992), (10550161*qdd1)/200000000 - (141169*sin(q1 - q2))/100000 - (147*sin(q1 + q2 - 5239260779425957/18014398509481984))/200 - (147*sin(q1 - q2 + 5239260779425957/18014398509481984))/200 - (141169*sin(q1 + q2))/100000 + (8300161*qdd1*cos(2*q2))/200000000 + (8643*qdd1*cos(5239260779425957/18014398509481984))/200000 + (9*qdd1*cos(2*q2 - 5239260779425957/9007199254740992))/800 + (8643*qdd1*cos(2*q2 - 5239260779425957/18014398509481984))/200000 - (9*qd1*qd2*sin(2*q2 - 5239260779425957/9007199254740992))/200 - (8643*qd1*qd2*sin(2*q2 - 5239260779425957/18014398509481984))/50000 - (8300161*qd1*qd2*sin(2*q2))/50000000, qdd1/2 - (qdd1*cos(2*q2))/2 + 2*qd1*qd2*sin(2*q2), (9*qdd1)/800 - (147*sin(q1 + q2 - 5239260779425957/18014398509481984))/200 - (147*sin(q1 - q2 + 5239260779425957/18014398509481984))/200 + (9*qdd1*cos(2*q2 - 5239260779425957/9007199254740992))/800 - (9*qd1*qd2*sin(2*q2 - 5239260779425957/9007199254740992))/200, qdd1];
% F((k-1)*four.dof+2,:)=[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         (4075861*qdd2)/100000000 + (43*qdd3)/1000 - (2107*cos(q1 - q2))/10000 - (62769*sin(q1 - q2))/100000 - (147*sin(q1 + q2 - 5239260779425957/18014398509481984))/200 + (147*sin(q1 - q2 + 5239260779425957/18014398509481984))/200 - (2107*cos(q1 + q2))/10000 + (62769*sin(q1 + q2))/100000 + (129*qd1^2*cos(2*q2 - 5239260779425957/18014398509481984))/10000 + (1281*q3*qdd2)/5000 + (1281*qd2*qd3)/2500 + (9*qd1^2*sin(2*q2 - 5239260779425957/9007199254740992))/400 - (3843*qd1^2*sin(2*q2 - 5239260779425957/18014398509481984))/100000 - (55083*qd1^2*cos(2*q2))/5000000 + (1456061*qd1^2*sin(2*q2))/100000000 + (49*q3*sin(q1 + q2))/10 + q3^2*qdd2 - (3843*qdd2*cos(5239260779425957/18014398509481984))/100000 - (129*qdd2*sin(5239260779425957/18014398509481984))/10000 - (3*qdd3*sin(5239260779425957/18014398509481984))/20 - (49*q3*sin(q1 - q2))/10 - (3*q3*qdd2*cos(5239260779425957/18014398509481984))/10 - (3*qd2*qd3*cos(5239260779425957/18014398509481984))/5 + q3^2*qd1^2*sin(2*q2) + 4*q3*qd2*qd3 - (3*q3*qd1^2*sin(2*q2 - 5239260779425957/18014398509481984))/10 - (43*q3*qd1^2*cos(2*q2))/500 + (1281*q3*qd1^2*sin(2*q2))/5000,                                                                                                                                    (49*q3*sin(q1 - q2 + 5239260779425957/18014398509481984))/10 + q3^2*qdd2 - (49*q3*sin(q1 + q2 - 5239260779425957/18014398509481984))/10 + q3^2*qd1^2*sin(2*q2 - 5239260779425957/9007199254740992) + 4*q3*qd2*qd3,                                                                                                                                                                       (1281*qdd2)/5000 - (49*sin(q1 - q2))/10 + (49*sin(q1 + q2))/10 + 2*q3*qdd2 + 4*qd2*qd3 - (3*qd1^2*sin(2*q2 - 5239260779425957/18014398509481984))/10 - (43*qd1^2*cos(2*q2))/500 + (1281*qd1^2*sin(2*q2))/5000 - (3*qdd2*cos(5239260779425957/18014398509481984))/10 + 2*q3*qd1^2*sin(2*q2),               0,                                                                                                                   2*q3*sin(2*q2 - 5239260779425957/9007199254740992)*qd1^2 - (49*sin(q1 + q2 - 5239260779425957/18014398509481984))/10 + (49*sin(q1 - q2 + 5239260779425957/18014398509481984))/10 + 2*q3*qdd2 + 4*qd2*qd3, -q2,   0,    0, -qd2,    0,          0, -sign(qd2),          0,                                                       -qdd1*cos(q2 - 5239260779425957/18014398509481984),                                                        qdd1*sin(q2 - 5239260779425957/18014398509481984), qdd2, -qdd1,                                                                sin(2*q2 - 5239260779425957/9007199254740992)*qd1^2 + qdd2,                                                                                                                                                                           (10550161*qdd2)/100000000 + (141169*sin(q1 - q2))/100000 - (147*sin(q1 + q2 - 5239260779425957/18014398509481984))/200 + (147*sin(q1 - q2 + 5239260779425957/18014398509481984))/200 - (141169*sin(q1 + q2))/100000 + (9*qd1^2*sin(2*q2 - 5239260779425957/9007199254740992))/400 + (8643*qd1^2*sin(2*q2 - 5239260779425957/18014398509481984))/100000 + (8300161*qd1^2*sin(2*q2))/100000000 + (8643*qdd2*cos(5239260779425957/18014398509481984))/100000,                                  -qd1^2*sin(2*q2),                                                                (9*sin(2*q2 - 5239260779425957/9007199254740992)*qd1^2)/400 + (9*qdd2)/400 - (147*sin(q1 + q2 - 5239260779425957/18014398509481984))/200 + (147*sin(q1 - q2 + 5239260779425957/18014398509481984))/200,    0];
% F((k-1)*four.dof+3,:)=[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           (43*qdd2)/1000 + qdd3 - (49*cos(q1 - q2))/10 - (49*cos(q1 + q2))/10 + (3*qd1^2*cos(5239260779425957/18014398509481984))/20 + (3*qd2^2*cos(5239260779425957/18014398509481984))/10 + (3*qd1^2*cos(2*q2 - 5239260779425957/18014398509481984))/20 - (1281*qd1^2*cos(2*q2))/10000 - (43*qd1^2*sin(2*q2))/1000 - q3*qd1^2 - 2*q3*qd2^2 - (3*qdd2*sin(5239260779425957/18014398509481984))/20 - (1281*qd1^2)/10000 - (1281*qd2^2)/5000 - q3*qd1^2*cos(2*q2),                                                                                                                                        qdd3 + (49*cos(q1 + q2 - 5239260779425957/18014398509481984))/10 + (49*cos(q1 - q2 + 5239260779425957/18014398509481984))/10 - q3*qd1^2 - 2*q3*qd2^2 - q3*qd1^2*cos(2*q2 - 5239260779425957/9007199254740992),                                                                                                                                                                                                                                                                                                                                                                                                                              - qd1^2*cos(2*q2) - qd1^2 - 2*qd2^2,               0,                                                                                                                                                                                                                                                    - qd1^2*cos(2*q2 - 5239260779425957/9007199254740992) - qd1^2 - 2*qd2^2,   0,   0, -qd3,    0,    0, -sign(qd3),          0,          0,                                                                                                        0,                                                                                                        0,    0,     0,                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,                                                 0,                                                                                                                                                                                                                                                                     0,    0];
%  

%Some other stuff
% F((k-1)*four.dof+1,:)=[ (4075861*qdd1)/200000000 + (2107*cos(q1 - q2))/10000 + (62769*sin(q1 - q2))/100000 - (147*sin(q1 + q2 - 5239260779425957/18014398509481984))/200 - (147*sin(q1 - q2 + 5239260779425957/18014398509481984))/200 - (2107*cos(q1 + q2))/10000 + (62769*sin(q1 + q2))/100000 + (1456061*qdd1*cos(2*q2))/200000000 + (55083*qdd1*sin(2*q2))/10000000 + (1281*q3*qdd1)/10000 + (1281*qd1*qd3)/5000 + (49*q3*sin(q1 + q2))/10 + (q3^2*qdd1)/2 - (3843*qdd1*cos(5239260779425957/18014398509481984))/200000 - (129*qdd1*sin(5239260779425957/18014398509481984))/20000 + (9*qdd1*cos(2*q2 - 5239260779425957/9007199254740992))/800 - (3843*qdd1*cos(2*q2 - 5239260779425957/18014398509481984))/200000 + (49*q3*sin(q1 - q2))/10 - (129*qdd1*sin(2*q2 - 5239260779425957/18014398509481984))/20000 - (3*q3*qdd1*cos(5239260779425957/18014398509481984))/20 - (3*qd1*qd3*cos(5239260779425957/18014398509481984))/10 - (3*q3*qdd1*cos(2*q2 - 5239260779425957/18014398509481984))/20 - (129*qd1*qd2*cos(2*q2 - 5239260779425957/18014398509481984))/5000 - (3*qd1*qd3*cos(2*q2 - 5239260779425957/18014398509481984))/10 - (9*qd1*qd2*sin(2*q2 - 5239260779425957/9007199254740992))/200 + (3843*qd1*qd2*sin(2*q2 - 5239260779425957/18014398509481984))/50000 + (1281*q3*qdd1*cos(2*q2))/10000 + (55083*qd1*qd2*cos(2*q2))/2500000 + (1281*qd1*qd3*cos(2*q2))/5000 + (43*q3*qdd1*sin(2*q2))/1000 - (1456061*qd1*qd2*sin(2*q2))/50000000 + (43*qd1*qd3*sin(2*q2))/500 + 2*q3*qd1*qd3 + (q3^2*qdd1*cos(2*q2))/2 - 2*q3^2*qd1*qd2*sin(2*q2) + (3*q3*qd1*qd2*sin(2*q2 - 5239260779425957/18014398509481984))/5 + (43*q3*qd1*qd2*cos(2*q2))/250 + 2*q3*qd1*qd3*cos(2*q2) - (1281*q3*qd1*qd2*sin(2*q2))/2500, (q3^2*qdd1)/2 - (49*q3*sin(q1 - q2 + 5239260779425957/18014398509481984))/10 - (49*q3*sin(q1 + q2 - 5239260779425957/18014398509481984))/10 + (q3^2*qdd1*cos(2*q2 - 5239260779425957/9007199254740992))/2 + 2*q3*qd1*qd3 - 2*q3^2*qd1*qd2*sin(2*q2 - 5239260779425957/9007199254740992) + 2*q3*qd1*qd3*cos(2*q2 - 5239260779425957/9007199254740992), (1281*qdd1)/10000 + (49*sin(q1 - q2))/10 + (49*sin(q1 + q2))/10 + (1281*qdd1*cos(2*q2))/10000 + (43*qdd1*sin(2*q2))/1000 + q3*qdd1 + 2*qd1*qd3 - (3*qdd1*cos(5239260779425957/18014398509481984))/20 - (3*qdd1*cos(2*q2 - 5239260779425957/18014398509481984))/20 + (3*qd1*qd2*sin(2*q2 - 5239260779425957/18014398509481984))/5 + q3*qdd1*cos(2*q2) + (43*qd1*qd2*cos(2*q2))/250 + 2*qd1*qd3*cos(2*q2) - (1281*qd1*qd2*sin(2*q2))/2500 - 4*q3*qd1*qd2*sin(2*q2), -(49*sin(q1))/5, q3*qdd1 - (49*sin(q1 - q2 + 5239260779425957/18014398509481984))/10 - (49*sin(q1 + q2 - 5239260779425957/18014398509481984))/10 + 2*qd1*qd3 + q3*qdd1*cos(2*q2 - 5239260779425957/9007199254740992) + 2*qd1*qd3*cos(2*q2 - 5239260779425957/9007199254740992) - 4*q3*qd1*qd2*sin(2*q2 - 5239260779425957/9007199254740992),   0, -q1,    0,    0, -qd1,          0,          0, -sign(qd1),    0, 2*sin(q2 - 5239260779425957/18014398509481984)*qd2^2 - qdd2*cos(q2 - 5239260779425957/18014398509481984), qdd1/2 - (qdd1*cos(2*q2 - 5239260779425957/9007199254740992))/2 + 2*qd1*qd2*sin(2*q2 - 5239260779425957/9007199254740992), qdd1/2 - (qdd1*cos(2*q2))/2 + 2*qd1*qd2*sin(2*q2), (3*qdd1)/20 - (49*sin(q1 + q2 - 5239260779425957/18014398509481984))/10 - (49*sin(q1 - q2 + 5239260779425957/18014398509481984))/10 + (3*qdd1*cos(2*q2 - 5239260779425957/9007199254740992))/20 - (3*qd1*qd2*sin(2*q2 - 5239260779425957/9007199254740992))/5, qdd1, -qdd2, (2881*qdd1)/10000 - (49*sin(q1 - q2))/10 - (49*sin(q1 + q2))/10 + (2881*qdd1*cos(2*q2))/10000 + (3*qdd1*cos(5239260779425957/18014398509481984))/20 + (3*qdd1*cos(2*q2 - 5239260779425957/18014398509481984))/20 - (3*qd1*qd2*sin(2*q2 - 5239260779425957/18014398509481984))/5 - (2881*qd1*qd2*sin(2*q2))/2500, 2*cos(q2)*qd2^2 + qdd2*sin(q2)];
% F((k-1)*four.dof+2,:)=[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         (4075861*qdd2)/100000000 + (43*qdd3)/1000 - (2107*cos(q1 - q2))/10000 - (62769*sin(q1 - q2))/100000 - (147*sin(q1 + q2 - 5239260779425957/18014398509481984))/200 + (147*sin(q1 - q2 + 5239260779425957/18014398509481984))/200 - (2107*cos(q1 + q2))/10000 + (62769*sin(q1 + q2))/100000 + (129*qd1^2*cos(2*q2 - 5239260779425957/18014398509481984))/10000 + (1281*q3*qdd2)/5000 + (1281*qd2*qd3)/2500 + (9*qd1^2*sin(2*q2 - 5239260779425957/9007199254740992))/400 - (3843*qd1^2*sin(2*q2 - 5239260779425957/18014398509481984))/100000 - (55083*qd1^2*cos(2*q2))/5000000 + (1456061*qd1^2*sin(2*q2))/100000000 + (49*q3*sin(q1 + q2))/10 + q3^2*qdd2 - (3843*qdd2*cos(5239260779425957/18014398509481984))/100000 - (129*qdd2*sin(5239260779425957/18014398509481984))/10000 - (3*qdd3*sin(5239260779425957/18014398509481984))/20 - (49*q3*sin(q1 - q2))/10 - (3*q3*qdd2*cos(5239260779425957/18014398509481984))/10 - (3*qd2*qd3*cos(5239260779425957/18014398509481984))/5 + q3^2*qd1^2*sin(2*q2) + 4*q3*qd2*qd3 - (3*q3*qd1^2*sin(2*q2 - 5239260779425957/18014398509481984))/10 - (43*q3*qd1^2*cos(2*q2))/500 + (1281*q3*qd1^2*sin(2*q2))/5000,                                                                                                                                    (49*q3*sin(q1 - q2 + 5239260779425957/18014398509481984))/10 + q3^2*qdd2 - (49*q3*sin(q1 + q2 - 5239260779425957/18014398509481984))/10 + q3^2*qd1^2*sin(2*q2 - 5239260779425957/9007199254740992) + 4*q3*qd2*qd3,                                                                                                                                                                       (1281*qdd2)/5000 - (49*sin(q1 - q2))/10 + (49*sin(q1 + q2))/10 + 2*q3*qdd2 + 4*qd2*qd3 - (3*qd1^2*sin(2*q2 - 5239260779425957/18014398509481984))/10 - (43*qd1^2*cos(2*q2))/500 + (1281*qd1^2*sin(2*q2))/5000 - (3*qdd2*cos(5239260779425957/18014398509481984))/10 + 2*q3*qd1^2*sin(2*q2),               0,                                                                                                                   2*q3*sin(2*q2 - 5239260779425957/9007199254740992)*qd1^2 - (49*sin(q1 + q2 - 5239260779425957/18014398509481984))/10 + (49*sin(q1 - q2 + 5239260779425957/18014398509481984))/10 + 2*q3*qdd2 + 4*qd2*qd3, -q2,   0,    0, -qd2,    0,          0, -sign(qd2),          0, qdd2,                                                       -qdd1*cos(q2 - 5239260779425957/18014398509481984),                                                                      -qd1^2*sin(2*q2 - 5239260779425957/9007199254740992),                                  -qd1^2*sin(2*q2),                                                              (3*sin(2*q2 - 5239260779425957/9007199254740992)*qd1^2)/10 + (3*qdd2)/10 - (49*sin(q1 + q2 - 5239260779425957/18014398509481984))/10 + (49*sin(q1 - q2 + 5239260779425957/18014398509481984))/10,    0, -qdd1,                                                                                                (2881*qdd2)/5000 + (49*sin(q1 - q2))/10 - (49*sin(q1 + q2))/10 + (3*qd1^2*sin(2*q2 - 5239260779425957/18014398509481984))/10 + (2881*qd1^2*sin(2*q2))/5000 + (3*qdd2*cos(5239260779425957/18014398509481984))/10,                   qdd1*sin(q2)];
% F((k-1)*four.dof+3,:)=[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           (43*qdd2)/1000 + qdd3 - (49*cos(q1 - q2))/10 - (49*cos(q1 + q2))/10 + (3*qd1^2*cos(5239260779425957/18014398509481984))/20 + (3*qd2^2*cos(5239260779425957/18014398509481984))/10 + (3*qd1^2*cos(2*q2 - 5239260779425957/18014398509481984))/20 - (1281*qd1^2*cos(2*q2))/10000 - (43*qd1^2*sin(2*q2))/1000 - q3*qd1^2 - 2*q3*qd2^2 - (3*qdd2*sin(5239260779425957/18014398509481984))/20 - (1281*qd1^2)/10000 - (1281*qd2^2)/5000 - q3*qd1^2*cos(2*q2),                                                                                                                                        qdd3 + (49*cos(q1 + q2 - 5239260779425957/18014398509481984))/10 + (49*cos(q1 - q2 + 5239260779425957/18014398509481984))/10 - q3*qd1^2 - 2*q3*qd2^2 - q3*qd1^2*cos(2*q2 - 5239260779425957/9007199254740992),                                                                                                                                                                                                                                                                                                                                                                                                                              - qd1^2*cos(2*q2) - qd1^2 - 2*qd2^2,               0,                                                                                                                                                                                                                                                    - qd1^2*cos(2*q2 - 5239260779425957/9007199254740992) - qd1^2 - 2*qd2^2,   0,   0, -qd3,    0,    0, -sign(qd3),          0,          0,    0,                                                                                                        0,                                                                                                                         0,                                                 0,                                                                                                                                                                                                                                                             0,    0,     0,                                                                                                                                                                                                                                                                                                               0,                              0];

%F((k-1)*four.dof+1:(k-1)*four.dof+four.dof,:) = F((k-1)*four.dof+1:(k-1)*four.dof+four.dof,:).*four.scale.';

%F((k-1)*four.dof+1:(k-1)*four.dof+four.dof,:) = F((k-1)*four.dof+1:(k-1)*four.dof+four.dof,:).*(four.scale_noise.');
end

P = diag(1./vecnorm(F));

%toc
% Normal Condition
val = cond(F*P);

%val = cond(F);

%toc
%First Condition
%val = cond(mpower(four.cov,-0.5)*F);

%Second Condition
%val = -log(det(F.'*mpower(four.cov,-1)*F));
end